00000680    if ws-wa-address not = address of wfd-io-work-area or ws-tl-address not = address of rfd-rec-info
00000682    set ws-wa-address to address of wfd-io-work-area
00000683    set ws-tl-address to address of rfd-rec-info
00000684    move zero to sql-init-flag
00000685    end-if.
00000688    evaluate true
00000690    when wfd-rqst-browse
00000693    perform 2000-exec-browse thru 2000-exec-browse-x
00000696    when wfd-rqst-fetch-next
00000697    perform 3000-exec-fetch-next thru 3000-exec-fetch-next-x
00000700    when wfd-rqst-close-browse-cur
00000701    perform 4000-exec-close-cur thru 4000-exec-close-cur-x
00000704    when wfd-rqst-count
00000705    perform 5000-exec-count thru 5000-exec-count-x
00000708    when other
00000709    set wfd-io-error to true
00000711    end-evaluate.
00000714    goback.
00000691    perform 1000-determine-sql-reqir thru 1000-determine-sql-reqir-x
000007170000-mainline-x.
00000718    exit.
000007221000-determine-sql-reqir.
00000725    move 6 to ws-optm-sql-reqir.
00000727    if wfd-co-id = wfd-endbr-co-id
00000728    subtract +1 from ws-optm-sql-reqir
00000729    else
00000730    go to 1000-determine-sql-reqir-x
00000731    end-if.
00000734    if wfd-pol-id = wfd-endbr-pol-id
00000735    subtract +1 from ws-optm-sql-reqir
00000736    else
00000737    go to 1000-determine-sql-reqir-x
00000738    end-if.
00000741    if wfd-cvg-num = wfd-endbr-cvg-num
00000742    subtract +1 from ws-optm-sql-reqir
00000743    else
00000744    go to 1000-determine-sql-reqir-x
00000745    end-if.
00000748    if wfd-fnd-id = wfd-endbr-fnd-id
00000749    subtract +1 from ws-optm-sql-reqir
00000750    else
00000751    go to 1000-determine-sql-reqir-x
00000752    end-if.
00000755    if wfd-fia-eff-dt = wfd-endbr-fia-eff-dt
00000756    subtract +1 from ws-optm-sql-reqir
00000757    else
00000758    go to 1000-determine-sql-reqir-x
00000759    end-if.
00000762    if wfd-fia-tmsp = wfd-endbr-fia-tmsp
00000763    subtract +1 from ws-optm-sql-reqir
00000764    else
00000765    go to 1000-determine-sql-reqir-x
00000766    end-if.
000007691000-determine-sql-reqir-x.
00000770    exit.
000007742000-exec-browse.
00000777    if ws-optm-sql-exec numeric
00000778    move ws-optm-sql-exec-n to ws-optm-sql-reqir
00000779    end-if.
00000782    evaluate true
00000784    when ws-optm-sql-reqir <= 2
00000785    move '02' to ws-optm-sql-exec
00000786    perform 2102-browse thru 2102-browse-x
00000789    when ws-optm-sql-reqir <= 3
00000790    move '03' to ws-optm-sql-exec
00000791    perform 2103-browse thru 2103-browse-x
00000794    when ws-optm-sql-reqir <= 4
00000795    move '04' to ws-optm-sql-exec
00000796    perform 2104-browse thru 2104-browse-x
00000799    when ws-optm-sql-reqir <= 5
00000800    move '05' to ws-optm-sql-exec
00000801    perform 210g-browse thru 210g-browse-x
00000804    when other
00000805    move spaces to ws-optm-sql-exec
00000806    set wfd-io-error to true
00000808    end-evaluate.
00000811    move ws-optm-sql-reqir to wfd-optm-sql-reqir.
00000812    move ws-optm-sql-exec to wfd-optm-sql-exec.
00000814    if wfd-optm-sql-exec = wfd-optm-sql-reqir
00000815    set wfd-optm-sql-ok to true
00000816    else
00000817    if wfd-optm-sql-exec = spaces
00000818    set wfd-optm-sql-error to true
00000819    else
00000820    set wfd-optm-sql-imprv to true
00000821    end-if
00000822    end-if.
000008252000-exec-browse-x.
00000826    exit.
000008302102-browse.
00000836    initialize wgpol-work-area
00000838    move wfd-pol-id to wgpol-pol-id
00000841    perform gpol-part-valu-calc thru gpol-part-valu-calc-x
00000844    move wgpol-part-valu to xat09-no-par
00000848    exec sql
00000849    declare fdb2cur cursor for
00000850    select
00000852    co_id,
00000853    pol_id,
00000854    cvg_num,
00000855    fnd_id,
00000856    fia_eff_dt,
00000857    fia_tmsp,
00000858    fia_vers_ctr,
00000859    nxt_fia_fnd_id,
00000860    fia_revrs_stat_cd,
00000861    fia_unit_stat_cd,
00000862    fia_in_alloc_pct,
00000863    fia_out_alloc_pct,
00000864    fia_valu_surr_pct,
00000865    fia_fnd_trxn_amt,
00000866    fia_load_amt,
00000867    pend_dpos_int_amt,
00000868    fia_pend_amt,
00000869    fia_surr_unit_qty,
00000870    fia_iunit_pric_amt,
00000871    fia_aunit_pric_amt,
00000872    fia_intg_iunit_qty,
00000873    fia_dcml_iunit_qty,
00000874    fia_intg_aunit_qty,
00000875    fia_dcml_aunit_qty,
00000876    cfn_trxn_ltd_amt,
00000877    cfn_load_ltd_amt,
00000878    cfn_int_ltd_amt,
00000879    cfn_pend_ltd_amt,
00000880    cfn_intg_iunit_qty,
00000881    cfn_dcml_iunit_qty,
00000882    cfn_intg_aunit_qty,
00000883    cfn_dcml_aunit_qty,
00000884    fia_gla_cd,
00000885    fia_fnd_gla_amt,
00000886    fia_gnrl_gla_amt,
00000887    fia_revrs_gla_cd,
00000888    revrs_fnd_gla_amt,
00000889    revrs_gnrl_gla_amt,
00000890    fia_valn_eff_dt,
00000891    pend_dpos_tmg_amt,
00000893    wthdr_typ_cd,
00000897    cfn_csv_ltd_amt
00000898    ,payo_v1_csv_amt
00000899    ,payo_v2_csv_amt
00000900    ,fndvl_eff_dt
00000901    ,div_src_fnd_id
00000902    ,fnd_xpns_tax_rt
00000903    ,rbt_amt
00000904    ,alloc_pct
00000905    ,sell_ntcd_amt
00000907    ,fnd_ref_amt
00000908    ,fnd_manag_obj_id
00000910    ,insur_intg_mdt_fee_qty
00000911    ,insur_dcml_mdt_fee_qty
00000912    ,insur_mdt_fee_amt
00000913    ,insur_mdt_fee_pct
00000914    ,retail_intg_mdt_fee_qty
00000915    ,retail_dcml_mdt_fee_qty
00000916    ,retail_mdt_fee_amt
00000917    ,retail_mdt_fee_pct
00000918    ,trust_intg_mdt_fee_qty
00000919    ,trust_dcml_mdt_fee_qty
00000920    ,trust_mdt_fee_amt
00000921    ,trust_mdt_fee_pct
00000922    ,mvt_wgt_in_out_amt
00000923    ,surr_valu_gar_amt
00000924    ,trg_uct_qty
00000925    ,mdu_pab_amt
00000926    ,div_intg_defer_qty
00000927    ,div_dcml_defer_qty
00000928    ,pmts_wthdr_defer_dt
00000929    from vita078
00000930    where
00000931    part_valu = :xat09-no-par and
00000932    co_id = :wfd-co-id and
00000933    pol_id = :wfd-pol-id and
00000934    cvg_num = :wfd-cvg-num and
00000935    fnd_id = :wfd-fnd-id
00000936    and
00000937    fia_eff_dt between
00000938    :wfd-fia-eff-dt and
00000939    :wfd-endbr-fia-eff-dt
00000940    and
00000941    (fia_tmsp >= :wfd-fia-tmsp or
00000942    fia_eff_dt > :wfd-fia-eff-dt)
00000943    and
00000944    (fia_tmsp <= :wfd-endbr-fia-tmsp or
00000945    fia_eff_dt < :wfd-endbr-fia-eff-dt)
00001033    order by
00001034    fia_eff_dt,
00001035    fia_tmsp
00001037    for fetch only
00001039    end-exec.
00001041    exec sql
00001042    open fdb2cur
00001043    end-exec.
00000847    initialize rfd-viid437-read-key
00001046    evaluate sqlcode
00001048    when zero
00001049    set wfd-io-ok to true
00001051    when other
00001052    set wfd-io-error to true
00001054    end-evaluate.
000010572102-browse-x.
00001058    exit.
000010612103-browse.
00001066    initialize wgpol-work-area
00001068    move wfd-pol-id to wgpol-pol-id
00001071    perform gpol-part-valu-calc thru gpol-part-valu-calc-x
00001074    move wgpol-part-valu to xat09-no-par
00001079    exec sql
00001080    declare fdb3cur cursor for
00001081    select
00001083    co_id,
00001084    pol_id,
00001085    cvg_num,
00001086    fnd_id,
00001087    fia_eff_dt,
00001088    fia_tmsp,
00001089    fia_vers_ctr,
00001090    nxt_fia_fnd_id,
00001091    fia_revrs_stat_cd,
00001092    fia_unit_stat_cd,
00001093    fia_in_alloc_pct,
00001094    fia_out_alloc_pct,
00001095    fia_valu_surr_pct,
00001096    fia_fnd_trxn_amt,
00001097    fia_load_amt,
00001098    pend_dpos_int_amt,
00001099    fia_pend_amt,
00001100    fia_surr_unit_qty,
00001101    fia_iunit_pric_amt,
00001102    fia_aunit_pric_amt,
00001103    fia_intg_iunit_qty,
00001104    fia_dcml_iunit_qty,
00001105    fia_intg_aunit_qty,
00001106    fia_dcml_aunit_qty,
00001107    cfn_trxn_ltd_amt,
00001108    cfn_load_ltd_amt,
00001109    cfn_int_ltd_amt,
00001110    cfn_pend_ltd_amt,
00001111    cfn_intg_iunit_qty,
00001112    cfn_dcml_iunit_qty,
00001113    cfn_intg_aunit_qty,
00001114    cfn_dcml_aunit_qty,
00001115    fia_gla_cd,
00001116    fia_fnd_gla_amt,
00001117    fia_gnrl_gla_amt,
00001118    fia_revrs_gla_cd,
00001119    revrs_fnd_gla_amt,
00001120    revrs_gnrl_gla_amt,
00001121    fia_valn_eff_dt,
00001122    pend_dpos_tmg_amt,
00001124    wthdr_typ_cd,
00001128    cfn_csv_ltd_amt
00001129    ,payo_v1_csv_amt
00001130    ,payo_v2_csv_amt
00001131    ,fndvl_eff_dt
00001132    ,div_src_fnd_id
00001133    ,fnd_xpns_tax_rt
00001134    ,rbt_amt
00001135    ,alloc_pct
00001136    ,sell_ntcd_amt
00001138    ,fnd_ref_amt
00001139    ,fnd_manag_obj_id
00001141    ,insur_intg_mdt_fee_qty
00001142    ,insur_dcml_mdt_fee_qty
00001143    ,insur_mdt_fee_amt
00001144    ,insur_mdt_fee_pct
00001145    ,retail_intg_mdt_fee_qty
00001146    ,retail_dcml_mdt_fee_qty
00001147    ,retail_mdt_fee_amt
00001148    ,retail_mdt_fee_pct
00001149    ,trust_intg_mdt_fee_qty
00001150    ,trust_dcml_mdt_fee_qty
00001151    ,trust_mdt_fee_amt
00001152    ,trust_mdt_fee_pct
00001153    ,mvt_wgt_in_out_amt
00001154    ,surr_valu_gar_amt
00001155    ,trg_uct_qty
00001156    ,mdu_pab_amt
00001157    ,div_intg_defer_qty
00001158    ,div_dcml_defer_qty
00001159    ,pmts_wthdr_defer_dt
00001160    from vita078
00001161    where
00001162    part_valu = :xat09-no-par and
00001163    co_id = :wfd-co-id and
00001164    pol_id = :wfd-pol-id and
00001165    cvg_num = :wfd-cvg-num and
00001166    fia_eff_dt = :wfd-fia-eff-dt and
00001167    fia_tmsp = :wfd-fia-tmsp
00001168    and
00001169    fnd_id between
00001170    :wfd-fnd-id and
00001171    :wfd-endbr-fnd-id
00001258    order by
00001259    fnd_id
00001261    for fetch only
00001263    end-exec.
00001265    exec sql
00001266    open fdb3cur
00001267    end-exec.
00001078    initialize rfd-viid437-read-key
00001270    evaluate sqlcode
00001272    when zero
00001273    set wfd-io-ok to true
00001275    when other
00001276    set wfd-io-error to true
00001278    end-evaluate.
000012802103-browse-x.
00001281    exit.
000012852104-browse.
00001291    initialize wgpol-work-area
00001293    move wfd-pol-id to wgpol-pol-id
00001296    perform gpol-part-valu-calc thru gpol-part-valu-calc-x
00001299    move wgpol-part-valu to xat09-no-par
00001303    exec sql
00001304    declare fdb4cur cursor for
00001305    select
00001307    co_id,
00001308    pol_id,
00001309    cvg_num,
00001310    fnd_id,
00001311    fia_eff_dt,
00001312    fia_tmsp,
00001313    fia_vers_ctr,
00001314    nxt_fia_fnd_id,
00001315    fia_revrs_stat_cd,
00001316    fia_unit_stat_cd,
00001317    fia_in_alloc_pct,
00001318    fia_out_alloc_pct,
00001319    fia_valu_surr_pct,
00001320    fia_fnd_trxn_amt,
00001321    fia_load_amt,
00001322    pend_dpos_int_amt,
00001323    fia_pend_amt,
00001324    fia_surr_unit_qty,
00001325    fia_iunit_pric_amt,
00001326    fia_aunit_pric_amt,
00001327    fia_intg_iunit_qty,
00001328    fia_dcml_iunit_qty,
00001329    fia_intg_aunit_qty,
00001330    fia_dcml_aunit_qty,
00001331    cfn_trxn_ltd_amt,
00001332    cfn_load_ltd_amt,
00001333    cfn_int_ltd_amt,
00001334    cfn_pend_ltd_amt,
00001335    cfn_intg_iunit_qty,
00001336    cfn_dcml_iunit_qty,
00001337    cfn_intg_aunit_qty,
00001338    cfn_dcml_aunit_qty,
00001339    fia_gla_cd,
00001340    fia_fnd_gla_amt,
00001341    fia_gnrl_gla_amt,
00001342    fia_revrs_gla_cd,
00001343    revrs_fnd_gla_amt,
00001344    revrs_gnrl_gla_amt,
00001345    fia_valn_eff_dt,
00001346    pend_dpos_tmg_amt,
00001348    wthdr_typ_cd,
00001352    cfn_csv_ltd_amt
00001353    ,payo_v1_csv_amt
00001354    ,payo_v2_csv_amt
00001355    ,fndvl_eff_dt
00001356    ,div_src_fnd_id
00001357    ,fnd_xpns_tax_rt
00001358    ,rbt_amt
00001359    ,alloc_pct
00001360    ,sell_ntcd_amt
00001362    ,fnd_ref_amt
00001363    ,fnd_manag_obj_id
00001365    ,insur_intg_mdt_fee_qty
00001366    ,insur_dcml_mdt_fee_qty
00001367    ,insur_mdt_fee_amt
00001368    ,insur_mdt_fee_pct
00001369    ,retail_intg_mdt_fee_qty
00001370    ,retail_dcml_mdt_fee_qty
00001371    ,retail_mdt_fee_amt
00001372    ,retail_mdt_fee_pct
00001373    ,trust_intg_mdt_fee_qty
00001374    ,trust_dcml_mdt_fee_qty
00001375    ,trust_mdt_fee_amt
00001376    ,trust_mdt_fee_pct
00001377    ,mvt_wgt_in_out_amt
00001378    ,surr_valu_gar_amt
00001379    ,trg_uct_qty
00001380    ,mdu_pab_amt
00001381    ,div_intg_defer_qty
00001382    ,div_dcml_defer_qty
00001383    ,pmts_wthdr_defer_dt
00001384    from vita078
00001385    where
00001386    part_valu = :xat09-no-par and
00001387    co_id = :wfd-co-id and
00001388    pol_id = :wfd-pol-id
00001389    and
00001390    cvg_num between
00001391    :wfd-cvg-num and
00001392    :wfd-endbr-cvg-num
00001393    and
00001394    ((fnd_id = :wfd-fnd-id and
00001395    ((fia_eff_dt = :wfd-fia-eff-dt and
00001396    fia_tmsp >= :wfd-fia-tmsp) or
00001397    fia_eff_dt > :wfd-fia-eff-dt)) or
00001398    fnd_id > :wfd-fnd-id or
00001399    cvg_num > :wfd-cvg-num)
00001400    and
00001401    ((fnd_id = :wfd-endbr-fnd-id and
00001402    ((fia_eff_dt = :wfd-endbr-fia-eff-dt and
00001403    fia_tmsp <= :wfd-endbr-fia-tmsp) or
00001404    fia_eff_dt < :wfd-endbr-fia-eff-dt)) or
00001405    fnd_id < :wfd-endbr-fnd-id or
00001406    cvg_num < :wfd-endbr-cvg-num)
00001500    order by
00001501    cvg_num,
00001502    fnd_id,
00001503    fia_eff_dt,
00001504    fia_tmsp
00001506    for fetch only
00001508    end-exec.
00001510    exec sql
00001511    open fdb4cur
00001512    end-exec.
00001302    initialize rfd-viid437-read-key
00001515    evaluate sqlcode
00001517    when zero
00001518    set wfd-io-ok to true
00001520    when other
00001521    set wfd-io-error to true
00001523    end-evaluate.
000015262104-browse-x.
00001527    exit.
00001531210g-browse.
00001535    exec sql
00001536    declare fdbcur cursor for
00001537    select
00001539    co_id,
00001540    pol_id,
00001541    cvg_num,
00001542    fnd_id,
00001543    fia_eff_dt,
00001544    fia_tmsp,
00001545    fia_vers_ctr,
00001546    nxt_fia_fnd_id,
00001547    fia_revrs_stat_cd,
00001548    fia_unit_stat_cd,
00001549    fia_in_alloc_pct,
00001550    fia_out_alloc_pct,
00001551    fia_valu_surr_pct,
00001552    fia_fnd_trxn_amt,
00001553    fia_load_amt,
00001554    pend_dpos_int_amt,
00001555    fia_pend_amt,
00001556    fia_surr_unit_qty,
00001557    fia_iunit_pric_amt,
00001558    fia_aunit_pric_amt,
00001559    fia_intg_iunit_qty,
00001560    fia_dcml_iunit_qty,
00001561    fia_intg_aunit_qty,
00001562    fia_dcml_aunit_qty,
00001563    cfn_trxn_ltd_amt,
00001564    cfn_load_ltd_amt,
00001565    cfn_int_ltd_amt,
00001566    cfn_pend_ltd_amt,
00001567    cfn_intg_iunit_qty,
00001568    cfn_dcml_iunit_qty,
00001569    cfn_intg_aunit_qty,
00001570    cfn_dcml_aunit_qty,
00001571    fia_gla_cd,
00001572    fia_fnd_gla_amt,
00001573    fia_gnrl_gla_amt,
00001574    fia_revrs_gla_cd,
00001575    revrs_fnd_gla_amt,
00001576    revrs_gnrl_gla_amt,
00001577    fia_valn_eff_dt,
00001578    pend_dpos_tmg_amt,
00001580    wthdr_typ_cd,
00001584    cfn_csv_ltd_amt
00001585    ,payo_v1_csv_amt
00001586    ,payo_v2_csv_amt
00001587    ,fndvl_eff_dt
00001588    ,div_src_fnd_id
00001589    ,fnd_xpns_tax_rt
00001590    ,rbt_amt
00001591    ,alloc_pct
00001592    ,sell_ntcd_amt
00001594    ,fnd_ref_amt
00001595    ,fnd_manag_obj_id
00001597    ,insur_intg_mdt_fee_qty
00001598    ,insur_dcml_mdt_fee_qty
00001599    ,insur_mdt_fee_amt
00001600    ,insur_mdt_fee_pct
00001601    ,retail_intg_mdt_fee_qty
00001602    ,retail_dcml_mdt_fee_qty
00001603    ,retail_mdt_fee_amt
00001604    ,retail_mdt_fee_pct
00001605    ,trust_intg_mdt_fee_qty
00001606    ,trust_dcml_mdt_fee_qty
00001607    ,trust_mdt_fee_amt
00001608    ,trust_mdt_fee_pct
00001609    ,mvt_wgt_in_out_amt
00001610    ,surr_valu_gar_amt
00001611    ,trg_uct_qty
00001612    ,mdu_pab_amt
00001613    ,div_intg_defer_qty
00001614    ,div_dcml_defer_qty
00001615    ,pmts_wthdr_defer_dt
00001616    from vita078
00001617    where
00001618    co_id = :wfd-co-id
00001619    and
00001620    pol_id between
00001621    :wfd-pol-id and
00001622    :wfd-endbr-pol-id
00001623    and
00001624    ((cvg_num = :wfd-cvg-num and
00001625    ((fnd_id = :wfd-fnd-id and
00001626    ((fia_eff_dt = :wfd-fia-eff-dt and
00001627    fia_tmsp >= :wfd-fia-tmsp) or
00001628    fia_eff_dt > :wfd-fia-eff-dt)) or
00001629    fnd_id > :wfd-fnd-id)) or
00001630    cvg_num > :wfd-cvg-num or
00001631    pol_id > :wfd-pol-id)
00001632    and
00001633    ((cvg_num = :wfd-endbr-cvg-num and
00001634    ((fnd_id = :wfd-endbr-fnd-id and
00001635    ((fia_eff_dt = :wfd-endbr-fia-eff-dt and
00001636    fia_tmsp <= :wfd-endbr-fia-tmsp) or
00001637    fia_eff_dt < :wfd-endbr-fia-eff-dt)) or
00001638    fnd_id < :wfd-endbr-fnd-id)) or
00001639    cvg_num < :wfd-endbr-cvg-num or
00001640    pol_id < :wfd-endbr-pol-id)
00001736    order by
00001737    pol_id,
00001738    cvg_num,
00001739    fnd_id,
00001740    fia_eff_dt,
00001741    fia_tmsp
00001743    for fetch only
00001745    end-exec.
00001747    exec sql
00001748    open fdbcur
00001749    end-exec.
00001534    initialize rfd-viid437-read-key
00001752    evaluate sqlcode
00001754    when zero
00001755    set wfd-io-ok to true
00001757    when other
00001758    set wfd-io-error to true
00001760    end-evaluate.
00001763210g-browse-x.
00001764    exit.
000017683000-exec-fetch-next.
00001771    evaluate ws-optm-sql-exec
00001773    when '02'
00001774    perform 3102-fetch-next thru 3102-fetch-next-x
00001777    when '03'
00001778    perform 3103-fetch-next thru 3103-fetch-next-x
00001781    when '04'
00001782    perform 3104-fetch-next thru 3104-fetch-next-x
00001785    when '05'
00001786    perform 310g-fetch-next thru 310g-fetch-next-x
00001789    when other
00001790    perform 310g-fetch-next thru 310g-fetch-next-x
00001793    end-evaluate.
00001796    set wfd-optm-sql-ok to true.
00001797    move spaces to wfd-optm-sql-reqir.
00001798    move spaces to wfd-optm-sql-exec.
000018013000-exec-fetch-next-x.
00001802    exit.
000018043102-fetch-next.
00001809    exec sql
00001810    fetch fdb2cur
00001811    into
00001813    :rfd-co-id,
00001814    :rfd-pol-id,
00001815    :rfd-cvg-num,
00001816    :rfd-fnd-id,
00001817    :rfd-fia-eff-dt,
00001818    :rfd-fia-tmsp,
00001819    :rfd-fia-vers-ctr,
00001820    :rfd-nxt-fia-fnd-id :zfd-nxt-fia-fnd-id-ni,
00001821    :rfd-fia-revrs-stat-cd,
00001822    :rfd-fia-unit-stat-cd,
00001823    :rfd-fia-in-alloc-pct,
00001824    :rfd-fia-out-alloc-pct,
00001825    :rfd-fia-valu-surr-pct,
00001826    :rfd-fia-fnd-trxn-amt,
00001827    :rfd-fia-load-amt,
00001828    :rfd-pend-dpos-int-amt,
00001829    :rfd-fia-pend-amt,
00001830    :rfd-fia-surr-unit-qty,
00001831    :rfd-fia-iunit-pric-amt,
00001832    :rfd-fia-aunit-pric-amt,
00001833    :rfd-fia-intg-iunit-qty,
00001834    :rfd-fia-dcml-iunit-qty,
00001835    :rfd-fia-intg-aunit-qty,
00001836    :rfd-fia-dcml-aunit-qty,
00001837    :rfd-cfn-trxn-ltd-amt,
00001838    :rfd-cfn-load-ltd-amt,
00001839    :rfd-cfn-int-ltd-amt,
00001840    :rfd-cfn-pend-ltd-amt,
00001841    :rfd-cfn-intg-iunit-qty,
00001842    :rfd-cfn-dcml-iunit-qty,
00001843    :rfd-cfn-intg-aunit-qty,
00001844    :rfd-cfn-dcml-aunit-qty,
00001845    :rfd-fia-gla-cd,
00001846    :rfd-fia-fnd-gla-amt,
00001847    :rfd-fia-gnrl-gla-amt,
00001848    :rfd-fia-revrs-gla-cd,
00001849    :rfd-revrs-fnd-gla-amt,
00001850    :rfd-revrs-gnrl-gla-amt,
00001851    :rfd-fia-valn-eff-dt :zfd-fia-valn-eff-dt-ni,
00001852    :rfd-pend-dpos-tmg-amt,
00001854    :rfd-wthdr-typ-cd,
00001858    :rfd-cfn-csv-ltd-amt
00001859    ,:rfd-payo-v1-csv-amt
00001860    ,:rfd-payo-v2-csv-amt
00001861    ,:rfd-fndvl-eff-dt
00001862    ,:rfd-div-src-fnd-id
00001863    ,:rfd-fnd-xpns-tax-rt
00001864    ,:rfd-rbt-amt
00001865    ,:rfd-alloc-pct
00001866    ,:rfd-sell-ntcd-amt
00001868    ,:rfd-fnd-ref-amt
00001869    ,:rfd-fnd-manag-obj-id
00001871    ,:rfd-insur-intg-mdt-fee-qty
00001872    ,:rfd-insur-dcml-mdt-fee-qty
00001873    ,:rfd-insur-mdt-fee-amt
00001874    ,:rfd-insur-mdt-fee-pct
00001875    ,:rfd-retail-intg-mdt-fee-qty
00001876    ,:rfd-retail-dcml-mdt-fee-qty
00001877    ,:rfd-retail-mdt-fee-amt
00001878    ,:rfd-retail-mdt-fee-pct
00001879    ,:rfd-trust-intg-mdt-fee-qty
00001880    ,:rfd-trust-dcml-mdt-fee-qty
00001881    ,:rfd-trust-mdt-fee-amt
00001882    ,:rfd-trust-mdt-fee-pct
00001883    ,:rfd-mvt-wgt-in-out-amt
00001884    ,:rfd-surr-valu-gar-amt
00001885    ,:rfd-trg-uct-qty
00001886    ,:rfd-mdu-pab-amt
00001887    ,:rfd-div-intg-defer-qty
00001888    ,:rfd-div-dcml-defer-qty
00001889    ,:rfd-pmts-wthdr-defer-dt
00001890    end-exec.
00001807    move low-values to zfd-null-indicators.
00001893    evaluate sqlcode
00001895    when zero
00001896    set wfd-io-ok to true
00001897    perform fd-2000-set-null-dflt thru fd-2000-set-null-dflt-x
00001899    move rfd-key to wfd-key
00001901    when +100
00001902    set wfd-io-eof to true
00001904    when other
00001905    set wfd-io-error to true
00001907    end-evaluate.
00001909    if rfd-key = rfd-viid437-read-key and wfd-io-ok
00001913    exec sql
00001914    fetch fdb2cur
00001915    into
00001917    :rfd-co-id,
00001918    :rfd-pol-id,
00001919    :rfd-cvg-num,
00001920    :rfd-fnd-id,
00001921    :rfd-fia-eff-dt,
00001922    :rfd-fia-tmsp,
00001923    :rfd-fia-vers-ctr,
00001924    :rfd-nxt-fia-fnd-id :zfd-nxt-fia-fnd-id-ni,
00001925    :rfd-fia-revrs-stat-cd,
00001926    :rfd-fia-unit-stat-cd,
00001927    :rfd-fia-in-alloc-pct,
00001928    :rfd-fia-out-alloc-pct,
00001929    :rfd-fia-valu-surr-pct,
00001930    :rfd-fia-fnd-trxn-amt,
00001931    :rfd-fia-load-amt,
00001932    :rfd-pend-dpos-int-amt,
00001933    :rfd-fia-pend-amt,
00001934    :rfd-fia-surr-unit-qty,
00001935    :rfd-fia-iunit-pric-amt,
00001936    :rfd-fia-aunit-pric-amt,
00001937    :rfd-fia-intg-iunit-qty,
00001938    :rfd-fia-dcml-iunit-qty,
00001939    :rfd-fia-intg-aunit-qty,
00001940    :rfd-fia-dcml-aunit-qty,
00001941    :rfd-cfn-trxn-ltd-amt,
00001942    :rfd-cfn-load-ltd-amt,
00001943    :rfd-cfn-int-ltd-amt,
00001944    :rfd-cfn-pend-ltd-amt,
00001945    :rfd-cfn-intg-iunit-qty,
00001946    :rfd-cfn-dcml-iunit-qty,
00001947    :rfd-cfn-intg-aunit-qty,
00001948    :rfd-cfn-dcml-aunit-qty,
00001949    :rfd-fia-gla-cd,
00001950    :rfd-fia-fnd-gla-amt,
00001951    :rfd-fia-gnrl-gla-amt,
00001952    :rfd-fia-revrs-gla-cd,
00001953    :rfd-revrs-fnd-gla-amt,
00001954    :rfd-revrs-gnrl-gla-amt,
00001955    :rfd-fia-valn-eff-dt :zfd-fia-valn-eff-dt-ni,
00001956    :rfd-pend-dpos-tmg-amt,
00001957    :rfd-wthdr-typ-cd,
00001958    :rfd-cfn-csv-ltd-amt
00001959    ,:rfd-payo-v1-csv-amt
00001960    ,:rfd-payo-v2-csv-amt
00001961    ,:rfd-fndvl-eff-dt
00001962    ,:rfd-div-src-fnd-id
00001963    ,:rfd-fnd-xpns-tax-rt
00001964    ,:rfd-rbt-amt
00001965    ,:rfd-alloc-pct
00001966    ,:rfd-sell-ntcd-amt
00001968    ,:rfd-fnd-ref-amt
00001969    ,:rfd-fnd-manag-obj-id
00001971    ,:rfd-insur-intg-mdt-fee-qty
00001972    ,:rfd-insur-dcml-mdt-fee-qty
00001973    ,:rfd-insur-mdt-fee-amt
00001974    ,:rfd-insur-mdt-fee-pct
00001975    ,:rfd-retail-intg-mdt-fee-qty
00001976    ,:rfd-retail-dcml-mdt-fee-qty
00001977    ,:rfd-retail-mdt-fee-amt
00001978    ,:rfd-retail-mdt-fee-pct
00001979    ,:rfd-trust-intg-mdt-fee-qty
00001980    ,:rfd-trust-dcml-mdt-fee-qty
00001981    ,:rfd-trust-mdt-fee-amt
00001982    ,:rfd-trust-mdt-fee-pct
00001983    ,:rfd-mvt-wgt-in-out-amt
00001984    ,:rfd-surr-valu-gar-amt
00001985    ,:rfd-trg-uct-qty
00001986    ,:rfd-mdu-pab-amt
00001987    ,:rfd-div-intg-defer-qty
00001988    ,:rfd-div-dcml-defer-qty
00001989    ,:rfd-pmts-wthdr-defer-dt
00001990    end-exec
00001911    move low-values to zfd-null-indicators
00001993    evaluate sqlcode
00001995    when zero
00001996    set wfd-io-ok to true
00001997    perform fd-2000-set-null-dflt thru fd-2000-set-null-dflt-x
00001999    move rfd-key to wfd-key
00002001    when +100
00002002    set wfd-io-eof to true
00002004    when other
00002005    set wfd-io-error to true
00002007    end-evaluate
00002008    end-if
00002010    move rfd-key to rfd-viid437-read-key
00002011    continue.
000020133102-fetch-next-x.
00002014    exit.
000020183103-fetch-next.
00002023    exec sql
00002024    fetch fdb3cur
00002025    into
00002027    :rfd-co-id,
00002028    :rfd-pol-id,
00002029    :rfd-cvg-num,
00002030    :rfd-fnd-id,
00002031    :rfd-fia-eff-dt,
00002032    :rfd-fia-tmsp,
00002033    :rfd-fia-vers-ctr,
00002034    :rfd-nxt-fia-fnd-id :zfd-nxt-fia-fnd-id-ni,
00002035    :rfd-fia-revrs-stat-cd,
00002036    :rfd-fia-unit-stat-cd,
00002037    :rfd-fia-in-alloc-pct,
00002038    :rfd-fia-out-alloc-pct,
00002039    :rfd-fia-valu-surr-pct,
00002040    :rfd-fia-fnd-trxn-amt,
00002041    :rfd-fia-load-amt,
00002042    :rfd-pend-dpos-int-amt,
00002043    :rfd-fia-pend-amt,
00002044    :rfd-fia-surr-unit-qty,
00002045    :rfd-fia-iunit-pric-amt,
00002046    :rfd-fia-aunit-pric-amt,
00002047    :rfd-fia-intg-iunit-qty,
00002048    :rfd-fia-dcml-iunit-qty,
00002049    :rfd-fia-intg-aunit-qty,
00002050    :rfd-fia-dcml-aunit-qty,
00002051    :rfd-cfn-trxn-ltd-amt,
00002052    :rfd-cfn-load-ltd-amt,
00002053    :rfd-cfn-int-ltd-amt,
00002054    :rfd-cfn-pend-ltd-amt,
00002055    :rfd-cfn-intg-iunit-qty,
00002056    :rfd-cfn-dcml-iunit-qty,
00002057    :rfd-cfn-intg-aunit-qty,
00002058    :rfd-cfn-dcml-aunit-qty,
00002059    :rfd-fia-gla-cd,
00002060    :rfd-fia-fnd-gla-amt,
00002061    :rfd-fia-gnrl-gla-amt,
00002062    :rfd-fia-revrs-gla-cd,
00002063    :rfd-revrs-fnd-gla-amt,
00002064    :rfd-revrs-gnrl-gla-amt,
00002065    :rfd-fia-valn-eff-dt :zfd-fia-valn-eff-dt-ni,
00002066    :rfd-pend-dpos-tmg-amt,
00002068    :rfd-wthdr-typ-cd,
00002072    :rfd-cfn-csv-ltd-amt
00002073    ,:rfd-payo-v1-csv-amt
00002074    ,:rfd-payo-v2-csv-amt
00002075    ,:rfd-fndvl-eff-dt
00002076    ,:rfd-div-src-fnd-id
00002077    ,:rfd-fnd-xpns-tax-rt
00002078    ,:rfd-rbt-amt
00002079    ,:rfd-alloc-pct
00002080    ,:rfd-sell-ntcd-amt
00002082    ,:rfd-fnd-ref-amt
00002083    ,:rfd-fnd-manag-obj-id
00002085    ,:rfd-insur-intg-mdt-fee-qty
00002086    ,:rfd-insur-dcml-mdt-fee-qty
00002087    ,:rfd-insur-mdt-fee-amt
00002088    ,:rfd-insur-mdt-fee-pct
00002089    ,:rfd-retail-intg-mdt-fee-qty
00002090    ,:rfd-retail-dcml-mdt-fee-qty
00002091    ,:rfd-retail-mdt-fee-amt
00002092    ,:rfd-retail-mdt-fee-pct
00002093    ,:rfd-trust-intg-mdt-fee-qty
00002094    ,:rfd-trust-dcml-mdt-fee-qty
00002095    ,:rfd-trust-mdt-fee-amt
00002096    ,:rfd-trust-mdt-fee-pct
00002097    ,:rfd-mvt-wgt-in-out-amt
00002098    ,:rfd-surr-valu-gar-amt
00002099    ,:rfd-trg-uct-qty
00002100    ,:rfd-mdu-pab-amt
00002101    ,:rfd-div-intg-defer-qty
00002102    ,:rfd-div-dcml-defer-qty
00002103    ,:rfd-pmts-wthdr-defer-dt
00002104    end-exec.
00002021    move low-values to zfd-null-indicators.
00002107    evaluate sqlcode
00002109    when zero
00002110    set wfd-io-ok to true
00002111    perform fd-2000-set-null-dflt thru fd-2000-set-null-dflt-x
00002113    move rfd-key to wfd-key
00002115    when +100
00002116    set wfd-io-eof to true
00002118    when other
00002119    set wfd-io-error to true
00002121    end-evaluate.
00002123    if rfd-key = rfd-viid437-read-key and wfd-io-ok
00002127    exec sql
00002128    fetch fdb3cur
00002129    into
00002131    :rfd-co-id,
00002132    :rfd-pol-id,
00002133    :rfd-cvg-num,
00002134    :rfd-fnd-id,
00002135    :rfd-fia-eff-dt,
00002136    :rfd-fia-tmsp,
00002137    :rfd-fia-vers-ctr,
00002138    :rfd-nxt-fia-fnd-id :zfd-nxt-fia-fnd-id-ni,
00002139    :rfd-fia-revrs-stat-cd,
00002140    :rfd-fia-unit-stat-cd,
00002141    :rfd-fia-in-alloc-pct,
00002142    :rfd-fia-out-alloc-pct,
00002143    :rfd-fia-valu-surr-pct,
00002144    :rfd-fia-fnd-trxn-amt,
00002145    :rfd-fia-load-amt,
00002146    :rfd-pend-dpos-int-amt,
00002147    :rfd-fia-pend-amt,
00002148    :rfd-fia-surr-unit-qty,
00002149    :rfd-fia-iunit-pric-amt,
00002150    :rfd-fia-aunit-pric-amt,
00002151    :rfd-fia-intg-iunit-qty,
00002152    :rfd-fia-dcml-iunit-qty,
00002153    :rfd-fia-intg-aunit-qty,
00002154    :rfd-fia-dcml-aunit-qty,
00002155    :rfd-cfn-trxn-ltd-amt,
00002156    :rfd-cfn-load-ltd-amt,
00002157    :rfd-cfn-int-ltd-amt,
00002158    :rfd-cfn-pend-ltd-amt,
00002159    :rfd-cfn-intg-iunit-qty,
00002160    :rfd-cfn-dcml-iunit-qty,
00002161    :rfd-cfn-intg-aunit-qty,
00002162    :rfd-cfn-dcml-aunit-qty,
00002163    :rfd-fia-gla-cd,
00002164    :rfd-fia-fnd-gla-amt,
00002165    :rfd-fia-gnrl-gla-amt,
00002166    :rfd-fia-revrs-gla-cd,
00002167    :rfd-revrs-fnd-gla-amt,
00002168    :rfd-revrs-gnrl-gla-amt,
00002169    :rfd-fia-valn-eff-dt :zfd-fia-valn-eff-dt-ni,
00002170    :rfd-pend-dpos-tmg-amt,
00002171    :rfd-wthdr-typ-cd,
00002172    :rfd-cfn-csv-ltd-amt
00002173    ,:rfd-payo-v1-csv-amt
00002174    ,:rfd-payo-v2-csv-amt
00002175    ,:rfd-fndvl-eff-dt
00002176    ,:rfd-div-src-fnd-id
00002177    ,:rfd-fnd-xpns-tax-rt
00002178    ,:rfd-rbt-amt
00002179    ,:rfd-alloc-pct
00002180    ,:rfd-sell-ntcd-amt
00002182    ,:rfd-fnd-ref-amt
00002183    ,:rfd-fnd-manag-obj-id
00002185    ,:rfd-insur-intg-mdt-fee-qty
00002186    ,:rfd-insur-dcml-mdt-fee-qty
00002187    ,:rfd-insur-mdt-fee-amt
00002188    ,:rfd-insur-mdt-fee-pct
00002189    ,:rfd-retail-intg-mdt-fee-qty
00002190    ,:rfd-retail-dcml-mdt-fee-qty
00002191    ,:rfd-retail-mdt-fee-amt
00002192    ,:rfd-retail-mdt-fee-pct
00002193    ,:rfd-trust-intg-mdt-fee-qty
00002194    ,:rfd-trust-dcml-mdt-fee-qty
00002195    ,:rfd-trust-mdt-fee-amt
00002196    ,:rfd-trust-mdt-fee-pct
00002197    ,:rfd-mvt-wgt-in-out-amt
00002198    ,:rfd-surr-valu-gar-amt
00002199    ,:rfd-trg-uct-qty
00002200    ,:rfd-mdu-pab-amt
00002201    ,:rfd-div-intg-defer-qty
00002202    ,:rfd-div-dcml-defer-qty
00002203    ,:rfd-pmts-wthdr-defer-dt
00002204    end-exec
00002125    move low-values to zfd-null-indicators
00002207    evaluate sqlcode
00002209    when zero
00002210    set wfd-io-ok to true
00002211    perform fd-2000-set-null-dflt thru fd-2000-set-null-dflt-x
00002213    move rfd-key to wfd-key
00002215    when +100
00002216    set wfd-io-eof to true
00002218    when other
00002219    set wfd-io-error to true
00002221    end-evaluate
00002222    end-if
00002224    move rfd-key to rfd-viid437-read-key
00002225    continue.
000022273103-fetch-next-x.
00002228    exit.
000022323104-fetch-next.
00002237    exec sql
00002238    fetch fdb4cur
00002239    into
00002241    :rfd-co-id,
00002242    :rfd-pol-id,
00002243    :rfd-cvg-num,
00002244    :rfd-fnd-id,
00002245    :rfd-fia-eff-dt,
00002246    :rfd-fia-tmsp,
00002247    :rfd-fia-vers-ctr,
00002248    :rfd-nxt-fia-fnd-id :zfd-nxt-fia-fnd-id-ni,
00002249    :rfd-fia-revrs-stat-cd,
00002250    :rfd-fia-unit-stat-cd,
00002251    :rfd-fia-in-alloc-pct,
00002252    :rfd-fia-out-alloc-pct,
00002253    :rfd-fia-valu-surr-pct,
00002254    :rfd-fia-fnd-trxn-amt,
00002255    :rfd-fia-load-amt,
00002256    :rfd-pend-dpos-int-amt,
00002257    :rfd-fia-pend-amt,
00002258    :rfd-fia-surr-unit-qty,
00002259    :rfd-fia-iunit-pric-amt,
00002260    :rfd-fia-aunit-pric-amt,
00002261    :rfd-fia-intg-iunit-qty,
00002262    :rfd-fia-dcml-iunit-qty,
00002263    :rfd-fia-intg-aunit-qty,
00002264    :rfd-fia-dcml-aunit-qty,
00002265    :rfd-cfn-trxn-ltd-amt,
00002266    :rfd-cfn-load-ltd-amt,
00002267    :rfd-cfn-int-ltd-amt,
00002268    :rfd-cfn-pend-ltd-amt,
00002269    :rfd-cfn-intg-iunit-qty,
00002270    :rfd-cfn-dcml-iunit-qty,
00002271    :rfd-cfn-intg-aunit-qty,
00002272    :rfd-cfn-dcml-aunit-qty,
00002273    :rfd-fia-gla-cd,
00002274    :rfd-fia-fnd-gla-amt,
00002275    :rfd-fia-gnrl-gla-amt,
00002276    :rfd-fia-revrs-gla-cd,
00002277    :rfd-revrs-fnd-gla-amt,
00002278    :rfd-revrs-gnrl-gla-amt,
00002279    :rfd-fia-valn-eff-dt :zfd-fia-valn-eff-dt-ni,
00002280    :rfd-pend-dpos-tmg-amt,
00002282    :rfd-wthdr-typ-cd,
00002286    :rfd-cfn-csv-ltd-amt
00002287    ,:rfd-payo-v1-csv-amt
00002288    ,:rfd-payo-v2-csv-amt
00002289    ,:rfd-fndvl-eff-dt
00002290    ,:rfd-div-src-fnd-id
00002291    ,:rfd-fnd-xpns-tax-rt
00002292    ,:rfd-rbt-amt
00002293    ,:rfd-alloc-pct
00002294    ,:rfd-sell-ntcd-amt
00002296    ,:rfd-fnd-ref-amt
00002297    ,:rfd-fnd-manag-obj-id
00002299    ,:rfd-insur-intg-mdt-fee-qty
00002300    ,:rfd-insur-dcml-mdt-fee-qty
00002301    ,:rfd-insur-mdt-fee-amt
00002302    ,:rfd-insur-mdt-fee-pct
00002303    ,:rfd-retail-intg-mdt-fee-qty
00002304    ,:rfd-retail-dcml-mdt-fee-qty
00002305    ,:rfd-retail-mdt-fee-amt
00002306    ,:rfd-retail-mdt-fee-pct
00002307    ,:rfd-trust-intg-mdt-fee-qty
00002308    ,:rfd-trust-dcml-mdt-fee-qty
00002309    ,:rfd-trust-mdt-fee-amt
00002310    ,:rfd-trust-mdt-fee-pct
00002311    ,:rfd-mvt-wgt-in-out-amt
00002312    ,:rfd-surr-valu-gar-amt
00002313    ,:rfd-trg-uct-qty
00002314    ,:rfd-mdu-pab-amt
00002315    ,:rfd-div-intg-defer-qty
00002316    ,:rfd-div-dcml-defer-qty
00002317    ,:rfd-pmts-wthdr-defer-dt
00002318    end-exec.
00002235    move low-values to zfd-null-indicators.
00002321    evaluate sqlcode
00002323    when zero
00002324    set wfd-io-ok to true
00002325    perform fd-2000-set-null-dflt thru fd-2000-set-null-dflt-x
00002327    move rfd-key to wfd-key
00002329    when +100
00002330    set wfd-io-eof to true
00002332    when other
00002333    set wfd-io-error to true
00002335    end-evaluate.
00002337    if rfd-key = rfd-viid437-read-key and wfd-io-ok
00002341    exec sql
00002342    fetch fdb4cur
00002343    into
00002345    :rfd-co-id,
00002346    :rfd-pol-id,
00002347    :rfd-cvg-num,
00002348    :rfd-fnd-id,
00002349    :rfd-fia-eff-dt,
00002350    :rfd-fia-tmsp,
00002351    :rfd-fia-vers-ctr,
00002352    :rfd-nxt-fia-fnd-id :zfd-nxt-fia-fnd-id-ni,
00002353    :rfd-fia-revrs-stat-cd,
00002354    :rfd-fia-unit-stat-cd,
00002355    :rfd-fia-in-alloc-pct,
00002356    :rfd-fia-out-alloc-pct,
00002357    :rfd-fia-valu-surr-pct,
00002358    :rfd-fia-fnd-trxn-amt,
00002359    :rfd-fia-load-amt,
00002360    :rfd-pend-dpos-int-amt,
00002361    :rfd-fia-pend-amt,
00002362    :rfd-fia-surr-unit-qty,
00002363    :rfd-fia-iunit-pric-amt,
00002364    :rfd-fia-aunit-pric-amt,
00002365    :rfd-fia-intg-iunit-qty,
00002366    :rfd-fia-dcml-iunit-qty,
00002367    :rfd-fia-intg-aunit-qty,
00002368    :rfd-fia-dcml-aunit-qty,
00002369    :rfd-cfn-trxn-ltd-amt,
00002370    :rfd-cfn-load-ltd-amt,
00002371    :rfd-cfn-int-ltd-amt,
00002372    :rfd-cfn-pend-ltd-amt,
00002373    :rfd-cfn-intg-iunit-qty,
00002374    :rfd-cfn-dcml-iunit-qty,
00002375    :rfd-cfn-intg-aunit-qty,
00002376    :rfd-cfn-dcml-aunit-qty,
00002377    :rfd-fia-gla-cd,
00002378    :rfd-fia-fnd-gla-amt,
00002379    :rfd-fia-gnrl-gla-amt,
00002380    :rfd-fia-revrs-gla-cd,
00002381    :rfd-revrs-fnd-gla-amt,
00002382    :rfd-revrs-gnrl-gla-amt,
00002383    :rfd-fia-valn-eff-dt :zfd-fia-valn-eff-dt-ni,
00002384    :rfd-pend-dpos-tmg-amt,
00002385    :rfd-wthdr-typ-cd,
00002386    :rfd-cfn-csv-ltd-amt
00002387    ,:rfd-payo-v1-csv-amt
00002388    ,:rfd-payo-v2-csv-amt
00002389    ,:rfd-fndvl-eff-dt
00002390    ,:rfd-div-src-fnd-id
00002391    ,:rfd-fnd-xpns-tax-rt
00002392    ,:rfd-rbt-amt
00002393    ,:rfd-alloc-pct
00002394    ,:rfd-sell-ntcd-amt
00002396    ,:rfd-fnd-ref-amt
00002397    ,:rfd-fnd-manag-obj-id
00002399    ,:rfd-insur-intg-mdt-fee-qty
00002400    ,:rfd-insur-dcml-mdt-fee-qty
00002401    ,:rfd-insur-mdt-fee-amt
00002402    ,:rfd-insur-mdt-fee-pct
00002403    ,:rfd-retail-intg-mdt-fee-qty
00002404    ,:rfd-retail-dcml-mdt-fee-qty
00002405    ,:rfd-retail-mdt-fee-amt
00002406    ,:rfd-retail-mdt-fee-pct
00002407    ,:rfd-trust-intg-mdt-fee-qty
00002408    ,:rfd-trust-dcml-mdt-fee-qty
00002409    ,:rfd-trust-mdt-fee-amt
00002410    ,:rfd-trust-mdt-fee-pct
00002411    ,:rfd-mvt-wgt-in-out-amt
00002412    ,:rfd-surr-valu-gar-amt
00002413    ,:rfd-trg-uct-qty
00002414    ,:rfd-mdu-pab-amt
00002415    ,:rfd-div-intg-defer-qty
00002416    ,:rfd-div-dcml-defer-qty
00002417    ,:rfd-pmts-wthdr-defer-dt
00002418    end-exec
00002339    move low-values to zfd-null-indicators
00002421    evaluate sqlcode
00002423    when zero
00002424    set wfd-io-ok to true
00002425    perform fd-2000-set-null-dflt thru fd-2000-set-null-dflt-x
00002427    move rfd-key to wfd-key
00002429    when +100
00002430    set wfd-io-eof to true
00002432    when other
00002433    set wfd-io-error to true
00002435    end-evaluate
00002436    end-if
00002438    move rfd-key to rfd-viid437-read-key
00002439    continue.
000024413104-fetch-next-x.
00002442    exit.
00002446310g-fetch-next.
00002451    exec sql
00002452    fetch fdbcur
00002453    into
00002455    :rfd-co-id,
00002456    :rfd-pol-id,
00002457    :rfd-cvg-num,
00002458    :rfd-fnd-id,
00002459    :rfd-fia-eff-dt,
00002460    :rfd-fia-tmsp,
00002461    :rfd-fia-vers-ctr,
00002462    :rfd-nxt-fia-fnd-id :zfd-nxt-fia-fnd-id-ni,
00002463    :rfd-fia-revrs-stat-cd,
00002464    :rfd-fia-unit-stat-cd,
00002465    :rfd-fia-in-alloc-pct,
00002466    :rfd-fia-out-alloc-pct,
00002467    :rfd-fia-valu-surr-pct,
00002468    :rfd-fia-fnd-trxn-amt,
00002469    :rfd-fia-load-amt,
00002470    :rfd-pend-dpos-int-amt,
00002471    :rfd-fia-pend-amt,
00002472    :rfd-fia-surr-unit-qty,
00002473    :rfd-fia-iunit-pric-amt,
00002474    :rfd-fia-aunit-pric-amt,
00002475    :rfd-fia-intg-iunit-qty,
00002476    :rfd-fia-dcml-iunit-qty,
00002477    :rfd-fia-intg-aunit-qty,
00002478    :rfd-fia-dcml-aunit-qty,
00002479    :rfd-cfn-trxn-ltd-amt,
00002480    :rfd-cfn-load-ltd-amt,
00002481    :rfd-cfn-int-ltd-amt,
00002482    :rfd-cfn-pend-ltd-amt,
00002483    :rfd-cfn-intg-iunit-qty,
00002484    :rfd-cfn-dcml-iunit-qty,
00002485    :rfd-cfn-intg-aunit-qty,
00002486    :rfd-cfn-dcml-aunit-qty,
00002487    :rfd-fia-gla-cd,
00002488    :rfd-fia-fnd-gla-amt,
00002489    :rfd-fia-gnrl-gla-amt,
00002490    :rfd-fia-revrs-gla-cd,
00002491    :rfd-revrs-fnd-gla-amt,
00002492    :rfd-revrs-gnrl-gla-amt,
00002493    :rfd-fia-valn-eff-dt :zfd-fia-valn-eff-dt-ni,
00002494    :rfd-pend-dpos-tmg-amt,
00002496    :rfd-wthdr-typ-cd,
00002500    :rfd-cfn-csv-ltd-amt
00002501    ,:rfd-payo-v1-csv-amt
00002502    ,:rfd-payo-v2-csv-amt
00002503    ,:rfd-fndvl-eff-dt
00002504    ,:rfd-div-src-fnd-id
00002505    ,:rfd-fnd-xpns-tax-rt
00002506    ,:rfd-rbt-amt
00002507    ,:rfd-alloc-pct
00002508    ,:rfd-sell-ntcd-amt
00002510    ,:rfd-fnd-ref-amt
00002511    ,:rfd-fnd-manag-obj-id
00002513    ,:rfd-insur-intg-mdt-fee-qty
00002514    ,:rfd-insur-dcml-mdt-fee-qty
00002515    ,:rfd-insur-mdt-fee-amt
00002516    ,:rfd-insur-mdt-fee-pct
00002517    ,:rfd-retail-intg-mdt-fee-qty
00002518    ,:rfd-retail-dcml-mdt-fee-qty
00002519    ,:rfd-retail-mdt-fee-amt
00002520    ,:rfd-retail-mdt-fee-pct
00002521    ,:rfd-trust-intg-mdt-fee-qty
00002522    ,:rfd-trust-dcml-mdt-fee-qty
00002523    ,:rfd-trust-mdt-fee-amt
00002524    ,:rfd-trust-mdt-fee-pct
00002525    ,:rfd-mvt-wgt-in-out-amt
00002526    ,:rfd-surr-valu-gar-amt
00002527    ,:rfd-trg-uct-qty
00002528    ,:rfd-mdu-pab-amt
00002529    ,:rfd-div-intg-defer-qty
00002530    ,:rfd-div-dcml-defer-qty
00002531    ,:rfd-pmts-wthdr-defer-dt
00002532    end-exec.
00002449    move low-values to zfd-null-indicators.
00002535    evaluate sqlcode
00002537    when zero
00002538    set wfd-io-ok to true
00002539    perform fd-2000-set-null-dflt thru fd-2000-set-null-dflt-x
00002541    move rfd-key to wfd-key
00002543    when +100
00002544    set wfd-io-eof to true
00002546    when other
00002547    set wfd-io-error to true
00002549    end-evaluate.
00002551    if rfd-key = rfd-viid437-read-key and wfd-io-ok
00002555    exec sql
00002556    fetch fdbcur
00002557    into
00002559    :rfd-co-id,
00002560    :rfd-pol-id,
00002561    :rfd-cvg-num,
00002562    :rfd-fnd-id,
00002563    :rfd-fia-eff-dt,
00002564    :rfd-fia-tmsp,
00002565    :rfd-fia-vers-ctr,
00002566    :rfd-nxt-fia-fnd-id :zfd-nxt-fia-fnd-id-ni,
00002567    :rfd-fia-revrs-stat-cd,
00002568    :rfd-fia-unit-stat-cd,
00002569    :rfd-fia-in-alloc-pct,
00002570    :rfd-fia-out-alloc-pct,
00002571    :rfd-fia-valu-surr-pct,
00002572    :rfd-fia-fnd-trxn-amt,
00002573    :rfd-fia-load-amt,
00002574    :rfd-pend-dpos-int-amt,
00002575    :rfd-fia-pend-amt,
00002576    :rfd-fia-surr-unit-qty,
00002577    :rfd-fia-iunit-pric-amt,
00002578    :rfd-fia-aunit-pric-amt,
00002579    :rfd-fia-intg-iunit-qty,
00002580    :rfd-fia-dcml-iunit-qty,
00002581    :rfd-fia-intg-aunit-qty,
00002582    :rfd-fia-dcml-aunit-qty,
00002583    :rfd-cfn-trxn-ltd-amt,
00002584    :rfd-cfn-load-ltd-amt,
00002585    :rfd-cfn-int-ltd-amt,
00002586    :rfd-cfn-pend-ltd-amt,
00002587    :rfd-cfn-intg-iunit-qty,
00002588    :rfd-cfn-dcml-iunit-qty,
00002589    :rfd-cfn-intg-aunit-qty,
00002590    :rfd-cfn-dcml-aunit-qty,
00002591    :rfd-fia-gla-cd,
00002592    :rfd-fia-fnd-gla-amt,
00002593    :rfd-fia-gnrl-gla-amt,
00002594    :rfd-fia-revrs-gla-cd,
00002595    :rfd-revrs-fnd-gla-amt,
00002596    :rfd-revrs-gnrl-gla-amt,
00002597    :rfd-fia-valn-eff-dt :zfd-fia-valn-eff-dt-ni,
00002598    :rfd-pend-dpos-tmg-amt,
00002599    :rfd-wthdr-typ-cd,
00002600    :rfd-cfn-csv-ltd-amt
00002601    ,:rfd-payo-v1-csv-amt
00002602    ,:rfd-payo-v2-csv-amt
00002603    ,:rfd-fndvl-eff-dt
00002604    ,:rfd-div-src-fnd-id
00002605    ,:rfd-fnd-xpns-tax-rt
00002606    ,:rfd-rbt-amt
00002607    ,:rfd-alloc-pct
00002608    ,:rfd-sell-ntcd-amt
00002610    ,:rfd-fnd-ref-amt
00002611    ,:rfd-fnd-manag-obj-id
00002613    ,:rfd-insur-intg-mdt-fee-qty
00002614    ,:rfd-insur-dcml-mdt-fee-qty
00002615    ,:rfd-insur-mdt-fee-amt
00002616    ,:rfd-insur-mdt-fee-pct
00002617    ,:rfd-retail-intg-mdt-fee-qty
00002618    ,:rfd-retail-dcml-mdt-fee-qty
00002619    ,:rfd-retail-mdt-fee-amt
00002620    ,:rfd-retail-mdt-fee-pct
00002621    ,:rfd-trust-intg-mdt-fee-qty
00002622    ,:rfd-trust-dcml-mdt-fee-qty
00002623    ,:rfd-trust-mdt-fee-amt
00002624    ,:rfd-trust-mdt-fee-pct
00002625    ,:rfd-mvt-wgt-in-out-amt
00002626    ,:rfd-surr-valu-gar-amt
00002627    ,:rfd-trg-uct-qty
00002628    ,:rfd-mdu-pab-amt
00002629    ,:rfd-div-intg-defer-qty
00002630    ,:rfd-div-dcml-defer-qty
00002631    ,:rfd-pmts-wthdr-defer-dt
00002632    end-exec
00002553    move low-values to zfd-null-indicators
00002635    evaluate sqlcode
00002637    when zero
00002638    set wfd-io-ok to true
00002639    perform fd-2000-set-null-dflt thru fd-2000-set-null-dflt-x
00002641    move rfd-key to wfd-key
00002643    when +100
00002644    set wfd-io-eof to true
00002646    when other
00002647    set wfd-io-error to true
00002649    end-evaluate
00002650    end-if
00002652    move rfd-key to rfd-viid437-read-key
00002653    continue.
00002655310g-fetch-next-x.
00002656    exit.
000026604000-exec-close-cur.
00002663    evaluate ws-optm-sql-exec
00002665    when '02'
00002666    perform 4102-close-browse-cur thru 4102-close-browse-cur-x
00002669    when '03'
00002670    perform 4103-close-browse-cur thru 4103-close-browse-cur-x
00002673    when '04'
00002674    perform 4104-close-browse-cur thru 4104-close-browse-cur-x
00002677    when '05'
00002678    perform 410g-close-browse-cur thru 410g-close-browse-cur-x
00002681    when other
00002682    perform 410g-close-browse-cur thru 410g-close-browse-cur-x
00002685    end-evaluate.
00002688    set ws-optm-sql-cur-closed to true.
000026914000-exec-close-cur-x.
00002692    exit.
00002698    exec sql
00002699    close fdb2cur
00002700    end-exec.
000026954102-close-browse-cur.
00002703    evaluate sqlcode
00002705    when zero
00002706    set wfd-io-ok to true
00002708    when other
00002709    set wfd-io-error to true
00002711    end-evaluate.
000027144102-close-browse-cur-x.
00002715    exit.
00002722    exec sql
00002723    close fdb3cur
00002724    end-exec.
000027194103-close-browse-cur.
00002727    evaluate sqlcode
00002729    when zero
00002730    set wfd-io-ok to true
00002732    when other
00002733    set wfd-io-error to true
00002735    end-evaluate.
000027384103-close-browse-cur-x.
00002739    exit.
00002746    exec sql
00002747    close fdb4cur
00002748    end-exec.
000027434104-close-browse-cur.
00002751    evaluate sqlcode
00002753    when zero
00002754    set wfd-io-ok to true
00002756    when other
00002757    set wfd-io-error to true
00002759    end-evaluate.
000027624104-close-browse-cur-x.
00002763    exit.
00002770    exec sql
00002771    close fdbcur
00002772    end-exec.
00002767410g-close-browse-cur.
00002775    evaluate sqlcode
00002777    when zero
00002778    set wfd-io-ok to true
00002780    when other
00002781    set wfd-io-error to true
00002783    end-evaluate.
00002786410g-close-browse-cur-x.
00002787    exit.
00002794    exec sql
00002795    select count (*)
00002796    into :wfd-count
00002797    from vita078
00002798    where
00002799    co_id = :wfd-co-id
00002800    and
00002801    pol_id between
00002802    :wfd-pol-id and
00002803    :wfd-endbr-pol-id
00002804    and
00002805    ((cvg_num = :wfd-cvg-num and
00002806    ((fnd_id = :wfd-fnd-id and
00002807    ((fia_eff_dt = :wfd-fia-eff-dt and
00002808    fia_tmsp >= :wfd-fia-tmsp) or
00002809    fia_eff_dt > :wfd-fia-eff-dt)) or
00002810    fnd_id > :wfd-fnd-id)) or
00002811    cvg_num > :wfd-cvg-num or
00002812    pol_id > :wfd-pol-id)
00002813    and
00002814    ((cvg_num = :wfd-endbr-cvg-num and
00002815    ((fnd_id = :wfd-endbr-fnd-id and
00002816    ((fia_eff_dt = :wfd-endbr-fia-eff-dt and
00002817    fia_tmsp <= :wfd-endbr-fia-tmsp) or
00002818    fia_eff_dt < :wfd-endbr-fia-eff-dt)) or
00002819    fnd_id < :wfd-endbr-fnd-id)) or
00002820    cvg_num < :wfd-endbr-cvg-num or
00002821    pol_id < :wfd-endbr-pol-id)
00002822    end-exec.
000027915000-exec-count.
00002825    evaluate sqlcode
00002827    when zero
00002828    set wfd-io-ok to true
00002830    when other
00002831    set wfd-io-error to true
00002833    end-evaluate.
000028365000-exec-count-x.
00002837    exit.
00002852fd-1000-set-null-ind.
00002855    move low-values to zfd-null-indicators.
00002857    if rfd-nxt-fia-fnd-id = spaces
00002858    move -1 to zfd-nxt-fia-fnd-id-ni.
00002860    if rfd-fia-valn-eff-dt = wwkdt-zero-dt
00002861    move -1 to zfd-fia-valn-eff-dt-ni.
00002863fd-1000-set-null-ind-x.
00002864    exit.
00002868fd-2000-set-null-dflt.
00002871    if zfd-nxt-fia-fnd-id-null
00002872    move spaces to rfd-nxt-fia-fnd-id.
00002874    if zfd-fia-valn-eff-dt-null
00002875    move wwkdt-zero-dt to rfd-fia-valn-eff-dt.
00002877fd-2000-set-null-dflt-x.
00002878    exit.
00002916gpol-part-valu-calc.
00002919    move wgpol-pol-id(9:3) to wgpol-id-ing
00002920    move wgpol-pol-id(7:3) to wgpol-id-aiav2
00002921    move wgpol-pol-id(6:3) to wgpol-id-aiav3
00002923    if wgpol-id-ing numeric
00002925    move wgpol-id-ing to wgpol-part-valu
00002927    else
00002928    if wgpol-id-aiav2 numeric
00002930    move wgpol-id-aiav2 to wgpol-part-valu
00002932    else
00002933    if wgpol-id-aiav3 numeric
00002935    move wgpol-id-aiav3 to wgpol-part-valu
00002937    else
00002939    move wgpol-part-no-001 to wgpol-part-valu
00002940    end-if
00002941    end-if
00002942    end-if
00002943    continue.
00002945gpol-part-valu-calc-x.
00002947    exit.
00002960gpol-get-rum-pol-id.
00002964    inspect wgpol-pol-id tallying wgpol-spc-length for all spaces
00002968    evaluate wgpol-spc-length
00002970    when wgpol-spc-zero
00002971    move wgpol-pol-id to wgpol-rum-pol-id-o
00002973    when wgpol-spc-one
00002974    move wgpol-pol-id to wgpol-rum-pol-id-10x
00002975    move zeros to wgpol-rum-pol-id-10z
00002976    move wgpol-rum-pol-id-10 to wgpol-rum-pol-id-o
00002978    when wgpol-spc-two
00002979    move wgpol-pol-id to wgpol-rum-pol-id-9x
00002980    move zeros to wgpol-rum-pol-id-9z
00002981    move wgpol-rum-pol-id-9 to wgpol-rum-pol-id-o
00002983    when wgpol-spc-three
00002984    move wgpol-pol-id to wgpol-rum-pol-id-8x
00002985    move zeros to wgpol-rum-pol-id-8z
00002986    move wgpol-rum-pol-id-8 to wgpol-rum-pol-id-o
00002988    end-evaluate
00002989    continue.
00002991gpol-get-rum-pol-id-x.
00002993    exit.