00000328procedure division using sqlca wcoef-io-work-area rcoef-rec-info.
000003330000-mainline.
00000336    if ws-wa-address not = address of wcoef-io-work-area or ws-tl-address not = address of rcoef-rec-info
00000338    set ws-wa-address to address of wcoef-io-work-area
00000339    set ws-tl-address to address of rcoef-rec-info
00000340    move zero to sql-init-flag
00000341    end-if.
00000344    evaluate true
00000346    when wcoef-rqst-insert
00000347    perform 1000-insert thru 1000-insert-x
00000350    when other
00000351    set wcoef-io-error to true
00000353    end-evaluate.
00000356    set wcoef-optm-sql-ok to true.
00000357    move spaces to wcoef-optm-sql-reqir.
00000358    move spaces to wcoef-optm-sql-exec.
00000361    goback.
000003640000-mainline-x.
00000365    exit.
000003691000-insert.
00000372    perform coef-1000-set-null-ind thru coef-1000-set-null-ind-x.
00000377    exec sql
00000378    insert into vita041
00000379    (co_id,
00000380    coef_typ_cd,
00000381    coef_plan_id,
00000382    coef_table_cd,
00000383    coef_valu_id,
00000384    coef_idt_num,
00000385    coef_eff_dt,
00000386    coef_fct)
00000387    values
00000388    (:rcoef-co-id,
00000389    :rcoef-coef-typ-cd,
00000390    :rcoef-coef-plan-id,
00000391    :rcoef-coef-table-cd,
00000392    :rcoef-coef-valu-id,
00000393    :rcoef-coef-idt-num,
00000394    :rcoef-coef-eff-dt :zcoef-coef-eff-dt-ni,
00000395    :rcoef-coef-fct)
00000396    end-exec.
00000375    move wcoef-key to rcoef-key.
00000399    evaluate sqlcode
00000401    when zero
00000402    set wcoef-io-ok to true
00000404    when other
00000405    set wcoef-io-error to true
00000407    end-evaluate.
000004101000-insert-x.
00000411    exit.
00000427coef-1000-set-null-ind.
00000430    move low-values to zcoef-null-indicators.
00000432    if rcoef-coef-eff-dt = wwkdt-zero-dt
00000433    move -1 to zcoef-coef-eff-dt-ni.
00000435coef-1000-set-null-ind-x.
00000436    exit.
00000440coef-2000-set-null-dflt.
00000443    if zcoef-coef-eff-dt-null
00000444    move wwkdt-zero-dt to rcoef-coef-eff-dt.
00000446coef-2000-set-null-dflt-x.
00000447    exit.