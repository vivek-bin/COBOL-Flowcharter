
start:index error
0    0000-mainline.
1        set address of wgptr-info-area to wglob-gptr-info-address
2        perform 0n99-0000-mainline thru 0n99-0000-mainline-x
start:2      2          perform 0n99-0000-mainline thru 0n99-0000-mainline-x
6    0n99-0000-mainline.
7        initialize l0n99-output-parm-info
8        initialize w0n99-work-area-input
9        initialize frequently-used-indices
10        set l0n99-retrn-ok to true
11        evaluate true
start:3      12          when l0n99-rqst-process-opt-fin
13        perform 0n99-1000-manag-opt-fin thru 0n99-1000-manag-opt-fin-x
start:4      13          perform 0n99-1000-manag-opt-fin thru 0n99-1000-manag-opt-fin-x
22    0n99-1000-manag-opt-fin.
23        if l0n99-abn-fnd-id not = spaces and l0n99-abn-fnd-id not = low-values
start:5      23          if l0n99-abn-fnd-id not = spaces and l0n99-abn-fnd-id not = low-values
24        perform 0n99-1050-chck-fr thru 0n99-1050-chck-fr-x
start:6      24          perform 0n99-1050-chck-fr thru 0n99-1050-chck-fr-x
112    0n99-1050-chck-fr.
113        if rpol-cd-opt-ofp-act not = spaces and rpol-cd-opt-ofp-act not = low-values
start:7      113          if rpol-cd-opt-ofp-act not = spaces and rpol-cd-opt-ofp-act not = low-values
114        move rpol-cd-opt-ofp-act to wfr-plan-id
115        move l0n99-abn-fnd-id to wfr-fnd-id
116        perform fr-1000-read thru fr-1000-read-x
start:8      116          perform fr-1000-read thru fr-1000-read-x
2865    fr-1000-read.
2866        if wfr-company-required
start:9      2866          if wfr-company-required
2867        move wglob-company-code to wfr-co-id
2868        else
end:8      2868          else
start:9      2868          else
2869        move spaces to wfr-co-id
2870        end-if.
end:8      2870          end-if.
2871        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2872        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2873        if wglob-fr-tbl-loaded-whole
start:9      2873          if wglob-fr-tbl-loaded-whole
2874        move 'viid0b33' to wpgws-call-pgm-id
2875        else
end:8      2875          else
start:9      2875          else
2876        move 'viid450' to wpgws-call-pgm-id
2877        end-if
end:8      2877          end-if
2878        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2879        set wfr-tbl-address to wglob-fr-tbl-address
2880        move wglob-fr-stack-ptr to wfr-stack-ptr
2881        set wfr-rqst-select to true.
2882        call wpgws-call-pgm-id using sqlca wfr-io-work-area rfr-rec-info.
2883        if wfr-io-error
start:9      2883          if wfr-io-error
2884        move wfr-table-name to l0030-table-name
2885        move wfr-rqst-cd to l0030-io-command
2886        move wfr-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2887        move wfr-optm-sql-reqir to l0030-optm-sql-reqir
2888        move wfr-optm-sql-exec to l0030-optm-sql-exec
2889        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:10      2889          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:11      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:10      3336          else
start:11      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:10      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:11      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:10      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2889        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:9      2889          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2890        end-if.
end:8      2890          end-if.
2891        move wfr-stack-ptr to wglob-fr-stack-ptr
2892        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2893        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2894    fr-1000-read-x.
2895        exit.
116        perform fr-1000-read thru fr-1000-read-x
end:7      116          perform fr-1000-read thru fr-1000-read-x
117        if wfr-io-eof or wfr-io-not-found
start:8      117          if wfr-io-eof or wfr-io-not-found
118        move rpol-plan-id to wfr-plan-id
119        move l0n99-abn-fnd-id to wfr-fnd-id
120        perform fr-1000-read thru fr-1000-read-x
start:9      120          perform fr-1000-read thru fr-1000-read-x
2865    fr-1000-read.
2866        if wfr-company-required
start:10      2866          if wfr-company-required
2867        move wglob-company-code to wfr-co-id
2868        else
end:9      2868          else
start:10      2868          else
2869        move spaces to wfr-co-id
2870        end-if.
end:9      2870          end-if.
2871        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2872        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2873        if wglob-fr-tbl-loaded-whole
start:10      2873          if wglob-fr-tbl-loaded-whole
2874        move 'viid0b33' to wpgws-call-pgm-id
2875        else
end:9      2875          else
start:10      2875          else
2876        move 'viid450' to wpgws-call-pgm-id
2877        end-if
end:9      2877          end-if
2878        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2879        set wfr-tbl-address to wglob-fr-tbl-address
2880        move wglob-fr-stack-ptr to wfr-stack-ptr
2881        set wfr-rqst-select to true.
2882        call wpgws-call-pgm-id using sqlca wfr-io-work-area rfr-rec-info.
2883        if wfr-io-error
start:10      2883          if wfr-io-error
2884        move wfr-table-name to l0030-table-name
2885        move wfr-rqst-cd to l0030-io-command
2886        move wfr-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2887        move wfr-optm-sql-reqir to l0030-optm-sql-reqir
2888        move wfr-optm-sql-exec to l0030-optm-sql-exec
2889        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:11      2889          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:12      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:11      3336          else
start:12      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:11      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:12      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:11      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2889        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:10      2889          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2890        end-if.
end:9      2890          end-if.
2891        move wfr-stack-ptr to wglob-fr-stack-ptr
2892        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2893        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2894    fr-1000-read-x.
2895        exit.
120        perform fr-1000-read thru fr-1000-read-x
end:8      120          perform fr-1000-read thru fr-1000-read-x
121        end-if
end:7      121          end-if
122        else
end:6      122          else
start:7      122          else
123        move rpol-plan-id to wfr-plan-id
124        move l0n99-abn-fnd-id to wfr-fnd-id
125        perform fr-1000-read thru fr-1000-read-x
start:8      125          perform fr-1000-read thru fr-1000-read-x
2865    fr-1000-read.
2866        if wfr-company-required
start:9      2866          if wfr-company-required
2867        move wglob-company-code to wfr-co-id
2868        else
end:8      2868          else
start:9      2868          else
2869        move spaces to wfr-co-id
2870        end-if.
end:8      2870          end-if.
2871        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2872        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2873        if wglob-fr-tbl-loaded-whole
start:9      2873          if wglob-fr-tbl-loaded-whole
2874        move 'viid0b33' to wpgws-call-pgm-id
2875        else
end:8      2875          else
start:9      2875          else
2876        move 'viid450' to wpgws-call-pgm-id
2877        end-if
end:8      2877          end-if
2878        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2879        set wfr-tbl-address to wglob-fr-tbl-address
2880        move wglob-fr-stack-ptr to wfr-stack-ptr
2881        set wfr-rqst-select to true.
2882        call wpgws-call-pgm-id using sqlca wfr-io-work-area rfr-rec-info.
2883        if wfr-io-error
start:9      2883          if wfr-io-error
2884        move wfr-table-name to l0030-table-name
2885        move wfr-rqst-cd to l0030-io-command
2886        move wfr-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2887        move wfr-optm-sql-reqir to l0030-optm-sql-reqir
2888        move wfr-optm-sql-exec to l0030-optm-sql-exec
2889        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:10      2889          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:11      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:10      3336          else
start:11      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:10      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:11      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:10      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2889        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:9      2889          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2890        end-if.
end:8      2890          end-if.
2891        move wfr-stack-ptr to wglob-fr-stack-ptr
2892        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2893        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2894    fr-1000-read-x.
2895        exit.
125        perform fr-1000-read thru fr-1000-read-x
end:7      125          perform fr-1000-read thru fr-1000-read-x
126        end-if
end:6      126          end-if
127        if not wfr-io-ok
start:7      127          if not wfr-io-ok
128        set l0n99-retrn-error to true
129        move 'sc0n990023' to wglob-msg-ref-info
130        move wfr-key to wglob-msg-parm(1)
131        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:8      131          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:9      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:8      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
131        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:7      131          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
132        go to 0n99-1050-chck-fr-x
end:6      132          go to 0n99-1050-chck-fr-x
start:7      132          go to 0n99-1050-chck-fr-x
133        end-if
end:6      133          end-if
134        continue.
135    0n99-1050-chck-fr-x.
136        exit.
24        perform 0n99-1050-chck-fr thru 0n99-1050-chck-fr-x
end:5      24          perform 0n99-1050-chck-fr thru 0n99-1050-chck-fr-x
25        if l0n99-retrn-error
start:6      25          if l0n99-retrn-error
26        go to 0n99-1000-manag-opt-fin-x
end:5      26          go to 0n99-1000-manag-opt-fin-x
start:6      26          go to 0n99-1000-manag-opt-fin-x
27        end-if
end:5      27          end-if
28        else
end:4      28          else
start:5      28          else
29        set l0n99-retrn-error to true
30        move 'sc0n990022' to wglob-msg-ref-info
31        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:6      31          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:7      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:6      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
31        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:5      31          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
32        go to 0n99-1000-manag-opt-fin-x
end:4      32          go to 0n99-1000-manag-opt-fin-x
start:5      32          go to 0n99-1000-manag-opt-fin-x
33        end-if
end:4      33          end-if
34        set w0n99-optqui-process-no to true
35        if l0n99-abe-cv-amt > zeroes
start:5      35          if l0n99-abe-cv-amt > zeroes
36        set w0n99-prcs-gevt-y to true
37        else
end:4      37          else
start:5      37          else
38        set w0n99-prcs-gevt-n to true
39        end-if
end:4      39          end-if
40        perform 0o32-1000-build-parm-info thru 0o32-1000-build-parm-info-x
start:5      40          perform 0o32-1000-build-parm-info thru 0o32-1000-build-parm-info-x
2053    0o32-1000-build-parm-info.
2054        initialize l0o32-input-parm-info
2055        initialize l0o32-io-parm-info
2056        continue.
2057    0o32-1000-build-parm-info-x.
2058        exit.
40        perform 0o32-1000-build-parm-info thru 0o32-1000-build-parm-info-x
end:4      40          perform 0o32-1000-build-parm-info thru 0o32-1000-build-parm-info-x
41        set l0o32-chk-admsblty-init to true
42        set l0o32-elt-typ-act to true
43        move rpol-plan-id to l0o32-plan-id
44        move rpol-cd-opt-ofp-act to l0o32-cd-opt-ofp-act
45        move w0n99-transaction-arbi to l0o32-int-rh-id-1-i
46        move l0n99-transf-typ-cd to l0o32-int-1st-cd-i
47        move l0n99-ope-eff-dt to l0o32-dmd-pol-fcn-dt-i
48        move l0n99-abe-fnd-id to l0o32-fnd-id-i(w0n99-one)
49        set l0o32-ope-dir-input-i(w0n99-one) to true
50        perform 0o32-1000-chk-admsblty-init thru 0o32-1000-chk-admsblty-init-x
start:5      50          perform 0o32-1000-chk-admsblty-init thru 0o32-1000-chk-admsblty-init-x
2070    0o32-1000-chk-admsblty-init.
2071        set l0o32-chk-admsblty-init to true
2072        perform 0o32-0000-call thru 0o32-0000-call-x
start:6      2072          perform 0o32-0000-call thru 0o32-0000-call-x
2059    0o32-0000-call.
2060        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2061        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2062        move 'vib3o32' to wpgws-call-pgm-id
2063        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2064        call wpgws-call-pgm-id using wglob-global-area l0o32-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2065        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2066        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2067        continue.
2068    0o32-0000-call-x.
2069        exit.
2072        perform 0o32-0000-call thru 0o32-0000-call-x
end:5      2072          perform 0o32-0000-call thru 0o32-0000-call-x
2073        continue.
2074    0o32-1000-chk-admsblty-init-x.
2075        exit.
50        perform 0o32-1000-chk-admsblty-init thru 0o32-1000-chk-admsblty-init-x
end:4      50          perform 0o32-1000-chk-admsblty-init thru 0o32-1000-chk-admsblty-init-x
51        if l0o32-retrn-error
start:5      51          if l0o32-retrn-error
52        set l0n99-retrn-error to true
53        go to 0n99-1000-manag-opt-fin-x
end:4      53          go to 0n99-1000-manag-opt-fin-x
start:5      53          go to 0n99-1000-manag-opt-fin-x
54        end-if
end:4      54          end-if
55        move l0o32-int-1st-cd-o(w0n99-one) to w0n99-transfer-type
56        if l0o32-retrn-ok and l0o32-int-rh-id-1-o(w0n99-one) = w0n99-transaction-arbi and (w0n99-trans-liq or w0n99-trans-mer)
start:5      56          if l0o32-retrn-ok and l0o32-int-rh-id-1-o(w0n99-one) = w0n99-transaction-arbi and (w0n99-trans-liq or w0n99-trans-mer)
57        perform with test before varying yy from 1 by 1 until yy > w0n99-twenty or (l0o32-int-rh-id-2(w0n99-one,yy) ) = spaces or low-values or (not l0o32-cpb-csq-use(w0n99-one,yy) )
start:6      57          perform with test before varying yy from 1 by 1 until yy > w0n99-twenty or (l0o32-int-rh-id-2(w0n99-one,yy) ) = spaces or low-values or (not l0o32-cpb-csq-use(w0n99-one,yy) )
58        set w0n99-abe-fnd-dbt-n to true
59        set w0n99-abe-fnd-rcp-n to true
60        set w0n99-abe-fnd-tgt-n to true
61        set w0n99-abn-fnd-dbt-n to true
62        set w0n99-abn-fnd-rcp-n to true
63        set w0n99-abn-fnd-tgt-n to true
64        set w0n99-mltpl-dbt-fnd-n to true
65        set w0n99-mltpl-rcp-fnd-n to true
66        set w0n99-mltpl-tgt-fnd-n to true
67        set w0n99-ref-amt-updt-n to true
68        set w0n99-flag-mod-n to true
69        move l0o32-cpb-csq-cd(w0n99-one,yy) to w0n99-cpb-csq-cd
70        move l0o32-fnd-cpb-ind(w0n99-one,yy) to w0n99-fnd-cpb-ind
71        move l0o32-int-rh-id-2(w0n99-one,yy) to w0n99-opt-rh-id
72        perform 0n99-1320-update-fc-fs thru 0n99-1320-update-fc-fs-x
start:7      72          perform 0n99-1320-update-fc-fs thru 0n99-1320-update-fc-fs-x
616    0n99-1320-update-fc-fs.
617        set w0n99-fnd-found-n to true
618        perform varying xx from 1 by 1 until xx > lsegf-fnd-ctr
start:8      618          perform varying xx from 1 by 1 until xx > lsegf-fnd-ctr
619        if lsegf-cfn-fnd-id(xx) = l0n99-abn-fnd-id
start:9      619          if lsegf-cfn-fnd-id(xx) = l0n99-abn-fnd-id
620        set w0n99-fnd-found-y to true
621        end-if
end:8      621          end-if
622        end-perform
end:7      622          end-perform
623        if w0n99-fnd-found-n
start:8      623          if w0n99-fnd-found-n
624        perform 0n99-1330-create-fs thru 0n99-1330-create-fs-x
start:9      624          perform 0n99-1330-create-fs thru 0n99-1330-create-fs-x
629    0n99-1330-create-fs.
630        move lsegf-inv-cvg-rec-info to rfc-rec-info
631        perform fs-1000-create thru fs-1000-create-x
start:10      631          perform fs-1000-create thru fs-1000-create-x
2796    fs-1000-create.
2797        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2798        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2799        move 'viid456' to wpgws-call-pgm-id.
2800        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2801        set wfs-rqst-init-tbl-layout to true.
2802        call wpgws-call-pgm-id using wfs-io-work-area rfs-rec-info.
2803        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2804        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2805    fs-1000-create-x.
2806        exit.
631        perform fs-1000-create thru fs-1000-create-x
end:9      631          perform fs-1000-create thru fs-1000-create-x
632        move rfc-co-id to rfs-co-id
633        move rfc-pol-id to rfs-pol-id
634        move rfc-cvg-num to rfs-cvg-num
635        move l0n99-abn-fnd-id to rfs-fnd-id
636        set rfs-cfn-stat-one-actv to true
637        move lsegf-input-eff-dt to rfs-cfn-stat-chng-dt
638        move wwkdt-zero-dt to rfs-fnd-clos-dt
639        perform 0n99-1340-read-fh thru 0n99-1340-read-fh
start:10      639          perform 0n99-1340-read-fh thru 0n99-1340-read-fh
667    0n99-1340-read-fh.
668        move l0n99-abn-fnd-id to wfh-fnd-id
669        perform fh-1000-read thru fh-1000-read-x
start:11      669          perform fh-1000-read thru fh-1000-read-x
2896    fh-1000-read.
2897        if wfh-company-required
start:12      2897          if wfh-company-required
2898        move wglob-company-code to wfh-co-id
2899        else
end:11      2899          else
start:12      2899          else
2900        move spaces to wfh-co-id
2901        end-if.
end:11      2901          end-if.
2902        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2903        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2904        if wglob-fh-tbl-loaded-whole
start:12      2904          if wglob-fh-tbl-loaded-whole
2905        move 'viid0b32' to wpgws-call-pgm-id
2906        else
end:11      2906          else
start:12      2906          else
2907        move 'viid447' to wpgws-call-pgm-id
2908        end-if
end:11      2908          end-if
2909        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2910        set wfh-tbl-address to wglob-fh-tbl-address
2911        move wglob-fh-stack-ptr to wfh-stack-ptr
2912        set wfh-rqst-select to true.
2913        call wpgws-call-pgm-id using sqlca wfh-io-work-area rfh-rec-info.
2914        if wfh-io-error
start:12      2914          if wfh-io-error
2915        move wfh-table-name to l0030-table-name
2916        move wfh-rqst-cd to l0030-io-command
2917        move wfh-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2918        move wfh-optm-sql-reqir to l0030-optm-sql-reqir
2919        move wfh-optm-sql-exec to l0030-optm-sql-exec
2920        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:13      2920          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:14      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:13      3336          else
start:14      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:13      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:14      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:13      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2920        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:12      2920          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2921        end-if.
end:11      2921          end-if.
2922        move wfh-stack-ptr to wglob-fh-stack-ptr
2923        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2924        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2925    fh-1000-read-x.
2926        exit.
669        perform fh-1000-read thru fh-1000-read-x
end:10      669          perform fh-1000-read thru fh-1000-read-x
670        if not wfh-io-ok
start:11      670          if not wfh-io-ok
671        set l0n99-retrn-error to true
672        move 'sc0n990020' to wglob-msg-ref-info
673        move wfh-key to wglob-msg-parm(1)
674        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:12      674          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:13      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:12      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
674        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:11      674          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
675        go to 0n99-1340-read-fh-x
start:12      675          go to 0n99-1340-read-fh-x
679    0n99-1340-read-fh-x.
680        exit.
681    0n99-1320-calc-next-date.
682        move rpol-plan-id to wph-plan-id
683        perform ph-1000-read thru ph-1000-read
start:13      683          perform ph-1000-read thru ph-1000-read
2927    ph-1000-read.
2928        if wph-company-required
start:14      2928          if wph-company-required
2929        move wglob-company-code to wph-co-id
2930        else
end:13      2930          else
start:14      2930          else
2931        move spaces to wph-co-id
2932        end-if.
end:13      2932          end-if.
2933        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2934        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2935        if wglob-ph-tbl-loaded-whole
start:14      2935          if wglob-ph-tbl-loaded-whole
2936        move 'viidc39' to wpgws-call-pgm-id
2937        else
end:13      2937          else
start:14      2937          else
2938        if wglob-ph-tbl-loaded-partl
start:15      2938          if wglob-ph-tbl-loaded-partl
2939        move 'viidc40' to wpgws-call-pgm-id
2940        else
end:14      2940          else
start:15      2940          else
2941        move 'viid710' to wpgws-call-pgm-id
2942        end-if
end:14      2942          end-if
2943        end-if.
end:13      2943          end-if.
2944        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2945        set wph-tbl-address to wglob-ph-tbl-address.
2946        move wglob-ph-stack-ptr to wph-stack-ptr.
2947        set wph-rqst-select to true.
2948        call wpgws-call-pgm-id using sqlca wph-io-work-area rph-rec-info.
2949        if wph-io-error
start:14      2949          if wph-io-error
2950        move wph-table-name to l0030-table-name
2951        move wph-rqst-cd to l0030-io-command
2952        move wph-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2953        move wph-optm-sql-reqir to l0030-optm-sql-reqir
2954        move wph-optm-sql-exec to l0030-optm-sql-exec
2955        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:15      2955          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:16      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:15      3336          else
start:16      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:15      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:16      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:15      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2955        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:14      2955          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2956        end-if.
end:13      2956          end-if.
2957        move wph-stack-ptr to wglob-ph-stack-ptr.
2958        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2959        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
683        perform ph-1000-read thru ph-1000-read
end:12      683          perform ph-1000-read thru ph-1000-read
684        if wph-io-not-found
start:13      684          if wph-io-not-found
685        set l0n99-retrn-error to true
686        move 'sc0n990011' to wglob-msg-ref-info
687        move wph-plan-id to wglob-msg-parm(1)
688        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:14      688          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:15      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:14      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
688        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:13      688          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
689        go to 0n99-1320-calc-next-date-x
start:14      689          go to 0n99-1320-calc-next-date-x
701    0n99-1320-calc-next-date-x.
702        exit.
703    0n99-1400-read-opt-fin.
704        perform 0o33-1000-build-parm-info thru 0o33-1000-build-parm-info-x
start:15      704          perform 0o33-1000-build-parm-info thru 0o33-1000-build-parm-info-x
2088    0o33-1000-build-parm-info.
2089        initialize l0o33-input-parm-info
2090        initialize l0o33-io-parm-info
2091        continue.
2092    0o33-1000-build-parm-info-x.
2093        exit.
704        perform 0o33-1000-build-parm-info thru 0o33-1000-build-parm-info-x
end:14      704          perform 0o33-1000-build-parm-info thru 0o33-1000-build-parm-info-x
705        set l0o33-read-fopt-pol to true
706        move l0n99-abe-fnd-id to l0o33-fnd-id-io
707        move w0n99-opt-rh-id to l0o33-opt-rh-id(w0n99-one)
708        move l0n99-ope-eff-dt to l0o33-val-ref-appl-strt-dt
709        move zeroes to l0o33-opt-chain-num(w0n99-one)
710        perform 0o33-1000-read-fopt-pol thru 0o33-1000-read-fopt-pol-x
start:15      710          perform 0o33-1000-read-fopt-pol thru 0o33-1000-read-fopt-pol-x
2105    0o33-1000-read-fopt-pol.
2106        set l0o33-read-fopt-pol to true
2107        perform 0o33-0000-call thru 0o33-0000-call-x
start:16      2107          perform 0o33-0000-call thru 0o33-0000-call-x
2094    0o33-0000-call.
2095        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2096        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2097        move 'vib3o33' to wpgws-call-pgm-id
2098        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2099        call wpgws-call-pgm-id using wglob-global-area l0o33-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2100        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2101        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2102        continue.
2103    0o33-0000-call-x.
2104        exit.
2107        perform 0o33-0000-call thru 0o33-0000-call-x
end:15      2107          perform 0o33-0000-call thru 0o33-0000-call-x
2108        continue.
2109    0o33-1000-read-fopt-pol-x.
2110        exit.
710        perform 0o33-1000-read-fopt-pol thru 0o33-1000-read-fopt-pol-x
end:14      710          perform 0o33-1000-read-fopt-pol thru 0o33-1000-read-fopt-pol-x
711        if l0o33-retrn-error
start:15      711          if l0o33-retrn-error
712        set l0n99-retrn-error to true
713        end-if
end:14      713          end-if
714        if l0o33-retrn-ok
start:15      714          if l0o33-retrn-ok
715        if l0o33-opt-stat-acti(w0n99-one) or l0o33-opt-stat-atten(w0n99-one)
start:16      715          if l0o33-opt-stat-acti(w0n99-one) or l0o33-opt-stat-atten(w0n99-one)
716        perform 0n99-1410-chck-occ-first thru 0n99-1410-chck-occ-first-x
start:17      716          perform 0n99-1410-chck-occ-first thru 0n99-1410-chck-occ-first-x
723    0n99-1410-chck-occ-first.
724        perform varying xx from 1 by 1 until xx > wglob-max-fnd-plan-qty or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-values
start:18      724          perform varying xx from 1 by 1 until xx > wglob-max-fnd-plan-qty or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-values
725        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:19      725          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
726        perform 0n99-1411-chck-sup-first thru 0n99-1411-chck-sup-first-x
start:20      726          perform 0n99-1411-chck-sup-first thru 0n99-1411-chck-sup-first-x
732    0n99-1411-chck-sup-first.
733        if l0o33-ope-dir-entree(w0n99-one,w0n99-one)
start:21      733          if l0o33-ope-dir-entree(w0n99-one,w0n99-one)
734        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
start:22      734          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
735        set w0n99-abe-fnd-rcp-y to true
736        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-ope-dir-cd
737        else
end:21      737          else
start:22      737          else
738        set w0n99-mltpl-rcp-fnd-y to true
739        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:23      739          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
740        set w0n99-abn-fnd-rcp-y to true
741        end-if
end:22      741          end-if
742        end-if
end:21      742          end-if
743        end-if
end:20      743          end-if
744        if l0o33-ope-dir-cible(w0n99-one,w0n99-one)
start:21      744          if l0o33-ope-dir-cible(w0n99-one,w0n99-one)
745        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
start:22      745          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
746        set w0n99-abe-fnd-tgt-y to true
747        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-ope-dir-cd
748        else
end:21      748          else
start:22      748          else
749        set w0n99-mltpl-tgt-fnd-y to true
750        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:23      750          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
751        set w0n99-abn-fnd-tgt-y to true
752        end-if
end:22      752          end-if
753        end-if
end:21      753          end-if
754        end-if
end:20      754          end-if
755        continue.
756    0n99-1411-chck-sup-first-x.
757        exit.
726        perform 0n99-1411-chck-sup-first thru 0n99-1411-chck-sup-first-x
end:19      726          perform 0n99-1411-chck-sup-first thru 0n99-1411-chck-sup-first-x
727        end-if
end:18      727          end-if
728        end-perform
end:17      728          end-perform
729        continue.
730    0n99-1410-chck-occ-first-x.
731        exit.
716        perform 0n99-1410-chck-occ-first thru 0n99-1410-chck-occ-first-x
end:16      716          perform 0n99-1410-chck-occ-first thru 0n99-1410-chck-occ-first-x
717        perform 0n99-1420-chck-occ-second thru 0n99-1420-chck-occ-second-x
start:17      717          perform 0n99-1420-chck-occ-second thru 0n99-1420-chck-occ-second-x
758    0n99-1420-chck-occ-second.
759        perform varying xx from 1 by 1 until xx > wglob-max-fnd-plan-qty or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces
start:18      759          perform varying xx from 1 by 1 until xx > wglob-max-fnd-plan-qty or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces
760        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:19      760          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
761        perform 0n99-1421-chck-sup-second thru 0n99-1421-chck-sup-second-x
start:20      761          perform 0n99-1421-chck-sup-second thru 0n99-1421-chck-sup-second-x
767    0n99-1421-chck-sup-second.
768        if l0o33-ope-dir-sorte(w0n99-one,w0n99-two)
start:21      768          if l0o33-ope-dir-sorte(w0n99-one,w0n99-two)
769        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id
start:22      769          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id
770        set w0n99-abe-fnd-dbt-y to true
771        move l0o33-opt-num(w0n99-one,w0n99-two,xx) to w0n99-opt-num
772        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-ope-dir-cd
773        else
end:21      773          else
start:22      773          else
774        set w0n99-mltpl-dbt-fnd-y to true
775        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:23      775          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
776        set w0n99-abn-fnd-dbt-y to true
777        move l0o33-opt-num(w0n99-one,w0n99-two,xx) to w0n99-abn-opt-num
778        end-if
end:22      778          end-if
779        end-if
end:21      779          end-if
780        end-if
end:20      780          end-if
781        continue.
782    0n99-1421-chck-sup-second-x.
783        exit.
761        perform 0n99-1421-chck-sup-second thru 0n99-1421-chck-sup-second-x
end:19      761          perform 0n99-1421-chck-sup-second thru 0n99-1421-chck-sup-second-x
762        end-if
end:18      762          end-if
763        end-perform
end:17      763          end-perform
764        continue.
765    0n99-1420-chck-occ-second-x.
766        exit.
717        perform 0n99-1420-chck-occ-second thru 0n99-1420-chck-occ-second-x
end:16      717          perform 0n99-1420-chck-occ-second thru 0n99-1420-chck-occ-second-x
718        end-if
end:15      718          end-if
719        end-if
end:14      719          end-if
720        continue.
721    0n99-1400-read-opt-fin-x.
722        exit.
723    0n99-1410-chck-occ-first.
724        perform varying xx from 1 by 1 until xx > wglob-max-fnd-plan-qty or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-values
start:15      724          perform varying xx from 1 by 1 until xx > wglob-max-fnd-plan-qty or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-values
725        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:16      725          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
726        perform 0n99-1411-chck-sup-first thru 0n99-1411-chck-sup-first-x
start:17      726          perform 0n99-1411-chck-sup-first thru 0n99-1411-chck-sup-first-x
732    0n99-1411-chck-sup-first.
733        if l0o33-ope-dir-entree(w0n99-one,w0n99-one)
start:18      733          if l0o33-ope-dir-entree(w0n99-one,w0n99-one)
734        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
start:19      734          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
735        set w0n99-abe-fnd-rcp-y to true
736        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-ope-dir-cd
737        else
end:18      737          else
start:19      737          else
738        set w0n99-mltpl-rcp-fnd-y to true
739        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:20      739          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
740        set w0n99-abn-fnd-rcp-y to true
741        end-if
end:19      741          end-if
742        end-if
end:18      742          end-if
743        end-if
end:17      743          end-if
744        if l0o33-ope-dir-cible(w0n99-one,w0n99-one)
start:18      744          if l0o33-ope-dir-cible(w0n99-one,w0n99-one)
745        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
start:19      745          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
746        set w0n99-abe-fnd-tgt-y to true
747        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-ope-dir-cd
748        else
end:18      748          else
start:19      748          else
749        set w0n99-mltpl-tgt-fnd-y to true
750        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:20      750          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
751        set w0n99-abn-fnd-tgt-y to true
752        end-if
end:19      752          end-if
753        end-if
end:18      753          end-if
754        end-if
end:17      754          end-if
755        continue.
756    0n99-1411-chck-sup-first-x.
757        exit.
726        perform 0n99-1411-chck-sup-first thru 0n99-1411-chck-sup-first-x
end:16      726          perform 0n99-1411-chck-sup-first thru 0n99-1411-chck-sup-first-x
727        end-if
end:15      727          end-if
728        end-perform
end:14      728          end-perform
729        continue.
730    0n99-1410-chck-occ-first-x.
731        exit.
732    0n99-1411-chck-sup-first.
733        if l0o33-ope-dir-entree(w0n99-one,w0n99-one)
start:15      733          if l0o33-ope-dir-entree(w0n99-one,w0n99-one)
734        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
start:16      734          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
735        set w0n99-abe-fnd-rcp-y to true
736        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-ope-dir-cd
737        else
end:15      737          else
start:16      737          else
738        set w0n99-mltpl-rcp-fnd-y to true
739        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:17      739          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
740        set w0n99-abn-fnd-rcp-y to true
741        end-if
end:16      741          end-if
742        end-if
end:15      742          end-if
743        end-if
end:14      743          end-if
744        if l0o33-ope-dir-cible(w0n99-one,w0n99-one)
start:15      744          if l0o33-ope-dir-cible(w0n99-one,w0n99-one)
745        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
start:16      745          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id
746        set w0n99-abe-fnd-tgt-y to true
747        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-ope-dir-cd
748        else
end:15      748          else
start:16      748          else
749        set w0n99-mltpl-tgt-fnd-y to true
750        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:17      750          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
751        set w0n99-abn-fnd-tgt-y to true
752        end-if
end:16      752          end-if
753        end-if
end:15      753          end-if
754        end-if
end:14      754          end-if
755        continue.
756    0n99-1411-chck-sup-first-x.
757        exit.
758    0n99-1420-chck-occ-second.
759        perform varying xx from 1 by 1 until xx > wglob-max-fnd-plan-qty or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces
start:15      759          perform varying xx from 1 by 1 until xx > wglob-max-fnd-plan-qty or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces
760        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:16      760          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
761        perform 0n99-1421-chck-sup-second thru 0n99-1421-chck-sup-second-x
start:17      761          perform 0n99-1421-chck-sup-second thru 0n99-1421-chck-sup-second-x
767    0n99-1421-chck-sup-second.
768        if l0o33-ope-dir-sorte(w0n99-one,w0n99-two)
start:18      768          if l0o33-ope-dir-sorte(w0n99-one,w0n99-two)
769        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id
start:19      769          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id
770        set w0n99-abe-fnd-dbt-y to true
771        move l0o33-opt-num(w0n99-one,w0n99-two,xx) to w0n99-opt-num
772        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-ope-dir-cd
773        else
end:18      773          else
start:19      773          else
774        set w0n99-mltpl-dbt-fnd-y to true
775        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:20      775          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
776        set w0n99-abn-fnd-dbt-y to true
777        move l0o33-opt-num(w0n99-one,w0n99-two,xx) to w0n99-abn-opt-num
778        end-if
end:19      778          end-if
779        end-if
end:18      779          end-if
780        end-if
end:17      780          end-if
781        continue.
782    0n99-1421-chck-sup-second-x.
783        exit.
761        perform 0n99-1421-chck-sup-second thru 0n99-1421-chck-sup-second-x
end:16      761          perform 0n99-1421-chck-sup-second thru 0n99-1421-chck-sup-second-x
762        end-if
end:15      762          end-if
763        end-perform
end:14      763          end-perform
764        continue.
765    0n99-1420-chck-occ-second-x.
766        exit.
767    0n99-1421-chck-sup-second.
768        if l0o33-ope-dir-sorte(w0n99-one,w0n99-two)
start:15      768          if l0o33-ope-dir-sorte(w0n99-one,w0n99-two)
769        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id
start:16      769          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id
770        set w0n99-abe-fnd-dbt-y to true
771        move l0o33-opt-num(w0n99-one,w0n99-two,xx) to w0n99-opt-num
772        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-ope-dir-cd
773        else
end:15      773          else
start:16      773          else
774        set w0n99-mltpl-dbt-fnd-y to true
775        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:17      775          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
776        set w0n99-abn-fnd-dbt-y to true
777        move l0o33-opt-num(w0n99-one,w0n99-two,xx) to w0n99-abn-opt-num
778        end-if
end:16      778          end-if
779        end-if
end:15      779          end-if
780        end-if
end:14      780          end-if
781        continue.
782    0n99-1421-chck-sup-second-x.
783        exit.
784    0n99-1500-ost-process.
785        initialize w0n99-term-fnd-id
786        if w0n99-abe-fnd-dbt-y
start:15      786          if w0n99-abe-fnd-dbt-y
787        set w0n99-flag-mod-y to true
788        perform 0n99-1510-abe-fnd-dbt thru 0n99-1510-abe-fnd-dbt-x
start:16      788          perform 0n99-1510-abe-fnd-dbt thru 0n99-1510-abe-fnd-dbt-x
808    0n99-1510-abe-fnd-dbt.
809        if w0n99-abn-fnd-rcp-y
start:17      809          if w0n99-abn-fnd-rcp-y
810        if w0n99-mltpl-dbt-fnd-y
start:18      810          if w0n99-mltpl-dbt-fnd-y
811        move l0n99-abe-fnd-id to w0n99-term-fnd-id
812        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:19      812          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:20      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:21      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:20      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:21      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:22      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:21      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:20      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:21      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:20      895          go to 0n99-1540-lapse-support-x
start:21      895          go to 0n99-1540-lapse-support-x
896        end-if
end:20      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:19      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:20      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:21      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:22      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:23      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:24      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:23      3336          else
start:24      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:23      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:23      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:22      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:21      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:20      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:21      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:20      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:21      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:20      1971          when w0n99-opt-rh-optrpp
start:21      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:20      1973          when w0n99-opt-rh-optecr
start:21      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:22      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:21      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:22      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:21      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:20      1980          when w0n99-opt-rh-optsl1
start:21      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:22      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:21      1983          else
start:22      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:21      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:20      1986          when w0n99-opt-rh-optsw1
start:21      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:22      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:21      1989          else
start:22      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:21      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:20      1992          when w0n99-opt-rh-optsr1
start:21      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:22      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:21      1995          else
start:22      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:21      1997          end-if
1998        when w0n99-opt-rh-optip1
end:20      1998          when w0n99-opt-rh-optip1
start:21      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:22      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:21      2001          else
start:22      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:21      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:20      2004          when w0n99-opt-rh-optcl1
start:21      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:22      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:21      2007          else
start:22      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:21      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:20      2010          when w0n99-opt-rh-optsp1
start:21      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:22      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:21      2013          else
start:22      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:21      2015          end-if
2016        when w0n99-opt-rh-optra1
end:20      2016          when w0n99-opt-rh-optra1
start:21      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:20      2018          when other
start:21      2018          when other
2019        continue
2020        end-evaluate
end:20      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:21      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:22      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:21      3201          else
start:22      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:21      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:22      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:23      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:24      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:23      3336          else
start:24      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:23      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:23      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:22      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:21      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:20      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:19      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:20      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:19      902          go to 0n99-1540-lapse-support-x
start:20      902          go to 0n99-1540-lapse-support-x
903        end-if
end:19      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
812        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:18      812          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
813        else
end:17      813          else
start:18      813          else
814        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:19      814          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:20      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:21      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:20      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:21      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:22      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:21      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:20      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:21      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:20      932          go to 0n99-1550-lapse-fin-opt-x
start:21      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:20      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:19      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
814        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:18      814          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
815        end-if
end:17      815          end-if
816        else
end:16      816          else
start:17      816          else
817        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
start:18      817          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
939    0n99-1560-check-abn-support.
940        set w0n99-abn-fnd-avl-n to true
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
start:19      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
end:18      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
942        move rpol-plan-id to l0o34-plan-id
943        move rpol-cd-opt-ofp-act to l0o34-cd-opt-ofp-act
944        move l0o33-opt-eff-dt(w0n99-one) to l0o34-opt-eff-dt
945        move w0n99-opt-rh-id to l0o34-opt-rh-id
946        move l0o33-opt-sign-dt(w0n99-one) to l0o34-opt-sign-dt
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
start:19      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:20      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:19      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
end:18      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
948        if not l0o34-retrn-ok
start:19      948          if not l0o34-retrn-ok
949        set l0n99-retrn-error to true
950        go to 0n99-1560-check-abn-support-x
end:18      950          go to 0n99-1560-check-abn-support-x
start:19      950          go to 0n99-1560-check-abn-support-x
951        end-if
end:18      951          end-if
952        perform varying j from 1 by 1 until j > w0n99-two
start:19      952          perform varying j from 1 by 1 until j > w0n99-two
953        perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
start:20      953          perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
954        if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
start:21      954          if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
955        set w0n99-abn-fnd-avl-y to true
956        end-if
end:20      956          end-if
957        end-perform
end:19      957          end-perform
958        end-perform
end:18      958          end-perform
959        continue.
960    0n99-1560-check-abn-support-x.
961        exit.
817        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
end:17      817          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
818        if w0n99-abn-fnd-avl-y
start:18      818          if w0n99-abn-fnd-avl-y
819        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
start:19      819          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
962    0n99-1570-mod-fin-opt.
963        initialize w0n99-fnd-ope-dir-cd
964        initialize w0n99-fnd-rel-rt
965        initialize w0n99-fnd-pct
966        initialize w0n99-fnd-ref-amt
967        initialize w0n99-fnd-amt
968        move w0n99-one to w0n99-fnd-num
969        if l0n99-chk-admsblty-mod
start:20      969          if l0n99-chk-admsblty-mod
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
start:21      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
end:20      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
971        set l0o40-record-fopt-info to true
972        move rpol-pol-id to l0o40-pol-id
973        move rpol-plan-id to l0o40-plan-id
974        move w0n99-opt-rh-id to l0o40-opt-rh-id
975        move rpol-cd-opt-ofp-act to l0o40-cd-opt-ofp-act
976        move rpol-pol-base-cvg-num to l0o40-cvg-num-n
977        move l0o34-opt-typ-cd to w0n99-opt-typ-cd
978        move l0n99-ope-eff-dt to l0o40-ref-eff-dt
979        move l0n99-ope-eff-dt to l0o40-da-fcn-pol-cvt
980        move l0n99-ope-eff-dt to l0o40-db-fcn-pol
981        move l0o33-recv-whole-file-dt(w0n99-one) to l0o40-recv-whole-file-dt
982        move l0n99-ost-ind to l0o40-ost-ind
983        move wglob-transaction-id to w0n99-transaction-id
984        move l0o33-opt-nxt-actv-dt(w0n99-one) to l0o40-opt-nxt-actv-dt
985        set l0o40-stp-08 to true
986        set wglob-transaction-mdof to true
987        evaluate true
start:21      988          when w0n99-opt-typ-cl
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
start:22      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:23      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:25      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:27      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:26      1226          end-if
1227        else
end:25      1227          else
start:26      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:26      1234          end-if
1235        end-if
end:25      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:24      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:23      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:24      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:25      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:26      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:27      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:26      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:27      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:26      1246          else
start:27      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:28      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:27      1249          end-if
1250        end-if
end:26      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:27      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:26      1253          end-if
1254        else
end:25      1254          else
start:26      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:26      1261          end-if
1262        end-if
end:25      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:24      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:23      1209          end-if
1210        end-perform
end:22      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:22      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
end:21      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
990        when w0n99-opt-typ-re
end:20      990          when w0n99-opt-typ-re
start:21      990          when w0n99-opt-typ-re
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
start:22      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:23      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:25      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:27      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:26      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:27      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:26      1310          end-if
1311        else
end:25      1311          else
start:26      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:26      1318          end-if
1319        end-if
end:25      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:24      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:23      1291          end-if
1292        end-perform
end:22      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:22      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
end:21      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
992        when w0n99-opt-typ-sp
end:20      992          when w0n99-opt-typ-sp
start:21      992          when w0n99-opt-typ-sp
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
start:22      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:23      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:25      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:27      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:26      1368          end-if
1369        else
end:25      1369          else
start:26      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:26      1376          end-if
1377        end-if
end:25      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:24      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:23      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:24      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:25      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:26      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:27      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:26      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:27      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:26      1388          else
start:27      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:28      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:27      1391          end-if
1392        end-if
end:26      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:27      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:26      1395          end-if
1396        else
end:25      1396          else
start:26      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:26      1403          end-if
1404        end-if
end:25      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:24      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:23      1351          end-if
1352        end-perform
end:22      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:22      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
end:21      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
994        when w0n99-opt-typ-sr
end:20      994          when w0n99-opt-typ-sr
start:21      994          when w0n99-opt-typ-sr
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
start:22      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:23      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:22      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:23      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:24      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:25      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:24      2830          else
start:25      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:24      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:24      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:23      1125          go to 0n99-1590-cvgu-browse-x
start:24      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:23      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:24      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:25      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:26      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:27      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:29      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:30      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:29      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:29      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:27      1591          go to 0n99-3010-stop-win-x
start:28      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:27      1592          end-if
1593        if w0n99-ope-dir-entree
start:28      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:29      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:30      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:29      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:30      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:29      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:27      1595          else
start:28      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:29      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:29      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:29      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:29      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:27      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:28      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:27      1600          end-if
1601        end-if
end:26      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:24      1133          when w0n99-opt-typ-sl
start:25      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:26      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:27      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:29      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:30      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:29      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:29      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:27      1702          go to 0n99-3020-stop-loss-x
start:28      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:27      1703          end-if
1704        if w0n99-ope-dir-entree
start:28      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:29      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:30      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:29      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:30      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:29      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:27      1706          else
start:28      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:29      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:29      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:29      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:29      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:27      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:28      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:27      1711          end-if
1712        end-if
end:26      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:24      1135          when w0n99-opt-typ-sr
start:25      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:26      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:27      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:29      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:30      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:29      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:29      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:27      1813          go to 0n99-3030-stop-lr-x
start:28      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:27      1814          end-if
1815        if w0n99-ope-dir-entree
start:28      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:29      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:30      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:29      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:30      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:29      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:27      1817          else
start:28      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:29      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:29      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:29      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:29      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:27      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:28      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:27      1822          end-if
1823        end-if
end:26      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:24      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:25      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:26      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:27      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:26      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:23      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:24      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:22      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:23      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:24      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:23      1906          end-if
1907        if w0n99-fl-abe-y
start:24      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:23      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:22      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
end:21      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
996        when w0n99-opt-typ-sl
end:20      996          when w0n99-opt-typ-sl
start:21      996          when w0n99-opt-typ-sl
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
start:22      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:23      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:22      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:23      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:24      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:25      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:24      2830          else
start:25      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:24      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:24      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:23      1125          go to 0n99-1590-cvgu-browse-x
start:24      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:23      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:24      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:25      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:26      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:27      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:29      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:30      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:29      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:29      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:27      1591          go to 0n99-3010-stop-win-x
start:28      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:27      1592          end-if
1593        if w0n99-ope-dir-entree
start:28      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:29      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:30      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:29      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:30      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:29      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:27      1595          else
start:28      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:29      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:29      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:29      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:29      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:27      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:28      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:27      1600          end-if
1601        end-if
end:26      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:24      1133          when w0n99-opt-typ-sl
start:25      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:26      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:27      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:29      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:30      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:29      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:29      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:27      1702          go to 0n99-3020-stop-loss-x
start:28      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:27      1703          end-if
1704        if w0n99-ope-dir-entree
start:28      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:29      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:30      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:29      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:30      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:29      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:27      1706          else
start:28      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:29      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:29      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:29      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:29      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:27      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:28      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:27      1711          end-if
1712        end-if
end:26      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:24      1135          when w0n99-opt-typ-sr
start:25      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:26      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:27      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:29      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:30      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:29      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:29      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:27      1813          go to 0n99-3030-stop-lr-x
start:28      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:27      1814          end-if
1815        if w0n99-ope-dir-entree
start:28      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:29      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:30      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:29      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:30      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:29      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:27      1817          else
start:28      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:29      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:29      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:29      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:29      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:27      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:28      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:27      1822          end-if
1823        end-if
end:26      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:24      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:25      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:26      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:27      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:26      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:23      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:24      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:22      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:23      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:24      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:23      1795          end-if
1796        if w0n99-fl-abe-y
start:24      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:23      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:22      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
end:21      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
998        when w0n99-opt-typ-sw
end:20      998          when w0n99-opt-typ-sw
start:21      998          when w0n99-opt-typ-sw
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
start:22      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:23      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:22      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:23      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:24      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:25      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:24      2830          else
start:25      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:24      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:24      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:23      1125          go to 0n99-1590-cvgu-browse-x
start:24      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:23      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:24      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:25      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:26      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:27      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:29      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:30      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:29      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:29      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:27      1591          go to 0n99-3010-stop-win-x
start:28      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:27      1592          end-if
1593        if w0n99-ope-dir-entree
start:28      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:29      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:30      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:29      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:30      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:29      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:27      1595          else
start:28      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:29      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:29      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:29      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:29      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:27      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:28      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:27      1600          end-if
1601        end-if
end:26      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:24      1133          when w0n99-opt-typ-sl
start:25      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:26      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:27      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:29      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:30      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:29      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:29      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:27      1702          go to 0n99-3020-stop-loss-x
start:28      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:27      1703          end-if
1704        if w0n99-ope-dir-entree
start:28      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:29      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:30      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:29      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:30      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:29      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:27      1706          else
start:28      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:29      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:29      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:29      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:29      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:27      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:28      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:27      1711          end-if
1712        end-if
end:26      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:24      1135          when w0n99-opt-typ-sr
start:25      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:26      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:27      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:29      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:30      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:29      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:29      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:27      1813          go to 0n99-3030-stop-lr-x
start:28      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:27      1814          end-if
1815        if w0n99-ope-dir-entree
start:28      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:29      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:30      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:29      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:30      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:29      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:27      1817          else
start:28      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:29      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:29      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:29      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:29      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:27      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:28      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:27      1822          end-if
1823        end-if
end:26      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:24      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:25      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:26      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:27      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:26      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:23      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:24      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:22      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:23      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:24      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:23      1684          end-if
1685        if w0n99-fl-abe-y
start:24      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:23      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:22      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
end:21      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1000        when w0n99-opt-typ-ip
end:20      1000          when w0n99-opt-typ-ip
start:21      1000          when w0n99-opt-typ-ip
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
start:22      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:23      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:25      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:27      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:26      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:27      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:26      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:27      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:26      1549          end-if
1550        else
end:25      1550          else
start:26      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:26      1558          end-if
1559        end-if
end:25      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:24      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:23      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:24      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:25      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:26      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:27      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:26      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:27      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:26      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:27      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:26      1573          end-if
1574        else
end:25      1574          else
start:26      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:26      1582          end-if
1583        end-if
end:25      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:24      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:23      1526          end-if
1527        end-perform
end:22      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:22      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
end:21      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1002        when other
end:20      1002          when other
start:21      1002          when other
1003        go to 0n99-1570-mod-fin-opt-x
end:20      1003          go to 0n99-1570-mod-fin-opt-x
start:21      1003          go to 0n99-1570-mod-fin-opt-x
1004        end-evaluate
end:20      1004          end-evaluate
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
start:21      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
2251    0o40-1000-record-fopt-info.
2252        set l0o40-record-fopt-info to true
2253        perform 0o40-0000-call thru 0o40-0000-call-x
start:22      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2253        perform 0o40-0000-call thru 0o40-0000-call-x
end:21      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2254        continue.
2255    0o40-1000-record-fopt-info-x.
2256        exit.
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
end:20      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
1006        if l0o40-retrn-error or w0n99-cpb-csq-blk
start:21      1006          if l0o40-retrn-error or w0n99-cpb-csq-blk
1007        set l0n99-retrn-error to true
1008        move 'sc0n990012' to wglob-msg-ref-info
1009        move rpol-pol-id to wglob-msg-parm(1)
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:22      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:22      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:21      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1011        go to 0n99-1570-mod-fin-opt-x
end:20      1011          go to 0n99-1570-mod-fin-opt-x
start:21      1011          go to 0n99-1570-mod-fin-opt-x
1012        end-if
end:20      1012          end-if
1013        move w0n99-transaction-id to wglob-transaction-id
1014        set w0n99-lapse-flag-n to true
1015        perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
start:21      1015          perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
1016        if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
start:22      1016          if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
1017        set w0n99-lapse-flag-y to true
1018        end-if
end:21      1018          end-if
1019        end-perform
end:20      1019          end-perform
1020        if w0n99-lapse-flag-y
start:21      1020          if w0n99-lapse-flag-y
1021        initialize w0n99-lapse-supp-ind
1022        if w0n99-abe-fnd-dbt-y
start:22      1022          if w0n99-abe-fnd-dbt-y
1023        if w0n99-mltpl-dbt-fnd-y
start:23      1023          if w0n99-mltpl-dbt-fnd-y
1024        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:24      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:25      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:26      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:25      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:26      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:25      895          go to 0n99-1540-lapse-support-x
start:26      895          go to 0n99-1540-lapse-support-x
896        end-if
end:25      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:24      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:25      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:26      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:27      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:26      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:25      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:26      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:25      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:26      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:25      1971          when w0n99-opt-rh-optrpp
start:26      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:25      1973          when w0n99-opt-rh-optecr
start:26      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:27      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:26      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:27      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:26      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:25      1980          when w0n99-opt-rh-optsl1
start:26      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:27      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:26      1983          else
start:27      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:26      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:25      1986          when w0n99-opt-rh-optsw1
start:26      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:27      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:26      1989          else
start:27      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:26      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:25      1992          when w0n99-opt-rh-optsr1
start:26      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:27      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:26      1995          else
start:27      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:26      1997          end-if
1998        when w0n99-opt-rh-optip1
end:25      1998          when w0n99-opt-rh-optip1
start:26      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:27      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:26      2001          else
start:27      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:26      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:25      2004          when w0n99-opt-rh-optcl1
start:26      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:27      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:26      2007          else
start:27      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:26      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:25      2010          when w0n99-opt-rh-optsp1
start:26      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:27      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:26      2013          else
start:27      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:26      2015          end-if
2016        when w0n99-opt-rh-optra1
end:25      2016          when w0n99-opt-rh-optra1
start:26      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:25      2018          when other
start:26      2018          when other
2019        continue
2020        end-evaluate
end:25      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:26      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:27      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:26      3201          else
start:27      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:26      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:27      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:26      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:25      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:24      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:25      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:24      902          go to 0n99-1540-lapse-support-x
start:25      902          go to 0n99-1540-lapse-support-x
903        end-if
end:24      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:23      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1026        if l0n99-retrn-error
start:24      1026          if l0n99-retrn-error
1027        go to 0n99-1570-mod-fin-opt-x
end:23      1027          go to 0n99-1570-mod-fin-opt-x
start:24      1027          go to 0n99-1570-mod-fin-opt-x
1028        end-if
end:23      1028          end-if
1029        else
end:22      1029          else
start:23      1029          else
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:24      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:25      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:26      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:26      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:25      932          go to 0n99-1550-lapse-fin-opt-x
start:26      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:25      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:24      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:23      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1031        if l0n99-retrn-error
start:24      1031          if l0n99-retrn-error
1032        go to 0n99-1570-mod-fin-opt-x
end:23      1032          go to 0n99-1570-mod-fin-opt-x
start:24      1032          go to 0n99-1570-mod-fin-opt-x
1033        end-if
end:23      1033          end-if
1034        end-if
end:22      1034          end-if
1035        end-if
end:21      1035          end-if
1036        if w0n99-abe-fnd-rcp-y
start:22      1036          if w0n99-abe-fnd-rcp-y
1037        if w0n99-mltpl-rcp-fnd-y
start:23      1037          if w0n99-mltpl-rcp-fnd-y
1038        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:24      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:25      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:26      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:25      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:26      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:25      895          go to 0n99-1540-lapse-support-x
start:26      895          go to 0n99-1540-lapse-support-x
896        end-if
end:25      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:24      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:25      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:26      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:27      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:26      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:25      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:26      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:25      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:26      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:25      1971          when w0n99-opt-rh-optrpp
start:26      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:25      1973          when w0n99-opt-rh-optecr
start:26      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:27      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:26      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:27      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:26      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:25      1980          when w0n99-opt-rh-optsl1
start:26      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:27      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:26      1983          else
start:27      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:26      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:25      1986          when w0n99-opt-rh-optsw1
start:26      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:27      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:26      1989          else
start:27      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:26      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:25      1992          when w0n99-opt-rh-optsr1
start:26      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:27      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:26      1995          else
start:27      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:26      1997          end-if
1998        when w0n99-opt-rh-optip1
end:25      1998          when w0n99-opt-rh-optip1
start:26      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:27      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:26      2001          else
start:27      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:26      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:25      2004          when w0n99-opt-rh-optcl1
start:26      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:27      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:26      2007          else
start:27      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:26      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:25      2010          when w0n99-opt-rh-optsp1
start:26      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:27      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:26      2013          else
start:27      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:26      2015          end-if
2016        when w0n99-opt-rh-optra1
end:25      2016          when w0n99-opt-rh-optra1
start:26      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:25      2018          when other
start:26      2018          when other
2019        continue
2020        end-evaluate
end:25      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:26      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:27      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:26      3201          else
start:27      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:26      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:27      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:26      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:25      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:24      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:25      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:24      902          go to 0n99-1540-lapse-support-x
start:25      902          go to 0n99-1540-lapse-support-x
903        end-if
end:24      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:23      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1040        if l0n99-retrn-error
start:24      1040          if l0n99-retrn-error
1041        go to 0n99-1570-mod-fin-opt-x
end:23      1041          go to 0n99-1570-mod-fin-opt-x
start:24      1041          go to 0n99-1570-mod-fin-opt-x
1042        end-if
end:23      1042          end-if
1043        else
end:22      1043          else
start:23      1043          else
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:24      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:25      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:26      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:26      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:25      932          go to 0n99-1550-lapse-fin-opt-x
start:26      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:25      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:24      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:23      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1045        if l0n99-retrn-error
start:24      1045          if l0n99-retrn-error
1046        go to 0n99-1570-mod-fin-opt-x
end:23      1046          go to 0n99-1570-mod-fin-opt-x
start:24      1046          go to 0n99-1570-mod-fin-opt-x
1047        end-if
end:23      1047          end-if
1048        end-if
end:22      1048          end-if
1049        end-if
end:21      1049          end-if
1050        if w0n99-abe-fnd-tgt-y
start:22      1050          if w0n99-abe-fnd-tgt-y
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:23      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:24      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:25      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:24      932          go to 0n99-1550-lapse-fin-opt-x
start:25      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:24      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:23      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:22      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1052        if l0n99-retrn-error
start:23      1052          if l0n99-retrn-error
1053        go to 0n99-1570-mod-fin-opt-x
end:22      1053          go to 0n99-1570-mod-fin-opt-x
start:23      1053          go to 0n99-1570-mod-fin-opt-x
1054        end-if
end:22      1054          end-if
1055        end-if
end:21      1055          end-if
1056        end-if
end:20      1056          end-if
1057        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
start:21      1057          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
1058        set w0n99-ref-amt-updt-y to true
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
start:22      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:23      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:22      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:23      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:24      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:23      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:22      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:23      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
end:22      1159          go to 0n99-1600-mod-ref-amt-x
start:23      1159          go to 0n99-1600-mod-ref-amt-x
1160        end-if
end:22      1160          end-if
1161        compute w0n99-fnd-ref-amt = l0o37-fnd-ref-amt + l0n99-abe-cv-amt
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:23      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:22      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1163        set l0o37-rqst-calc to true
1164        set l0o37-ref-val-calc-ind-t to true
1165        move rpol-pol-id to l0o37-pol-id
1166        move l0n99-abn-fnd-id to l0o37-fnd-id
1167        move w0n99-opt-rh-id to l0o37-opt-rh-id
1168        move w0n99-abn-opt-num to l0o37-opt-num
1169        move w0n99-stp-cd-5 to l0o37-stp-cd
1170        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1171        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1172        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:23      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:24      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:23      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:22      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1174        if not l0o37-retrn-ok
start:23      1174          if not l0o37-retrn-ok
1175        set l0n99-retrn-error to true
1176        go to 0n99-1600-mod-ref-amt-x
end:22      1176          go to 0n99-1600-mod-ref-amt-x
start:23      1176          go to 0n99-1600-mod-ref-amt-x
1177        end-if
end:22      1177          end-if
1178        continue.
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
end:21      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1060        end-if
end:20      1060          end-if
1061        if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
start:21      1061          if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
start:22      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1071    0n99-1580-mod-ref-val.
1072        if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
start:23      1072          if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
1073        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
start:24      1073          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
1074        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0n99-abn-cv-amt
1075        end-if
end:23      1075          end-if
1076        if w0n99-abe-fnd-dbt-y
start:24      1076          if w0n99-abe-fnd-dbt-y
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:25      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:24      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1078        set l0o37-rqst-calc to true
1079        set l0o37-ref-val-calc-ind-t to true
1080        move rpol-pol-id to l0o37-pol-id
1081        move l0n99-abn-fnd-id to l0o37-fnd-id
1082        move w0n99-opt-rh-id to l0o37-opt-rh-id
1083        move w0n99-abn-opt-num to l0o37-opt-num
1084        move l0o40-stp-cd to l0o37-stp-cd
1085        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1086        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1087        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:25      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:26      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:25      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:24      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1089        if not l0o37-retrn-ok or w0n99-cpb-csq-blk
start:25      1089          if not l0o37-retrn-ok or w0n99-cpb-csq-blk
1090        set l0n99-retrn-error to true
1091        move 'sc0n990015' to wglob-msg-ref-info
1092        move rpol-pol-id to wglob-msg-parm(1)
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:26      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:27      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:25      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1094        go to 0n99-1580-mod-ref-val-x
end:24      1094          go to 0n99-1580-mod-ref-val-x
start:25      1094          go to 0n99-1580-mod-ref-val-x
1095        end-if
end:24      1095          end-if
1096        end-if
end:23      1096          end-if
1097        end-if
end:22      1097          end-if
1098        continue.
1099    0n99-1580-mod-ref-val-x.
1100        exit.
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
end:21      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1063        end-if
end:20      1063          end-if
1064        if l0n99-retrn-ok
start:21      1064          if l0n99-retrn-ok
1065        set w0n99-prcs-gevt-y to true
1066        end-if
end:20      1066          end-if
1067        end-if
end:19      1067          end-if
1068        continue.
1069    0n99-1570-mod-fin-opt-x.
1070        exit.
819        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
end:18      819          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
820        else
end:17      820          else
start:18      820          else
821        if w0n99-mltpl-dbt-fnd-y
start:19      821          if w0n99-mltpl-dbt-fnd-y
822        move l0n99-abe-fnd-id to w0n99-term-fnd-id
823        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:20      823          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:21      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:22      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:21      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:22      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:23      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:22      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:21      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:22      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:21      895          go to 0n99-1540-lapse-support-x
start:22      895          go to 0n99-1540-lapse-support-x
896        end-if
end:21      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:20      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:21      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:22      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:23      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:22      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:21      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:22      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:21      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:22      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:21      1971          when w0n99-opt-rh-optrpp
start:22      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:21      1973          when w0n99-opt-rh-optecr
start:22      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:23      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:22      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:23      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:22      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:21      1980          when w0n99-opt-rh-optsl1
start:22      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:23      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:22      1983          else
start:23      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:22      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:21      1986          when w0n99-opt-rh-optsw1
start:22      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:23      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:22      1989          else
start:23      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:22      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:21      1992          when w0n99-opt-rh-optsr1
start:22      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:23      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:22      1995          else
start:23      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:22      1997          end-if
1998        when w0n99-opt-rh-optip1
end:21      1998          when w0n99-opt-rh-optip1
start:22      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:23      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:22      2001          else
start:23      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:22      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:21      2004          when w0n99-opt-rh-optcl1
start:22      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:23      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:22      2007          else
start:23      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:22      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:21      2010          when w0n99-opt-rh-optsp1
start:22      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:23      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:22      2013          else
start:23      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:22      2015          end-if
2016        when w0n99-opt-rh-optra1
end:21      2016          when w0n99-opt-rh-optra1
start:22      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:21      2018          when other
start:22      2018          when other
2019        continue
2020        end-evaluate
end:21      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:22      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:23      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:22      3201          else
start:23      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:22      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:23      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:22      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:21      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:20      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:21      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:20      902          go to 0n99-1540-lapse-support-x
start:21      902          go to 0n99-1540-lapse-support-x
903        end-if
end:20      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
823        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:19      823          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
824        else
end:18      824          else
start:19      824          else
825        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:20      825          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:21      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:22      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:21      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:22      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:23      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:22      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:21      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:22      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:21      932          go to 0n99-1550-lapse-fin-opt-x
start:22      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:21      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:20      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
825        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:19      825          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
826        end-if
end:18      826          end-if
827        end-if
end:17      827          end-if
828        end-if
end:16      828          end-if
829        continue.
830    0n99-1510-abe-fnd-dbt-x.
831        exit.
788        perform 0n99-1510-abe-fnd-dbt thru 0n99-1510-abe-fnd-dbt-x
end:15      788          perform 0n99-1510-abe-fnd-dbt thru 0n99-1510-abe-fnd-dbt-x
789        end-if
end:14      789          end-if
790        if w0n99-abe-fnd-rcp-y
start:15      790          if w0n99-abe-fnd-rcp-y
791        set w0n99-flag-mod-y to true
792        perform 0n99-1520-abe-fnd-rcp thru 0n99-1520-abe-fnd-rcp-x
start:16      792          perform 0n99-1520-abe-fnd-rcp thru 0n99-1520-abe-fnd-rcp-x
832    0n99-1520-abe-fnd-rcp.
833        if w0n99-abn-fnd-dbt-y
start:17      833          if w0n99-abn-fnd-dbt-y
834        if w0n99-mltpl-rcp-fnd-y
start:18      834          if w0n99-mltpl-rcp-fnd-y
835        move l0n99-abe-fnd-id to w0n99-term-fnd-id
836        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:19      836          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:20      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:21      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:20      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:21      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:22      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:21      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:20      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:21      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:20      895          go to 0n99-1540-lapse-support-x
start:21      895          go to 0n99-1540-lapse-support-x
896        end-if
end:20      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:19      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:20      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:21      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:22      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:23      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:24      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:23      3336          else
start:24      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:23      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:23      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:22      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:21      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:20      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:21      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:20      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:21      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:20      1971          when w0n99-opt-rh-optrpp
start:21      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:20      1973          when w0n99-opt-rh-optecr
start:21      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:22      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:21      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:22      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:21      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:20      1980          when w0n99-opt-rh-optsl1
start:21      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:22      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:21      1983          else
start:22      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:21      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:20      1986          when w0n99-opt-rh-optsw1
start:21      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:22      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:21      1989          else
start:22      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:21      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:20      1992          when w0n99-opt-rh-optsr1
start:21      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:22      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:21      1995          else
start:22      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:21      1997          end-if
1998        when w0n99-opt-rh-optip1
end:20      1998          when w0n99-opt-rh-optip1
start:21      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:22      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:21      2001          else
start:22      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:21      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:20      2004          when w0n99-opt-rh-optcl1
start:21      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:22      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:21      2007          else
start:22      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:21      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:20      2010          when w0n99-opt-rh-optsp1
start:21      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:22      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:21      2013          else
start:22      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:21      2015          end-if
2016        when w0n99-opt-rh-optra1
end:20      2016          when w0n99-opt-rh-optra1
start:21      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:20      2018          when other
start:21      2018          when other
2019        continue
2020        end-evaluate
end:20      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:21      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:22      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:21      3201          else
start:22      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:21      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:22      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:23      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:24      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:23      3336          else
start:24      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:23      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:23      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:22      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:21      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:20      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:19      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:20      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:19      902          go to 0n99-1540-lapse-support-x
start:20      902          go to 0n99-1540-lapse-support-x
903        end-if
end:19      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
836        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:18      836          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
837        else
end:17      837          else
start:18      837          else
838        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:19      838          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:20      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:21      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:20      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:21      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:22      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:21      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:20      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:21      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:20      932          go to 0n99-1550-lapse-fin-opt-x
start:21      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:20      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:19      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
838        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:18      838          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
839        end-if
end:17      839          end-if
840        else
end:16      840          else
start:17      840          else
841        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
start:18      841          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
939    0n99-1560-check-abn-support.
940        set w0n99-abn-fnd-avl-n to true
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
start:19      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
end:18      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
942        move rpol-plan-id to l0o34-plan-id
943        move rpol-cd-opt-ofp-act to l0o34-cd-opt-ofp-act
944        move l0o33-opt-eff-dt(w0n99-one) to l0o34-opt-eff-dt
945        move w0n99-opt-rh-id to l0o34-opt-rh-id
946        move l0o33-opt-sign-dt(w0n99-one) to l0o34-opt-sign-dt
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
start:19      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:20      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:19      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
end:18      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
948        if not l0o34-retrn-ok
start:19      948          if not l0o34-retrn-ok
949        set l0n99-retrn-error to true
950        go to 0n99-1560-check-abn-support-x
end:18      950          go to 0n99-1560-check-abn-support-x
start:19      950          go to 0n99-1560-check-abn-support-x
951        end-if
end:18      951          end-if
952        perform varying j from 1 by 1 until j > w0n99-two
start:19      952          perform varying j from 1 by 1 until j > w0n99-two
953        perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
start:20      953          perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
954        if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
start:21      954          if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
955        set w0n99-abn-fnd-avl-y to true
956        end-if
end:20      956          end-if
957        end-perform
end:19      957          end-perform
958        end-perform
end:18      958          end-perform
959        continue.
960    0n99-1560-check-abn-support-x.
961        exit.
841        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
end:17      841          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
842        if w0n99-abn-fnd-avl-y
start:18      842          if w0n99-abn-fnd-avl-y
843        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
start:19      843          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
962    0n99-1570-mod-fin-opt.
963        initialize w0n99-fnd-ope-dir-cd
964        initialize w0n99-fnd-rel-rt
965        initialize w0n99-fnd-pct
966        initialize w0n99-fnd-ref-amt
967        initialize w0n99-fnd-amt
968        move w0n99-one to w0n99-fnd-num
969        if l0n99-chk-admsblty-mod
start:20      969          if l0n99-chk-admsblty-mod
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
start:21      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
end:20      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
971        set l0o40-record-fopt-info to true
972        move rpol-pol-id to l0o40-pol-id
973        move rpol-plan-id to l0o40-plan-id
974        move w0n99-opt-rh-id to l0o40-opt-rh-id
975        move rpol-cd-opt-ofp-act to l0o40-cd-opt-ofp-act
976        move rpol-pol-base-cvg-num to l0o40-cvg-num-n
977        move l0o34-opt-typ-cd to w0n99-opt-typ-cd
978        move l0n99-ope-eff-dt to l0o40-ref-eff-dt
979        move l0n99-ope-eff-dt to l0o40-da-fcn-pol-cvt
980        move l0n99-ope-eff-dt to l0o40-db-fcn-pol
981        move l0o33-recv-whole-file-dt(w0n99-one) to l0o40-recv-whole-file-dt
982        move l0n99-ost-ind to l0o40-ost-ind
983        move wglob-transaction-id to w0n99-transaction-id
984        move l0o33-opt-nxt-actv-dt(w0n99-one) to l0o40-opt-nxt-actv-dt
985        set l0o40-stp-08 to true
986        set wglob-transaction-mdof to true
987        evaluate true
start:21      988          when w0n99-opt-typ-cl
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
start:22      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:23      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:25      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:27      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:26      1226          end-if
1227        else
end:25      1227          else
start:26      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:26      1234          end-if
1235        end-if
end:25      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:24      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:23      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:24      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:25      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:26      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:27      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:26      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:27      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:26      1246          else
start:27      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:28      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:27      1249          end-if
1250        end-if
end:26      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:27      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:26      1253          end-if
1254        else
end:25      1254          else
start:26      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:26      1261          end-if
1262        end-if
end:25      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:24      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:23      1209          end-if
1210        end-perform
end:22      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:22      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
end:21      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
990        when w0n99-opt-typ-re
end:20      990          when w0n99-opt-typ-re
start:21      990          when w0n99-opt-typ-re
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
start:22      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:23      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:25      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:27      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:26      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:27      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:26      1310          end-if
1311        else
end:25      1311          else
start:26      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:26      1318          end-if
1319        end-if
end:25      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:24      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:23      1291          end-if
1292        end-perform
end:22      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:22      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
end:21      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
992        when w0n99-opt-typ-sp
end:20      992          when w0n99-opt-typ-sp
start:21      992          when w0n99-opt-typ-sp
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
start:22      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:23      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:25      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:27      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:26      1368          end-if
1369        else
end:25      1369          else
start:26      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:26      1376          end-if
1377        end-if
end:25      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:24      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:23      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:24      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:25      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:26      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:27      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:26      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:27      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:26      1388          else
start:27      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:28      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:27      1391          end-if
1392        end-if
end:26      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:27      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:26      1395          end-if
1396        else
end:25      1396          else
start:26      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:26      1403          end-if
1404        end-if
end:25      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:24      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:23      1351          end-if
1352        end-perform
end:22      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:22      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
end:21      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
994        when w0n99-opt-typ-sr
end:20      994          when w0n99-opt-typ-sr
start:21      994          when w0n99-opt-typ-sr
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
start:22      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:23      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:22      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:23      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:24      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:25      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:24      2830          else
start:25      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:24      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:24      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:23      1125          go to 0n99-1590-cvgu-browse-x
start:24      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:23      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:24      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:25      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:26      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:27      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:29      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:30      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:29      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:29      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:27      1591          go to 0n99-3010-stop-win-x
start:28      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:27      1592          end-if
1593        if w0n99-ope-dir-entree
start:28      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:29      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:30      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:29      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:30      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:29      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:27      1595          else
start:28      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:29      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:29      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:29      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:29      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:27      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:28      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:27      1600          end-if
1601        end-if
end:26      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:24      1133          when w0n99-opt-typ-sl
start:25      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:26      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:27      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:29      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:30      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:29      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:29      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:27      1702          go to 0n99-3020-stop-loss-x
start:28      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:27      1703          end-if
1704        if w0n99-ope-dir-entree
start:28      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:29      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:30      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:29      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:30      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:29      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:27      1706          else
start:28      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:29      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:29      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:29      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:29      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:27      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:28      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:27      1711          end-if
1712        end-if
end:26      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:24      1135          when w0n99-opt-typ-sr
start:25      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:26      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:27      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:29      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:30      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:29      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:29      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:27      1813          go to 0n99-3030-stop-lr-x
start:28      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:27      1814          end-if
1815        if w0n99-ope-dir-entree
start:28      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:29      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:30      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:29      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:30      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:29      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:27      1817          else
start:28      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:29      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:29      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:29      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:29      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:27      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:28      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:27      1822          end-if
1823        end-if
end:26      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:24      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:25      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:26      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:27      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:26      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:23      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:24      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:22      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:23      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:24      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:23      1906          end-if
1907        if w0n99-fl-abe-y
start:24      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:23      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:22      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
end:21      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
996        when w0n99-opt-typ-sl
end:20      996          when w0n99-opt-typ-sl
start:21      996          when w0n99-opt-typ-sl
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
start:22      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:23      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:22      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:23      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:24      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:25      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:24      2830          else
start:25      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:24      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:24      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:23      1125          go to 0n99-1590-cvgu-browse-x
start:24      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:23      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:24      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:25      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:26      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:27      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:29      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:30      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:29      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:29      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:27      1591          go to 0n99-3010-stop-win-x
start:28      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:27      1592          end-if
1593        if w0n99-ope-dir-entree
start:28      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:29      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:30      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:29      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:30      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:29      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:27      1595          else
start:28      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:29      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:29      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:29      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:29      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:27      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:28      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:27      1600          end-if
1601        end-if
end:26      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:24      1133          when w0n99-opt-typ-sl
start:25      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:26      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:27      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:29      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:30      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:29      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:29      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:27      1702          go to 0n99-3020-stop-loss-x
start:28      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:27      1703          end-if
1704        if w0n99-ope-dir-entree
start:28      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:29      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:30      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:29      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:30      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:29      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:27      1706          else
start:28      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:29      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:29      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:29      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:29      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:27      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:28      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:27      1711          end-if
1712        end-if
end:26      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:24      1135          when w0n99-opt-typ-sr
start:25      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:26      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:27      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:29      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:30      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:29      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:29      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:27      1813          go to 0n99-3030-stop-lr-x
start:28      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:27      1814          end-if
1815        if w0n99-ope-dir-entree
start:28      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:29      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:30      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:29      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:30      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:29      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:27      1817          else
start:28      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:29      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:29      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:29      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:29      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:27      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:28      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:27      1822          end-if
1823        end-if
end:26      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:24      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:25      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:26      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:27      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:26      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:23      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:24      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:22      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:23      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:24      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:23      1795          end-if
1796        if w0n99-fl-abe-y
start:24      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:23      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:22      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
end:21      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
998        when w0n99-opt-typ-sw
end:20      998          when w0n99-opt-typ-sw
start:21      998          when w0n99-opt-typ-sw
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
start:22      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:23      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:22      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:23      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:24      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:25      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:24      2830          else
start:25      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:24      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:24      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:23      1125          go to 0n99-1590-cvgu-browse-x
start:24      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:23      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:24      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:25      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:26      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:27      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:29      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:30      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:29      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:29      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:27      1591          go to 0n99-3010-stop-win-x
start:28      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:27      1592          end-if
1593        if w0n99-ope-dir-entree
start:28      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:29      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:30      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:29      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:30      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:29      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:27      1595          else
start:28      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:29      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:29      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:29      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:29      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:27      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:28      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:27      1600          end-if
1601        end-if
end:26      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:24      1133          when w0n99-opt-typ-sl
start:25      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:26      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:27      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:29      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:30      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:29      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:29      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:27      1702          go to 0n99-3020-stop-loss-x
start:28      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:27      1703          end-if
1704        if w0n99-ope-dir-entree
start:28      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:29      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:30      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:29      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:30      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:29      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:27      1706          else
start:28      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:29      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:29      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:29      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:29      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:27      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:28      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:27      1711          end-if
1712        end-if
end:26      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:24      1135          when w0n99-opt-typ-sr
start:25      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:26      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:27      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:29      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:30      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:29      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:29      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:27      1813          go to 0n99-3030-stop-lr-x
start:28      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:27      1814          end-if
1815        if w0n99-ope-dir-entree
start:28      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:29      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:30      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:29      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:30      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:29      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:27      1817          else
start:28      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:29      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:29      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:29      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:29      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:27      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:28      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:27      1822          end-if
1823        end-if
end:26      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:24      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:25      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:26      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:27      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:26      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:23      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:24      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:22      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:23      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:24      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:23      1684          end-if
1685        if w0n99-fl-abe-y
start:24      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:23      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:22      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
end:21      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1000        when w0n99-opt-typ-ip
end:20      1000          when w0n99-opt-typ-ip
start:21      1000          when w0n99-opt-typ-ip
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
start:22      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:23      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:25      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:27      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:26      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:27      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:26      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:27      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:26      1549          end-if
1550        else
end:25      1550          else
start:26      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:26      1558          end-if
1559        end-if
end:25      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:24      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:23      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:24      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:25      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:26      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:27      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:26      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:27      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:26      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:27      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:26      1573          end-if
1574        else
end:25      1574          else
start:26      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:26      1582          end-if
1583        end-if
end:25      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:24      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:23      1526          end-if
1527        end-perform
end:22      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:22      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
end:21      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1002        when other
end:20      1002          when other
start:21      1002          when other
1003        go to 0n99-1570-mod-fin-opt-x
end:20      1003          go to 0n99-1570-mod-fin-opt-x
start:21      1003          go to 0n99-1570-mod-fin-opt-x
1004        end-evaluate
end:20      1004          end-evaluate
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
start:21      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
2251    0o40-1000-record-fopt-info.
2252        set l0o40-record-fopt-info to true
2253        perform 0o40-0000-call thru 0o40-0000-call-x
start:22      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2253        perform 0o40-0000-call thru 0o40-0000-call-x
end:21      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2254        continue.
2255    0o40-1000-record-fopt-info-x.
2256        exit.
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
end:20      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
1006        if l0o40-retrn-error or w0n99-cpb-csq-blk
start:21      1006          if l0o40-retrn-error or w0n99-cpb-csq-blk
1007        set l0n99-retrn-error to true
1008        move 'sc0n990012' to wglob-msg-ref-info
1009        move rpol-pol-id to wglob-msg-parm(1)
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:22      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:22      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:21      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1011        go to 0n99-1570-mod-fin-opt-x
end:20      1011          go to 0n99-1570-mod-fin-opt-x
start:21      1011          go to 0n99-1570-mod-fin-opt-x
1012        end-if
end:20      1012          end-if
1013        move w0n99-transaction-id to wglob-transaction-id
1014        set w0n99-lapse-flag-n to true
1015        perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
start:21      1015          perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
1016        if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
start:22      1016          if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
1017        set w0n99-lapse-flag-y to true
1018        end-if
end:21      1018          end-if
1019        end-perform
end:20      1019          end-perform
1020        if w0n99-lapse-flag-y
start:21      1020          if w0n99-lapse-flag-y
1021        initialize w0n99-lapse-supp-ind
1022        if w0n99-abe-fnd-dbt-y
start:22      1022          if w0n99-abe-fnd-dbt-y
1023        if w0n99-mltpl-dbt-fnd-y
start:23      1023          if w0n99-mltpl-dbt-fnd-y
1024        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:24      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:25      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:26      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:25      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:26      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:25      895          go to 0n99-1540-lapse-support-x
start:26      895          go to 0n99-1540-lapse-support-x
896        end-if
end:25      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:24      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:25      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:26      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:27      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:26      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:25      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:26      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:25      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:26      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:25      1971          when w0n99-opt-rh-optrpp
start:26      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:25      1973          when w0n99-opt-rh-optecr
start:26      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:27      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:26      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:27      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:26      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:25      1980          when w0n99-opt-rh-optsl1
start:26      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:27      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:26      1983          else
start:27      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:26      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:25      1986          when w0n99-opt-rh-optsw1
start:26      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:27      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:26      1989          else
start:27      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:26      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:25      1992          when w0n99-opt-rh-optsr1
start:26      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:27      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:26      1995          else
start:27      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:26      1997          end-if
1998        when w0n99-opt-rh-optip1
end:25      1998          when w0n99-opt-rh-optip1
start:26      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:27      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:26      2001          else
start:27      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:26      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:25      2004          when w0n99-opt-rh-optcl1
start:26      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:27      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:26      2007          else
start:27      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:26      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:25      2010          when w0n99-opt-rh-optsp1
start:26      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:27      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:26      2013          else
start:27      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:26      2015          end-if
2016        when w0n99-opt-rh-optra1
end:25      2016          when w0n99-opt-rh-optra1
start:26      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:25      2018          when other
start:26      2018          when other
2019        continue
2020        end-evaluate
end:25      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:26      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:27      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:26      3201          else
start:27      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:26      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:27      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:26      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:25      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:24      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:25      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:24      902          go to 0n99-1540-lapse-support-x
start:25      902          go to 0n99-1540-lapse-support-x
903        end-if
end:24      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:23      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1026        if l0n99-retrn-error
start:24      1026          if l0n99-retrn-error
1027        go to 0n99-1570-mod-fin-opt-x
end:23      1027          go to 0n99-1570-mod-fin-opt-x
start:24      1027          go to 0n99-1570-mod-fin-opt-x
1028        end-if
end:23      1028          end-if
1029        else
end:22      1029          else
start:23      1029          else
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:24      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:25      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:26      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:26      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:25      932          go to 0n99-1550-lapse-fin-opt-x
start:26      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:25      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:24      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:23      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1031        if l0n99-retrn-error
start:24      1031          if l0n99-retrn-error
1032        go to 0n99-1570-mod-fin-opt-x
end:23      1032          go to 0n99-1570-mod-fin-opt-x
start:24      1032          go to 0n99-1570-mod-fin-opt-x
1033        end-if
end:23      1033          end-if
1034        end-if
end:22      1034          end-if
1035        end-if
end:21      1035          end-if
1036        if w0n99-abe-fnd-rcp-y
start:22      1036          if w0n99-abe-fnd-rcp-y
1037        if w0n99-mltpl-rcp-fnd-y
start:23      1037          if w0n99-mltpl-rcp-fnd-y
1038        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:24      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:25      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:26      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:25      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:26      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:25      895          go to 0n99-1540-lapse-support-x
start:26      895          go to 0n99-1540-lapse-support-x
896        end-if
end:25      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:24      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:25      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:26      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:27      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:26      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:25      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:26      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:25      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:26      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:25      1971          when w0n99-opt-rh-optrpp
start:26      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:25      1973          when w0n99-opt-rh-optecr
start:26      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:27      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:26      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:27      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:26      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:25      1980          when w0n99-opt-rh-optsl1
start:26      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:27      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:26      1983          else
start:27      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:26      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:25      1986          when w0n99-opt-rh-optsw1
start:26      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:27      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:26      1989          else
start:27      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:26      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:25      1992          when w0n99-opt-rh-optsr1
start:26      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:27      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:26      1995          else
start:27      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:26      1997          end-if
1998        when w0n99-opt-rh-optip1
end:25      1998          when w0n99-opt-rh-optip1
start:26      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:27      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:26      2001          else
start:27      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:26      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:25      2004          when w0n99-opt-rh-optcl1
start:26      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:27      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:26      2007          else
start:27      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:26      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:25      2010          when w0n99-opt-rh-optsp1
start:26      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:27      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:26      2013          else
start:27      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:26      2015          end-if
2016        when w0n99-opt-rh-optra1
end:25      2016          when w0n99-opt-rh-optra1
start:26      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:25      2018          when other
start:26      2018          when other
2019        continue
2020        end-evaluate
end:25      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:26      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:27      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:26      3201          else
start:27      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:26      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:27      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:26      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:25      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:24      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:25      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:24      902          go to 0n99-1540-lapse-support-x
start:25      902          go to 0n99-1540-lapse-support-x
903        end-if
end:24      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:23      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1040        if l0n99-retrn-error
start:24      1040          if l0n99-retrn-error
1041        go to 0n99-1570-mod-fin-opt-x
end:23      1041          go to 0n99-1570-mod-fin-opt-x
start:24      1041          go to 0n99-1570-mod-fin-opt-x
1042        end-if
end:23      1042          end-if
1043        else
end:22      1043          else
start:23      1043          else
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:24      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:25      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:26      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:26      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:25      932          go to 0n99-1550-lapse-fin-opt-x
start:26      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:25      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:24      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:23      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1045        if l0n99-retrn-error
start:24      1045          if l0n99-retrn-error
1046        go to 0n99-1570-mod-fin-opt-x
end:23      1046          go to 0n99-1570-mod-fin-opt-x
start:24      1046          go to 0n99-1570-mod-fin-opt-x
1047        end-if
end:23      1047          end-if
1048        end-if
end:22      1048          end-if
1049        end-if
end:21      1049          end-if
1050        if w0n99-abe-fnd-tgt-y
start:22      1050          if w0n99-abe-fnd-tgt-y
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:23      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:24      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:25      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:24      932          go to 0n99-1550-lapse-fin-opt-x
start:25      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:24      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:23      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:22      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1052        if l0n99-retrn-error
start:23      1052          if l0n99-retrn-error
1053        go to 0n99-1570-mod-fin-opt-x
end:22      1053          go to 0n99-1570-mod-fin-opt-x
start:23      1053          go to 0n99-1570-mod-fin-opt-x
1054        end-if
end:22      1054          end-if
1055        end-if
end:21      1055          end-if
1056        end-if
end:20      1056          end-if
1057        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
start:21      1057          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
1058        set w0n99-ref-amt-updt-y to true
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
start:22      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:23      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:22      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:23      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:24      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:23      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:22      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:23      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
end:22      1159          go to 0n99-1600-mod-ref-amt-x
start:23      1159          go to 0n99-1600-mod-ref-amt-x
1160        end-if
end:22      1160          end-if
1161        compute w0n99-fnd-ref-amt = l0o37-fnd-ref-amt + l0n99-abe-cv-amt
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:23      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:22      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1163        set l0o37-rqst-calc to true
1164        set l0o37-ref-val-calc-ind-t to true
1165        move rpol-pol-id to l0o37-pol-id
1166        move l0n99-abn-fnd-id to l0o37-fnd-id
1167        move w0n99-opt-rh-id to l0o37-opt-rh-id
1168        move w0n99-abn-opt-num to l0o37-opt-num
1169        move w0n99-stp-cd-5 to l0o37-stp-cd
1170        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1171        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1172        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:23      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:24      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:23      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:22      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1174        if not l0o37-retrn-ok
start:23      1174          if not l0o37-retrn-ok
1175        set l0n99-retrn-error to true
1176        go to 0n99-1600-mod-ref-amt-x
end:22      1176          go to 0n99-1600-mod-ref-amt-x
start:23      1176          go to 0n99-1600-mod-ref-amt-x
1177        end-if
end:22      1177          end-if
1178        continue.
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
end:21      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1060        end-if
end:20      1060          end-if
1061        if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
start:21      1061          if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
start:22      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1071    0n99-1580-mod-ref-val.
1072        if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
start:23      1072          if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
1073        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
start:24      1073          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
1074        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0n99-abn-cv-amt
1075        end-if
end:23      1075          end-if
1076        if w0n99-abe-fnd-dbt-y
start:24      1076          if w0n99-abe-fnd-dbt-y
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:25      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:24      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1078        set l0o37-rqst-calc to true
1079        set l0o37-ref-val-calc-ind-t to true
1080        move rpol-pol-id to l0o37-pol-id
1081        move l0n99-abn-fnd-id to l0o37-fnd-id
1082        move w0n99-opt-rh-id to l0o37-opt-rh-id
1083        move w0n99-abn-opt-num to l0o37-opt-num
1084        move l0o40-stp-cd to l0o37-stp-cd
1085        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1086        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1087        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:25      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:26      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:25      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:24      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1089        if not l0o37-retrn-ok or w0n99-cpb-csq-blk
start:25      1089          if not l0o37-retrn-ok or w0n99-cpb-csq-blk
1090        set l0n99-retrn-error to true
1091        move 'sc0n990015' to wglob-msg-ref-info
1092        move rpol-pol-id to wglob-msg-parm(1)
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:26      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:27      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:25      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1094        go to 0n99-1580-mod-ref-val-x
end:24      1094          go to 0n99-1580-mod-ref-val-x
start:25      1094          go to 0n99-1580-mod-ref-val-x
1095        end-if
end:24      1095          end-if
1096        end-if
end:23      1096          end-if
1097        end-if
end:22      1097          end-if
1098        continue.
1099    0n99-1580-mod-ref-val-x.
1100        exit.
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
end:21      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1063        end-if
end:20      1063          end-if
1064        if l0n99-retrn-ok
start:21      1064          if l0n99-retrn-ok
1065        set w0n99-prcs-gevt-y to true
1066        end-if
end:20      1066          end-if
1067        end-if
end:19      1067          end-if
1068        continue.
1069    0n99-1570-mod-fin-opt-x.
1070        exit.
843        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
end:18      843          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
844        else
end:17      844          else
start:18      844          else
845        if w0n99-mltpl-rcp-fnd-y
start:19      845          if w0n99-mltpl-rcp-fnd-y
846        move l0n99-abe-fnd-id to w0n99-term-fnd-id
847        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:20      847          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:21      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:22      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:21      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:22      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:23      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:22      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:21      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:22      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:21      895          go to 0n99-1540-lapse-support-x
start:22      895          go to 0n99-1540-lapse-support-x
896        end-if
end:21      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:20      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:21      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:22      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:23      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:22      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:21      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:22      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:21      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:22      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:21      1971          when w0n99-opt-rh-optrpp
start:22      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:21      1973          when w0n99-opt-rh-optecr
start:22      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:23      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:22      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:23      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:22      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:21      1980          when w0n99-opt-rh-optsl1
start:22      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:23      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:22      1983          else
start:23      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:22      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:21      1986          when w0n99-opt-rh-optsw1
start:22      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:23      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:22      1989          else
start:23      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:22      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:21      1992          when w0n99-opt-rh-optsr1
start:22      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:23      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:22      1995          else
start:23      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:22      1997          end-if
1998        when w0n99-opt-rh-optip1
end:21      1998          when w0n99-opt-rh-optip1
start:22      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:23      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:22      2001          else
start:23      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:22      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:21      2004          when w0n99-opt-rh-optcl1
start:22      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:23      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:22      2007          else
start:23      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:22      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:21      2010          when w0n99-opt-rh-optsp1
start:22      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:23      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:22      2013          else
start:23      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:22      2015          end-if
2016        when w0n99-opt-rh-optra1
end:21      2016          when w0n99-opt-rh-optra1
start:22      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:21      2018          when other
start:22      2018          when other
2019        continue
2020        end-evaluate
end:21      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:22      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:23      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:22      3201          else
start:23      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:22      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:23      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:22      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:21      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:20      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:21      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:20      902          go to 0n99-1540-lapse-support-x
start:21      902          go to 0n99-1540-lapse-support-x
903        end-if
end:20      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
847        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:19      847          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
848        else
end:18      848          else
start:19      848          else
849        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:20      849          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:21      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:22      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:21      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:22      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:23      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:22      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:21      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:22      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:21      932          go to 0n99-1550-lapse-fin-opt-x
start:22      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:21      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:20      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
849        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:19      849          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
850        end-if
end:18      850          end-if
851        end-if
end:17      851          end-if
852        end-if
end:16      852          end-if
853        continue.
854    0n99-1520-abe-fnd-rcp-x.
855        exit.
792        perform 0n99-1520-abe-fnd-rcp thru 0n99-1520-abe-fnd-rcp-x
end:15      792          perform 0n99-1520-abe-fnd-rcp thru 0n99-1520-abe-fnd-rcp-x
793        end-if
end:14      793          end-if
794        if w0n99-abe-fnd-tgt-y
start:15      794          if w0n99-abe-fnd-tgt-y
795        set w0n99-flag-mod-y to true
796        perform 0n99-1530-abe-fnd-tgt thru 0n99-1530-abe-fnd-tgt-x
start:16      796          perform 0n99-1530-abe-fnd-tgt thru 0n99-1530-abe-fnd-tgt-x
856    0n99-1530-abe-fnd-tgt.
857        if w0n99-abn-fnd-tgt-y
start:17      857          if w0n99-abn-fnd-tgt-y
858        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
start:18      858          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
939    0n99-1560-check-abn-support.
940        set w0n99-abn-fnd-avl-n to true
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
start:19      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
end:18      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
942        move rpol-plan-id to l0o34-plan-id
943        move rpol-cd-opt-ofp-act to l0o34-cd-opt-ofp-act
944        move l0o33-opt-eff-dt(w0n99-one) to l0o34-opt-eff-dt
945        move w0n99-opt-rh-id to l0o34-opt-rh-id
946        move l0o33-opt-sign-dt(w0n99-one) to l0o34-opt-sign-dt
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
start:19      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:20      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:19      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
end:18      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
948        if not l0o34-retrn-ok
start:19      948          if not l0o34-retrn-ok
949        set l0n99-retrn-error to true
950        go to 0n99-1560-check-abn-support-x
end:18      950          go to 0n99-1560-check-abn-support-x
start:19      950          go to 0n99-1560-check-abn-support-x
951        end-if
end:18      951          end-if
952        perform varying j from 1 by 1 until j > w0n99-two
start:19      952          perform varying j from 1 by 1 until j > w0n99-two
953        perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
start:20      953          perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
954        if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
start:21      954          if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
955        set w0n99-abn-fnd-avl-y to true
956        end-if
end:20      956          end-if
957        end-perform
end:19      957          end-perform
958        end-perform
end:18      958          end-perform
959        continue.
960    0n99-1560-check-abn-support-x.
961        exit.
858        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
end:17      858          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
859        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
start:18      859          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
962    0n99-1570-mod-fin-opt.
963        initialize w0n99-fnd-ope-dir-cd
964        initialize w0n99-fnd-rel-rt
965        initialize w0n99-fnd-pct
966        initialize w0n99-fnd-ref-amt
967        initialize w0n99-fnd-amt
968        move w0n99-one to w0n99-fnd-num
969        if l0n99-chk-admsblty-mod
start:19      969          if l0n99-chk-admsblty-mod
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
start:20      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
end:19      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
971        set l0o40-record-fopt-info to true
972        move rpol-pol-id to l0o40-pol-id
973        move rpol-plan-id to l0o40-plan-id
974        move w0n99-opt-rh-id to l0o40-opt-rh-id
975        move rpol-cd-opt-ofp-act to l0o40-cd-opt-ofp-act
976        move rpol-pol-base-cvg-num to l0o40-cvg-num-n
977        move l0o34-opt-typ-cd to w0n99-opt-typ-cd
978        move l0n99-ope-eff-dt to l0o40-ref-eff-dt
979        move l0n99-ope-eff-dt to l0o40-da-fcn-pol-cvt
980        move l0n99-ope-eff-dt to l0o40-db-fcn-pol
981        move l0o33-recv-whole-file-dt(w0n99-one) to l0o40-recv-whole-file-dt
982        move l0n99-ost-ind to l0o40-ost-ind
983        move wglob-transaction-id to w0n99-transaction-id
984        move l0o33-opt-nxt-actv-dt(w0n99-one) to l0o40-opt-nxt-actv-dt
985        set l0o40-stp-08 to true
986        set wglob-transaction-mdof to true
987        evaluate true
start:20      988          when w0n99-opt-typ-cl
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
start:21      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:22      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:23      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:24      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:25      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:26      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:25      1226          end-if
1227        else
end:24      1227          else
start:25      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:25      1234          end-if
1235        end-if
end:24      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:23      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:22      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:23      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:24      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:25      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:26      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:25      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:26      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:25      1246          else
start:26      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:27      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:26      1249          end-if
1250        end-if
end:25      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:26      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:25      1253          end-if
1254        else
end:24      1254          else
start:25      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:25      1261          end-if
1262        end-if
end:24      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:23      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:22      1209          end-if
1210        end-perform
end:21      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:22      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:21      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
end:20      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
990        when w0n99-opt-typ-re
end:19      990          when w0n99-opt-typ-re
start:20      990          when w0n99-opt-typ-re
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
start:21      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:22      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:23      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:24      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:25      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:26      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:25      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:26      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:25      1310          end-if
1311        else
end:24      1311          else
start:25      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:25      1318          end-if
1319        end-if
end:24      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:23      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:22      1291          end-if
1292        end-perform
end:21      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:22      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:21      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
end:20      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
992        when w0n99-opt-typ-sp
end:19      992          when w0n99-opt-typ-sp
start:20      992          when w0n99-opt-typ-sp
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
start:21      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:22      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:23      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:24      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:25      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:26      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:25      1368          end-if
1369        else
end:24      1369          else
start:25      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:25      1376          end-if
1377        end-if
end:24      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:23      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:22      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:23      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:24      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:25      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:26      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:25      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:26      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:25      1388          else
start:26      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:27      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:26      1391          end-if
1392        end-if
end:25      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:26      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:25      1395          end-if
1396        else
end:24      1396          else
start:25      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:25      1403          end-if
1404        end-if
end:24      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:23      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:22      1351          end-if
1352        end-perform
end:21      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:22      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:21      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
end:20      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
994        when w0n99-opt-typ-sr
end:19      994          when w0n99-opt-typ-sr
start:20      994          when w0n99-opt-typ-sr
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
start:21      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:22      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:21      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:22      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:24      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:23      2830          else
start:24      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:23      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:23      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:22      1125          go to 0n99-1590-cvgu-browse-x
start:23      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:22      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:23      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:24      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:26      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:27      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:29      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:29      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:28      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:28      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:26      1591          go to 0n99-3010-stop-win-x
start:27      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:26      1592          end-if
1593        if w0n99-ope-dir-entree
start:27      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:29      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:28      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:29      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:28      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:26      1595          else
start:27      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:29      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:28      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:29      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:28      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:29      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:28      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:26      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:27      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:26      1600          end-if
1601        end-if
end:25      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:23      1133          when w0n99-opt-typ-sl
start:24      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:26      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:27      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:29      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:29      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:28      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:28      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:26      1702          go to 0n99-3020-stop-loss-x
start:27      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:26      1703          end-if
1704        if w0n99-ope-dir-entree
start:27      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:29      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:28      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:29      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:28      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:26      1706          else
start:27      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:29      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:28      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:29      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:28      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:29      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:28      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:26      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:27      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:26      1711          end-if
1712        end-if
end:25      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:23      1135          when w0n99-opt-typ-sr
start:24      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:26      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:27      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:29      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:29      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:28      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:28      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:26      1813          go to 0n99-3030-stop-lr-x
start:27      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:26      1814          end-if
1815        if w0n99-ope-dir-entree
start:27      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:29      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:28      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:29      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:28      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:26      1817          else
start:27      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:29      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:28      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:29      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:28      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:29      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:28      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:26      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:27      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:26      1822          end-if
1823        end-if
end:25      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:23      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:22      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:21      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:22      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:23      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:22      1906          end-if
1907        if w0n99-fl-abe-y
start:23      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:22      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:21      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
end:20      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
996        when w0n99-opt-typ-sl
end:19      996          when w0n99-opt-typ-sl
start:20      996          when w0n99-opt-typ-sl
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
start:21      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:22      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:21      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:22      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:24      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:23      2830          else
start:24      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:23      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:23      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:22      1125          go to 0n99-1590-cvgu-browse-x
start:23      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:22      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:23      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:24      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:26      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:27      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:29      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:29      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:28      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:28      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:26      1591          go to 0n99-3010-stop-win-x
start:27      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:26      1592          end-if
1593        if w0n99-ope-dir-entree
start:27      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:29      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:28      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:29      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:28      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:26      1595          else
start:27      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:29      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:28      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:29      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:28      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:29      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:28      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:26      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:27      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:26      1600          end-if
1601        end-if
end:25      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:23      1133          when w0n99-opt-typ-sl
start:24      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:26      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:27      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:29      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:29      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:28      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:28      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:26      1702          go to 0n99-3020-stop-loss-x
start:27      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:26      1703          end-if
1704        if w0n99-ope-dir-entree
start:27      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:29      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:28      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:29      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:28      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:26      1706          else
start:27      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:29      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:28      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:29      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:28      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:29      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:28      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:26      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:27      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:26      1711          end-if
1712        end-if
end:25      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:23      1135          when w0n99-opt-typ-sr
start:24      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:26      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:27      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:29      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:29      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:28      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:28      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:26      1813          go to 0n99-3030-stop-lr-x
start:27      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:26      1814          end-if
1815        if w0n99-ope-dir-entree
start:27      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:29      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:28      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:29      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:28      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:26      1817          else
start:27      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:29      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:28      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:29      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:28      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:29      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:28      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:26      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:27      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:26      1822          end-if
1823        end-if
end:25      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:23      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:22      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:21      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:22      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:23      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:22      1795          end-if
1796        if w0n99-fl-abe-y
start:23      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:22      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:21      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
end:20      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
998        when w0n99-opt-typ-sw
end:19      998          when w0n99-opt-typ-sw
start:20      998          when w0n99-opt-typ-sw
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
start:21      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:22      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:21      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:22      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:24      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:23      2830          else
start:24      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:23      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:23      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:22      1125          go to 0n99-1590-cvgu-browse-x
start:23      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:22      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:23      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:24      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:26      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:27      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:29      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:29      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:28      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:28      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:26      1591          go to 0n99-3010-stop-win-x
start:27      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:26      1592          end-if
1593        if w0n99-ope-dir-entree
start:27      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:29      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:28      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:29      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:28      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:26      1595          else
start:27      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:29      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:28      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:29      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:28      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:29      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:28      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:26      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:27      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:26      1600          end-if
1601        end-if
end:25      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:23      1133          when w0n99-opt-typ-sl
start:24      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:26      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:27      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:29      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:29      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:28      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:28      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:26      1702          go to 0n99-3020-stop-loss-x
start:27      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:26      1703          end-if
1704        if w0n99-ope-dir-entree
start:27      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:29      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:28      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:29      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:28      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:26      1706          else
start:27      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:29      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:28      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:29      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:28      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:29      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:28      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:26      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:27      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:26      1711          end-if
1712        end-if
end:25      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:23      1135          when w0n99-opt-typ-sr
start:24      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:26      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:27      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:29      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:29      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:28      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:28      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:26      1813          go to 0n99-3030-stop-lr-x
start:27      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:26      1814          end-if
1815        if w0n99-ope-dir-entree
start:27      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:29      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:28      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:29      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:28      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:26      1817          else
start:27      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:29      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:28      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:29      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:28      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:29      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:28      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:26      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:27      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:26      1822          end-if
1823        end-if
end:25      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:23      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:22      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:21      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:22      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:23      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:22      1684          end-if
1685        if w0n99-fl-abe-y
start:23      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:22      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:21      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
end:20      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1000        when w0n99-opt-typ-ip
end:19      1000          when w0n99-opt-typ-ip
start:20      1000          when w0n99-opt-typ-ip
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
start:21      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:22      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:23      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:24      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:25      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:26      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:25      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:26      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:25      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:26      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:25      1549          end-if
1550        else
end:24      1550          else
start:25      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:25      1558          end-if
1559        end-if
end:24      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:23      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:22      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:23      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:24      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:25      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:26      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:25      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:26      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:25      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:26      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:25      1573          end-if
1574        else
end:24      1574          else
start:25      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:25      1582          end-if
1583        end-if
end:24      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:23      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:22      1526          end-if
1527        end-perform
end:21      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:22      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:21      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
end:20      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1002        when other
end:19      1002          when other
start:20      1002          when other
1003        go to 0n99-1570-mod-fin-opt-x
end:19      1003          go to 0n99-1570-mod-fin-opt-x
start:20      1003          go to 0n99-1570-mod-fin-opt-x
1004        end-evaluate
end:19      1004          end-evaluate
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
start:20      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
2251    0o40-1000-record-fopt-info.
2252        set l0o40-record-fopt-info to true
2253        perform 0o40-0000-call thru 0o40-0000-call-x
start:21      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2253        perform 0o40-0000-call thru 0o40-0000-call-x
end:20      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2254        continue.
2255    0o40-1000-record-fopt-info-x.
2256        exit.
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
end:19      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
1006        if l0o40-retrn-error or w0n99-cpb-csq-blk
start:20      1006          if l0o40-retrn-error or w0n99-cpb-csq-blk
1007        set l0n99-retrn-error to true
1008        move 'sc0n990012' to wglob-msg-ref-info
1009        move rpol-pol-id to wglob-msg-parm(1)
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:21      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:22      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:21      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:20      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1011        go to 0n99-1570-mod-fin-opt-x
end:19      1011          go to 0n99-1570-mod-fin-opt-x
start:20      1011          go to 0n99-1570-mod-fin-opt-x
1012        end-if
end:19      1012          end-if
1013        move w0n99-transaction-id to wglob-transaction-id
1014        set w0n99-lapse-flag-n to true
1015        perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
start:20      1015          perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
1016        if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
start:21      1016          if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
1017        set w0n99-lapse-flag-y to true
1018        end-if
end:20      1018          end-if
1019        end-perform
end:19      1019          end-perform
1020        if w0n99-lapse-flag-y
start:20      1020          if w0n99-lapse-flag-y
1021        initialize w0n99-lapse-supp-ind
1022        if w0n99-abe-fnd-dbt-y
start:21      1022          if w0n99-abe-fnd-dbt-y
1023        if w0n99-mltpl-dbt-fnd-y
start:22      1023          if w0n99-mltpl-dbt-fnd-y
1024        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:23      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:24      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:25      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:24      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:25      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:26      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:25      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:24      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:25      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:24      895          go to 0n99-1540-lapse-support-x
start:25      895          go to 0n99-1540-lapse-support-x
896        end-if
end:24      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:23      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:24      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:25      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:26      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:25      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:24      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:25      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:24      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:25      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:24      1971          when w0n99-opt-rh-optrpp
start:25      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:24      1973          when w0n99-opt-rh-optecr
start:25      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:26      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:25      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:26      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:25      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:24      1980          when w0n99-opt-rh-optsl1
start:25      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:26      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:25      1983          else
start:26      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:25      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:24      1986          when w0n99-opt-rh-optsw1
start:25      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:26      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:25      1989          else
start:26      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:25      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:24      1992          when w0n99-opt-rh-optsr1
start:25      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:26      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:25      1995          else
start:26      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:25      1997          end-if
1998        when w0n99-opt-rh-optip1
end:24      1998          when w0n99-opt-rh-optip1
start:25      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:26      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:25      2001          else
start:26      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:25      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:24      2004          when w0n99-opt-rh-optcl1
start:25      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:26      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:25      2007          else
start:26      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:25      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:24      2010          when w0n99-opt-rh-optsp1
start:25      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:26      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:25      2013          else
start:26      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:25      2015          end-if
2016        when w0n99-opt-rh-optra1
end:24      2016          when w0n99-opt-rh-optra1
start:25      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:24      2018          when other
start:25      2018          when other
2019        continue
2020        end-evaluate
end:24      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:25      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:26      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:25      3201          else
start:26      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:25      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:26      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:25      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:24      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:23      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:24      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:23      902          go to 0n99-1540-lapse-support-x
start:24      902          go to 0n99-1540-lapse-support-x
903        end-if
end:23      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:22      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1026        if l0n99-retrn-error
start:23      1026          if l0n99-retrn-error
1027        go to 0n99-1570-mod-fin-opt-x
end:22      1027          go to 0n99-1570-mod-fin-opt-x
start:23      1027          go to 0n99-1570-mod-fin-opt-x
1028        end-if
end:22      1028          end-if
1029        else
end:21      1029          else
start:22      1029          else
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:23      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:24      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:25      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:24      932          go to 0n99-1550-lapse-fin-opt-x
start:25      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:24      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:23      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:22      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1031        if l0n99-retrn-error
start:23      1031          if l0n99-retrn-error
1032        go to 0n99-1570-mod-fin-opt-x
end:22      1032          go to 0n99-1570-mod-fin-opt-x
start:23      1032          go to 0n99-1570-mod-fin-opt-x
1033        end-if
end:22      1033          end-if
1034        end-if
end:21      1034          end-if
1035        end-if
end:20      1035          end-if
1036        if w0n99-abe-fnd-rcp-y
start:21      1036          if w0n99-abe-fnd-rcp-y
1037        if w0n99-mltpl-rcp-fnd-y
start:22      1037          if w0n99-mltpl-rcp-fnd-y
1038        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:23      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:24      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:25      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:24      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:25      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:26      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:25      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:24      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:25      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:24      895          go to 0n99-1540-lapse-support-x
start:25      895          go to 0n99-1540-lapse-support-x
896        end-if
end:24      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:23      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:24      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:25      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:26      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:25      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:24      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:25      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:24      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:25      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:24      1971          when w0n99-opt-rh-optrpp
start:25      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:24      1973          when w0n99-opt-rh-optecr
start:25      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:26      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:25      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:26      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:25      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:24      1980          when w0n99-opt-rh-optsl1
start:25      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:26      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:25      1983          else
start:26      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:25      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:24      1986          when w0n99-opt-rh-optsw1
start:25      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:26      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:25      1989          else
start:26      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:25      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:24      1992          when w0n99-opt-rh-optsr1
start:25      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:26      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:25      1995          else
start:26      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:25      1997          end-if
1998        when w0n99-opt-rh-optip1
end:24      1998          when w0n99-opt-rh-optip1
start:25      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:26      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:25      2001          else
start:26      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:25      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:24      2004          when w0n99-opt-rh-optcl1
start:25      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:26      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:25      2007          else
start:26      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:25      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:24      2010          when w0n99-opt-rh-optsp1
start:25      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:26      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:25      2013          else
start:26      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:25      2015          end-if
2016        when w0n99-opt-rh-optra1
end:24      2016          when w0n99-opt-rh-optra1
start:25      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:24      2018          when other
start:25      2018          when other
2019        continue
2020        end-evaluate
end:24      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:25      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:26      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:25      3201          else
start:26      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:25      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:26      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:25      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:24      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:23      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:24      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:23      902          go to 0n99-1540-lapse-support-x
start:24      902          go to 0n99-1540-lapse-support-x
903        end-if
end:23      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:22      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1040        if l0n99-retrn-error
start:23      1040          if l0n99-retrn-error
1041        go to 0n99-1570-mod-fin-opt-x
end:22      1041          go to 0n99-1570-mod-fin-opt-x
start:23      1041          go to 0n99-1570-mod-fin-opt-x
1042        end-if
end:22      1042          end-if
1043        else
end:21      1043          else
start:22      1043          else
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:23      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:24      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:25      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:24      932          go to 0n99-1550-lapse-fin-opt-x
start:25      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:24      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:23      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:22      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1045        if l0n99-retrn-error
start:23      1045          if l0n99-retrn-error
1046        go to 0n99-1570-mod-fin-opt-x
end:22      1046          go to 0n99-1570-mod-fin-opt-x
start:23      1046          go to 0n99-1570-mod-fin-opt-x
1047        end-if
end:22      1047          end-if
1048        end-if
end:21      1048          end-if
1049        end-if
end:20      1049          end-if
1050        if w0n99-abe-fnd-tgt-y
start:21      1050          if w0n99-abe-fnd-tgt-y
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:22      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:23      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:24      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:23      932          go to 0n99-1550-lapse-fin-opt-x
start:24      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:23      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:22      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:21      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1052        if l0n99-retrn-error
start:22      1052          if l0n99-retrn-error
1053        go to 0n99-1570-mod-fin-opt-x
end:21      1053          go to 0n99-1570-mod-fin-opt-x
start:22      1053          go to 0n99-1570-mod-fin-opt-x
1054        end-if
end:21      1054          end-if
1055        end-if
end:20      1055          end-if
1056        end-if
end:19      1056          end-if
1057        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
start:20      1057          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
1058        set w0n99-ref-amt-updt-y to true
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
start:21      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:22      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:21      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:22      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:23      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:22      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:21      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:22      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
end:21      1159          go to 0n99-1600-mod-ref-amt-x
start:22      1159          go to 0n99-1600-mod-ref-amt-x
1160        end-if
end:21      1160          end-if
1161        compute w0n99-fnd-ref-amt = l0o37-fnd-ref-amt + l0n99-abe-cv-amt
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:22      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:21      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1163        set l0o37-rqst-calc to true
1164        set l0o37-ref-val-calc-ind-t to true
1165        move rpol-pol-id to l0o37-pol-id
1166        move l0n99-abn-fnd-id to l0o37-fnd-id
1167        move w0n99-opt-rh-id to l0o37-opt-rh-id
1168        move w0n99-abn-opt-num to l0o37-opt-num
1169        move w0n99-stp-cd-5 to l0o37-stp-cd
1170        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1171        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1172        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:22      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:23      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:22      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:21      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1174        if not l0o37-retrn-ok
start:22      1174          if not l0o37-retrn-ok
1175        set l0n99-retrn-error to true
1176        go to 0n99-1600-mod-ref-amt-x
end:21      1176          go to 0n99-1600-mod-ref-amt-x
start:22      1176          go to 0n99-1600-mod-ref-amt-x
1177        end-if
end:21      1177          end-if
1178        continue.
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
end:20      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1060        end-if
end:19      1060          end-if
1061        if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
start:20      1061          if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
start:21      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1071    0n99-1580-mod-ref-val.
1072        if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
start:22      1072          if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
1073        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
start:23      1073          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
1074        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0n99-abn-cv-amt
1075        end-if
end:22      1075          end-if
1076        if w0n99-abe-fnd-dbt-y
start:23      1076          if w0n99-abe-fnd-dbt-y
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:24      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:23      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1078        set l0o37-rqst-calc to true
1079        set l0o37-ref-val-calc-ind-t to true
1080        move rpol-pol-id to l0o37-pol-id
1081        move l0n99-abn-fnd-id to l0o37-fnd-id
1082        move w0n99-opt-rh-id to l0o37-opt-rh-id
1083        move w0n99-abn-opt-num to l0o37-opt-num
1084        move l0o40-stp-cd to l0o37-stp-cd
1085        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1086        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1087        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:24      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:25      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:24      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:23      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1089        if not l0o37-retrn-ok or w0n99-cpb-csq-blk
start:24      1089          if not l0o37-retrn-ok or w0n99-cpb-csq-blk
1090        set l0n99-retrn-error to true
1091        move 'sc0n990015' to wglob-msg-ref-info
1092        move rpol-pol-id to wglob-msg-parm(1)
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1094        go to 0n99-1580-mod-ref-val-x
end:23      1094          go to 0n99-1580-mod-ref-val-x
start:24      1094          go to 0n99-1580-mod-ref-val-x
1095        end-if
end:23      1095          end-if
1096        end-if
end:22      1096          end-if
1097        end-if
end:21      1097          end-if
1098        continue.
1099    0n99-1580-mod-ref-val-x.
1100        exit.
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
end:20      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1063        end-if
end:19      1063          end-if
1064        if l0n99-retrn-ok
start:20      1064          if l0n99-retrn-ok
1065        set w0n99-prcs-gevt-y to true
1066        end-if
end:19      1066          end-if
1067        end-if
end:18      1067          end-if
1068        continue.
1069    0n99-1570-mod-fin-opt-x.
1070        exit.
859        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
end:17      859          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
860        else
end:16      860          else
start:17      860          else
861        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
start:18      861          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
939    0n99-1560-check-abn-support.
940        set w0n99-abn-fnd-avl-n to true
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
start:19      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
end:18      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
942        move rpol-plan-id to l0o34-plan-id
943        move rpol-cd-opt-ofp-act to l0o34-cd-opt-ofp-act
944        move l0o33-opt-eff-dt(w0n99-one) to l0o34-opt-eff-dt
945        move w0n99-opt-rh-id to l0o34-opt-rh-id
946        move l0o33-opt-sign-dt(w0n99-one) to l0o34-opt-sign-dt
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
start:19      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:20      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:19      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
end:18      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
948        if not l0o34-retrn-ok
start:19      948          if not l0o34-retrn-ok
949        set l0n99-retrn-error to true
950        go to 0n99-1560-check-abn-support-x
end:18      950          go to 0n99-1560-check-abn-support-x
start:19      950          go to 0n99-1560-check-abn-support-x
951        end-if
end:18      951          end-if
952        perform varying j from 1 by 1 until j > w0n99-two
start:19      952          perform varying j from 1 by 1 until j > w0n99-two
953        perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
start:20      953          perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
954        if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
start:21      954          if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
955        set w0n99-abn-fnd-avl-y to true
956        end-if
end:20      956          end-if
957        end-perform
end:19      957          end-perform
958        end-perform
end:18      958          end-perform
959        continue.
960    0n99-1560-check-abn-support-x.
961        exit.
861        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
end:17      861          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
862        if w0n99-abn-fnd-avl-y
start:18      862          if w0n99-abn-fnd-avl-y
863        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
start:19      863          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
962    0n99-1570-mod-fin-opt.
963        initialize w0n99-fnd-ope-dir-cd
964        initialize w0n99-fnd-rel-rt
965        initialize w0n99-fnd-pct
966        initialize w0n99-fnd-ref-amt
967        initialize w0n99-fnd-amt
968        move w0n99-one to w0n99-fnd-num
969        if l0n99-chk-admsblty-mod
start:20      969          if l0n99-chk-admsblty-mod
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
start:21      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
end:20      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
971        set l0o40-record-fopt-info to true
972        move rpol-pol-id to l0o40-pol-id
973        move rpol-plan-id to l0o40-plan-id
974        move w0n99-opt-rh-id to l0o40-opt-rh-id
975        move rpol-cd-opt-ofp-act to l0o40-cd-opt-ofp-act
976        move rpol-pol-base-cvg-num to l0o40-cvg-num-n
977        move l0o34-opt-typ-cd to w0n99-opt-typ-cd
978        move l0n99-ope-eff-dt to l0o40-ref-eff-dt
979        move l0n99-ope-eff-dt to l0o40-da-fcn-pol-cvt
980        move l0n99-ope-eff-dt to l0o40-db-fcn-pol
981        move l0o33-recv-whole-file-dt(w0n99-one) to l0o40-recv-whole-file-dt
982        move l0n99-ost-ind to l0o40-ost-ind
983        move wglob-transaction-id to w0n99-transaction-id
984        move l0o33-opt-nxt-actv-dt(w0n99-one) to l0o40-opt-nxt-actv-dt
985        set l0o40-stp-08 to true
986        set wglob-transaction-mdof to true
987        evaluate true
start:21      988          when w0n99-opt-typ-cl
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
start:22      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:23      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:25      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:27      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:26      1226          end-if
1227        else
end:25      1227          else
start:26      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:26      1234          end-if
1235        end-if
end:25      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:24      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:23      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:24      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:25      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:26      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:27      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:26      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:27      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:26      1246          else
start:27      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:28      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:27      1249          end-if
1250        end-if
end:26      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:27      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:26      1253          end-if
1254        else
end:25      1254          else
start:26      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:26      1261          end-if
1262        end-if
end:25      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:24      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:23      1209          end-if
1210        end-perform
end:22      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:22      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
end:21      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
990        when w0n99-opt-typ-re
end:20      990          when w0n99-opt-typ-re
start:21      990          when w0n99-opt-typ-re
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
start:22      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:23      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:25      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:27      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:26      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:27      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:26      1310          end-if
1311        else
end:25      1311          else
start:26      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:26      1318          end-if
1319        end-if
end:25      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:24      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:23      1291          end-if
1292        end-perform
end:22      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:22      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
end:21      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
992        when w0n99-opt-typ-sp
end:20      992          when w0n99-opt-typ-sp
start:21      992          when w0n99-opt-typ-sp
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
start:22      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:23      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:25      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:27      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:26      1368          end-if
1369        else
end:25      1369          else
start:26      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:26      1376          end-if
1377        end-if
end:25      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:24      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:23      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:24      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:25      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:26      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:27      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:26      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:27      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:26      1388          else
start:27      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:28      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:27      1391          end-if
1392        end-if
end:26      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:27      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:26      1395          end-if
1396        else
end:25      1396          else
start:26      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:26      1403          end-if
1404        end-if
end:25      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:24      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:23      1351          end-if
1352        end-perform
end:22      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:22      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
end:21      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
994        when w0n99-opt-typ-sr
end:20      994          when w0n99-opt-typ-sr
start:21      994          when w0n99-opt-typ-sr
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
start:22      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:23      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:22      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:23      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:24      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:25      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:24      2830          else
start:25      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:24      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:24      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:23      1125          go to 0n99-1590-cvgu-browse-x
start:24      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:23      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:24      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:25      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:26      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:27      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:29      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:30      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:29      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:29      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:27      1591          go to 0n99-3010-stop-win-x
start:28      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:27      1592          end-if
1593        if w0n99-ope-dir-entree
start:28      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:29      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:30      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:29      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:30      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:29      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:27      1595          else
start:28      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:29      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:29      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:29      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:29      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:27      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:28      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:27      1600          end-if
1601        end-if
end:26      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:24      1133          when w0n99-opt-typ-sl
start:25      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:26      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:27      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:29      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:30      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:29      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:29      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:27      1702          go to 0n99-3020-stop-loss-x
start:28      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:27      1703          end-if
1704        if w0n99-ope-dir-entree
start:28      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:29      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:30      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:29      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:30      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:29      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:27      1706          else
start:28      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:29      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:29      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:29      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:29      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:27      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:28      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:27      1711          end-if
1712        end-if
end:26      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:24      1135          when w0n99-opt-typ-sr
start:25      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:26      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:27      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:29      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:30      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:29      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:29      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:27      1813          go to 0n99-3030-stop-lr-x
start:28      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:27      1814          end-if
1815        if w0n99-ope-dir-entree
start:28      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:29      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:30      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:29      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:30      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:29      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:27      1817          else
start:28      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:29      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:29      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:29      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:29      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:27      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:28      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:27      1822          end-if
1823        end-if
end:26      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:24      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:25      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:26      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:27      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:26      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:23      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:24      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:22      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:23      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:24      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:23      1906          end-if
1907        if w0n99-fl-abe-y
start:24      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:23      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:22      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
end:21      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
996        when w0n99-opt-typ-sl
end:20      996          when w0n99-opt-typ-sl
start:21      996          when w0n99-opt-typ-sl
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
start:22      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:23      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:22      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:23      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:24      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:25      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:24      2830          else
start:25      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:24      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:24      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:23      1125          go to 0n99-1590-cvgu-browse-x
start:24      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:23      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:24      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:25      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:26      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:27      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:29      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:30      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:29      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:29      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:27      1591          go to 0n99-3010-stop-win-x
start:28      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:27      1592          end-if
1593        if w0n99-ope-dir-entree
start:28      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:29      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:30      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:29      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:30      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:29      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:27      1595          else
start:28      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:29      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:29      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:29      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:29      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:27      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:28      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:27      1600          end-if
1601        end-if
end:26      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:24      1133          when w0n99-opt-typ-sl
start:25      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:26      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:27      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:29      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:30      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:29      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:29      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:27      1702          go to 0n99-3020-stop-loss-x
start:28      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:27      1703          end-if
1704        if w0n99-ope-dir-entree
start:28      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:29      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:30      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:29      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:30      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:29      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:27      1706          else
start:28      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:29      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:29      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:29      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:29      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:27      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:28      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:27      1711          end-if
1712        end-if
end:26      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:24      1135          when w0n99-opt-typ-sr
start:25      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:26      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:27      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:29      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:30      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:29      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:29      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:27      1813          go to 0n99-3030-stop-lr-x
start:28      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:27      1814          end-if
1815        if w0n99-ope-dir-entree
start:28      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:29      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:30      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:29      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:30      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:29      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:27      1817          else
start:28      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:29      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:29      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:29      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:29      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:27      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:28      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:27      1822          end-if
1823        end-if
end:26      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:24      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:25      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:26      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:27      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:26      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:23      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:24      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:22      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:23      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:24      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:23      1795          end-if
1796        if w0n99-fl-abe-y
start:24      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:23      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:22      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
end:21      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
998        when w0n99-opt-typ-sw
end:20      998          when w0n99-opt-typ-sw
start:21      998          when w0n99-opt-typ-sw
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
start:22      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:23      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:22      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:23      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:24      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:25      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:24      2830          else
start:25      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:24      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:23      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:24      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:25      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:24      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:23      1125          go to 0n99-1590-cvgu-browse-x
start:24      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:23      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:24      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:23      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:24      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:25      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:26      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:27      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:29      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:30      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:29      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:29      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:28      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:27      1591          go to 0n99-3010-stop-win-x
start:28      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:27      1592          end-if
1593        if w0n99-ope-dir-entree
start:28      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:29      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:30      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:29      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:30      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:29      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:28      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:27      1595          else
start:28      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:29      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:29      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:29      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:29      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:28      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:27      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:28      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:27      1600          end-if
1601        end-if
end:26      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:25      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:24      1133          when w0n99-opt-typ-sl
start:25      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:26      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:27      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:29      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:30      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:29      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:29      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:28      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:27      1702          go to 0n99-3020-stop-loss-x
start:28      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:27      1703          end-if
1704        if w0n99-ope-dir-entree
start:28      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:29      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:30      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:29      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:30      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:29      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:28      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:27      1706          else
start:28      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:29      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:29      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:29      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:29      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:28      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:27      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:28      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:27      1711          end-if
1712        end-if
end:26      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:25      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:24      1135          when w0n99-opt-typ-sr
start:25      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:26      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:27      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:28      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:29      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:30      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:31      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:30      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:29      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:30      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:29      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:28      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:27      1813          go to 0n99-3030-stop-lr-x
start:28      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:27      1814          end-if
1815        if w0n99-ope-dir-entree
start:28      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:29      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:30      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:29      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:30      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:29      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:28      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:27      1817          else
start:28      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:29      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:30      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:29      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:30      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:29      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:30      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:29      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:28      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:27      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:28      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:27      1822          end-if
1823        end-if
end:26      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:25      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:24      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:25      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:26      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:27      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:26      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:25      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:24      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:23      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:24      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:25      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:26      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:27      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:28      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:27      3336          else
start:28      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:27      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:25      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:24      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:23      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:22      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:23      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:24      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:23      1684          end-if
1685        if w0n99-fl-abe-y
start:24      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:23      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:22      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
end:21      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1000        when w0n99-opt-typ-ip
end:20      1000          when w0n99-opt-typ-ip
start:21      1000          when w0n99-opt-typ-ip
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
start:22      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:23      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:24      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:25      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:26      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:27      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:26      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:27      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:26      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:27      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:26      1549          end-if
1550        else
end:25      1550          else
start:26      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:26      1558          end-if
1559        end-if
end:25      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:24      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:23      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:24      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:25      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:26      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:27      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:26      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:27      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:26      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:27      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:26      1573          end-if
1574        else
end:25      1574          else
start:26      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:27      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:26      1582          end-if
1583        end-if
end:25      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:24      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:23      1526          end-if
1527        end-perform
end:22      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:23      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:22      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
end:21      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1002        when other
end:20      1002          when other
start:21      1002          when other
1003        go to 0n99-1570-mod-fin-opt-x
end:20      1003          go to 0n99-1570-mod-fin-opt-x
start:21      1003          go to 0n99-1570-mod-fin-opt-x
1004        end-evaluate
end:20      1004          end-evaluate
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
start:21      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
2251    0o40-1000-record-fopt-info.
2252        set l0o40-record-fopt-info to true
2253        perform 0o40-0000-call thru 0o40-0000-call-x
start:22      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2253        perform 0o40-0000-call thru 0o40-0000-call-x
end:21      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2254        continue.
2255    0o40-1000-record-fopt-info-x.
2256        exit.
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
end:20      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
1006        if l0o40-retrn-error or w0n99-cpb-csq-blk
start:21      1006          if l0o40-retrn-error or w0n99-cpb-csq-blk
1007        set l0n99-retrn-error to true
1008        move 'sc0n990012' to wglob-msg-ref-info
1009        move rpol-pol-id to wglob-msg-parm(1)
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:22      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:22      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:21      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1011        go to 0n99-1570-mod-fin-opt-x
end:20      1011          go to 0n99-1570-mod-fin-opt-x
start:21      1011          go to 0n99-1570-mod-fin-opt-x
1012        end-if
end:20      1012          end-if
1013        move w0n99-transaction-id to wglob-transaction-id
1014        set w0n99-lapse-flag-n to true
1015        perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
start:21      1015          perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
1016        if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
start:22      1016          if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
1017        set w0n99-lapse-flag-y to true
1018        end-if
end:21      1018          end-if
1019        end-perform
end:20      1019          end-perform
1020        if w0n99-lapse-flag-y
start:21      1020          if w0n99-lapse-flag-y
1021        initialize w0n99-lapse-supp-ind
1022        if w0n99-abe-fnd-dbt-y
start:22      1022          if w0n99-abe-fnd-dbt-y
1023        if w0n99-mltpl-dbt-fnd-y
start:23      1023          if w0n99-mltpl-dbt-fnd-y
1024        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:24      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:25      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:26      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:25      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:26      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:25      895          go to 0n99-1540-lapse-support-x
start:26      895          go to 0n99-1540-lapse-support-x
896        end-if
end:25      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:24      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:25      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:26      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:27      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:26      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:25      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:26      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:25      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:26      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:25      1971          when w0n99-opt-rh-optrpp
start:26      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:25      1973          when w0n99-opt-rh-optecr
start:26      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:27      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:26      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:27      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:26      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:25      1980          when w0n99-opt-rh-optsl1
start:26      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:27      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:26      1983          else
start:27      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:26      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:25      1986          when w0n99-opt-rh-optsw1
start:26      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:27      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:26      1989          else
start:27      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:26      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:25      1992          when w0n99-opt-rh-optsr1
start:26      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:27      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:26      1995          else
start:27      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:26      1997          end-if
1998        when w0n99-opt-rh-optip1
end:25      1998          when w0n99-opt-rh-optip1
start:26      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:27      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:26      2001          else
start:27      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:26      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:25      2004          when w0n99-opt-rh-optcl1
start:26      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:27      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:26      2007          else
start:27      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:26      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:25      2010          when w0n99-opt-rh-optsp1
start:26      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:27      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:26      2013          else
start:27      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:26      2015          end-if
2016        when w0n99-opt-rh-optra1
end:25      2016          when w0n99-opt-rh-optra1
start:26      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:25      2018          when other
start:26      2018          when other
2019        continue
2020        end-evaluate
end:25      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:26      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:27      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:26      3201          else
start:27      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:26      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:27      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:26      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:25      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:24      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:25      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:24      902          go to 0n99-1540-lapse-support-x
start:25      902          go to 0n99-1540-lapse-support-x
903        end-if
end:24      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:23      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1026        if l0n99-retrn-error
start:24      1026          if l0n99-retrn-error
1027        go to 0n99-1570-mod-fin-opt-x
end:23      1027          go to 0n99-1570-mod-fin-opt-x
start:24      1027          go to 0n99-1570-mod-fin-opt-x
1028        end-if
end:23      1028          end-if
1029        else
end:22      1029          else
start:23      1029          else
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:24      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:25      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:26      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:26      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:25      932          go to 0n99-1550-lapse-fin-opt-x
start:26      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:25      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:24      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:23      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1031        if l0n99-retrn-error
start:24      1031          if l0n99-retrn-error
1032        go to 0n99-1570-mod-fin-opt-x
end:23      1032          go to 0n99-1570-mod-fin-opt-x
start:24      1032          go to 0n99-1570-mod-fin-opt-x
1033        end-if
end:23      1033          end-if
1034        end-if
end:22      1034          end-if
1035        end-if
end:21      1035          end-if
1036        if w0n99-abe-fnd-rcp-y
start:22      1036          if w0n99-abe-fnd-rcp-y
1037        if w0n99-mltpl-rcp-fnd-y
start:23      1037          if w0n99-mltpl-rcp-fnd-y
1038        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:24      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:25      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:26      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:25      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:26      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:25      895          go to 0n99-1540-lapse-support-x
start:26      895          go to 0n99-1540-lapse-support-x
896        end-if
end:25      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:24      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:25      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:26      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:27      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:26      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:25      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:26      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:25      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:26      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:25      1971          when w0n99-opt-rh-optrpp
start:26      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:25      1973          when w0n99-opt-rh-optecr
start:26      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:27      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:26      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:27      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:26      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:25      1980          when w0n99-opt-rh-optsl1
start:26      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:27      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:26      1983          else
start:27      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:26      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:25      1986          when w0n99-opt-rh-optsw1
start:26      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:27      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:26      1989          else
start:27      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:26      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:25      1992          when w0n99-opt-rh-optsr1
start:26      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:27      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:26      1995          else
start:27      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:26      1997          end-if
1998        when w0n99-opt-rh-optip1
end:25      1998          when w0n99-opt-rh-optip1
start:26      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:27      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:26      2001          else
start:27      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:26      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:25      2004          when w0n99-opt-rh-optcl1
start:26      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:27      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:26      2007          else
start:27      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:26      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:25      2010          when w0n99-opt-rh-optsp1
start:26      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:27      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:26      2013          else
start:27      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:26      2015          end-if
2016        when w0n99-opt-rh-optra1
end:25      2016          when w0n99-opt-rh-optra1
start:26      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:25      2018          when other
start:26      2018          when other
2019        continue
2020        end-evaluate
end:25      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:26      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:27      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:26      3201          else
start:27      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:26      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:27      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:28      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:29      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:28      3336          else
start:29      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:28      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:29      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:28      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:27      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:26      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:25      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:24      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:25      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:24      902          go to 0n99-1540-lapse-support-x
start:25      902          go to 0n99-1540-lapse-support-x
903        end-if
end:24      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:23      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1040        if l0n99-retrn-error
start:24      1040          if l0n99-retrn-error
1041        go to 0n99-1570-mod-fin-opt-x
end:23      1041          go to 0n99-1570-mod-fin-opt-x
start:24      1041          go to 0n99-1570-mod-fin-opt-x
1042        end-if
end:23      1042          end-if
1043        else
end:22      1043          else
start:23      1043          else
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:24      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:25      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:26      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:26      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:27      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:26      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:25      932          go to 0n99-1550-lapse-fin-opt-x
start:26      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:25      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:24      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:23      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1045        if l0n99-retrn-error
start:24      1045          if l0n99-retrn-error
1046        go to 0n99-1570-mod-fin-opt-x
end:23      1046          go to 0n99-1570-mod-fin-opt-x
start:24      1046          go to 0n99-1570-mod-fin-opt-x
1047        end-if
end:23      1047          end-if
1048        end-if
end:22      1048          end-if
1049        end-if
end:21      1049          end-if
1050        if w0n99-abe-fnd-tgt-y
start:22      1050          if w0n99-abe-fnd-tgt-y
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:23      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:24      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:25      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:25      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:26      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:25      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:24      932          go to 0n99-1550-lapse-fin-opt-x
start:25      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:24      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:23      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:22      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1052        if l0n99-retrn-error
start:23      1052          if l0n99-retrn-error
1053        go to 0n99-1570-mod-fin-opt-x
end:22      1053          go to 0n99-1570-mod-fin-opt-x
start:23      1053          go to 0n99-1570-mod-fin-opt-x
1054        end-if
end:22      1054          end-if
1055        end-if
end:21      1055          end-if
1056        end-if
end:20      1056          end-if
1057        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
start:21      1057          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
1058        set w0n99-ref-amt-updt-y to true
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
start:22      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:23      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:22      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:23      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:24      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:23      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:22      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:23      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
end:22      1159          go to 0n99-1600-mod-ref-amt-x
start:23      1159          go to 0n99-1600-mod-ref-amt-x
1160        end-if
end:22      1160          end-if
1161        compute w0n99-fnd-ref-amt = l0o37-fnd-ref-amt + l0n99-abe-cv-amt
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:23      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:22      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1163        set l0o37-rqst-calc to true
1164        set l0o37-ref-val-calc-ind-t to true
1165        move rpol-pol-id to l0o37-pol-id
1166        move l0n99-abn-fnd-id to l0o37-fnd-id
1167        move w0n99-opt-rh-id to l0o37-opt-rh-id
1168        move w0n99-abn-opt-num to l0o37-opt-num
1169        move w0n99-stp-cd-5 to l0o37-stp-cd
1170        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1171        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1172        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:23      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:24      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:23      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:22      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1174        if not l0o37-retrn-ok
start:23      1174          if not l0o37-retrn-ok
1175        set l0n99-retrn-error to true
1176        go to 0n99-1600-mod-ref-amt-x
end:22      1176          go to 0n99-1600-mod-ref-amt-x
start:23      1176          go to 0n99-1600-mod-ref-amt-x
1177        end-if
end:22      1177          end-if
1178        continue.
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
end:21      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1060        end-if
end:20      1060          end-if
1061        if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
start:21      1061          if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
start:22      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1071    0n99-1580-mod-ref-val.
1072        if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
start:23      1072          if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
1073        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
start:24      1073          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
1074        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0n99-abn-cv-amt
1075        end-if
end:23      1075          end-if
1076        if w0n99-abe-fnd-dbt-y
start:24      1076          if w0n99-abe-fnd-dbt-y
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:25      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:24      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1078        set l0o37-rqst-calc to true
1079        set l0o37-ref-val-calc-ind-t to true
1080        move rpol-pol-id to l0o37-pol-id
1081        move l0n99-abn-fnd-id to l0o37-fnd-id
1082        move w0n99-opt-rh-id to l0o37-opt-rh-id
1083        move w0n99-abn-opt-num to l0o37-opt-num
1084        move l0o40-stp-cd to l0o37-stp-cd
1085        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1086        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1087        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:25      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:26      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:25      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:24      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1089        if not l0o37-retrn-ok or w0n99-cpb-csq-blk
start:25      1089          if not l0o37-retrn-ok or w0n99-cpb-csq-blk
1090        set l0n99-retrn-error to true
1091        move 'sc0n990015' to wglob-msg-ref-info
1092        move rpol-pol-id to wglob-msg-parm(1)
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:26      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:27      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:26      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:25      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1094        go to 0n99-1580-mod-ref-val-x
end:24      1094          go to 0n99-1580-mod-ref-val-x
start:25      1094          go to 0n99-1580-mod-ref-val-x
1095        end-if
end:24      1095          end-if
1096        end-if
end:23      1096          end-if
1097        end-if
end:22      1097          end-if
1098        continue.
1099    0n99-1580-mod-ref-val-x.
1100        exit.
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
end:21      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1063        end-if
end:20      1063          end-if
1064        if l0n99-retrn-ok
start:21      1064          if l0n99-retrn-ok
1065        set w0n99-prcs-gevt-y to true
1066        end-if
end:20      1066          end-if
1067        end-if
end:19      1067          end-if
1068        continue.
1069    0n99-1570-mod-fin-opt-x.
1070        exit.
863        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
end:18      863          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
864        else
end:17      864          else
start:18      864          else
865        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:19      865          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:20      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:21      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:20      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:21      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:22      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:21      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:20      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:21      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:20      932          go to 0n99-1550-lapse-fin-opt-x
start:21      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:20      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:19      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
865        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:18      865          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
866        end-if
end:17      866          end-if
867        end-if
end:16      867          end-if
868        continue.
869    0n99-1530-abe-fnd-tgt-x.
870        exit.
796        perform 0n99-1530-abe-fnd-tgt thru 0n99-1530-abe-fnd-tgt-x
end:15      796          perform 0n99-1530-abe-fnd-tgt thru 0n99-1530-abe-fnd-tgt-x
797        end-if
end:14      797          end-if
798        if l0n99-chk-admsblty-mod and w0n99-abe-fnd-dbt-n and w0n99-abe-fnd-rcp-n and w0n99-abe-fnd-tgt-n and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes
start:15      798          if l0n99-chk-admsblty-mod and w0n99-abe-fnd-dbt-n and w0n99-abe-fnd-rcp-n and w0n99-abe-fnd-tgt-n and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes
799        set w0n99-flag-mod-y to true
800        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
start:16      800          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:17      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:16      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:17      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:18      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:17      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:16      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:17      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
end:16      1159          go to 0n99-1600-mod-ref-amt-x
start:17      1159          go to 0n99-1600-mod-ref-amt-x
1160        end-if
end:16      1160          end-if
1161        compute w0n99-fnd-ref-amt = l0o37-fnd-ref-amt + l0n99-abe-cv-amt
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:17      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:16      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1163        set l0o37-rqst-calc to true
1164        set l0o37-ref-val-calc-ind-t to true
1165        move rpol-pol-id to l0o37-pol-id
1166        move l0n99-abn-fnd-id to l0o37-fnd-id
1167        move w0n99-opt-rh-id to l0o37-opt-rh-id
1168        move w0n99-abn-opt-num to l0o37-opt-num
1169        move w0n99-stp-cd-5 to l0o37-stp-cd
1170        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1171        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1172        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:17      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:18      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:17      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:16      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1174        if not l0o37-retrn-ok
start:17      1174          if not l0o37-retrn-ok
1175        set l0n99-retrn-error to true
1176        go to 0n99-1600-mod-ref-amt-x
end:16      1176          go to 0n99-1600-mod-ref-amt-x
start:17      1176          go to 0n99-1600-mod-ref-amt-x
1177        end-if
end:16      1177          end-if
1178        continue.
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
800        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
end:15      800          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
801        if l0n99-retrn-ok
start:16      801          if l0n99-retrn-ok
802        set w0n99-prcs-gevt-y to true
803        end-if
end:15      803          end-if
804        end-if
end:14      804          end-if
805        continue.
806    0n99-1500-ost-process-x.
807        exit.
808    0n99-1510-abe-fnd-dbt.
809        if w0n99-abn-fnd-rcp-y
start:15      809          if w0n99-abn-fnd-rcp-y
810        if w0n99-mltpl-dbt-fnd-y
start:16      810          if w0n99-mltpl-dbt-fnd-y
811        move l0n99-abe-fnd-id to w0n99-term-fnd-id
812        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:17      812          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:18      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:19      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:18      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:19      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:20      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:19      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:18      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:19      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:18      895          go to 0n99-1540-lapse-support-x
start:19      895          go to 0n99-1540-lapse-support-x
896        end-if
end:18      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:17      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:18      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:19      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:20      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:21      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:22      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:21      3336          else
start:22      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:21      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:22      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:21      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:20      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:19      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:18      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:19      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:18      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:19      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:18      1971          when w0n99-opt-rh-optrpp
start:19      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:18      1973          when w0n99-opt-rh-optecr
start:19      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:20      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:19      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:20      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:19      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:18      1980          when w0n99-opt-rh-optsl1
start:19      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:20      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:19      1983          else
start:20      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:19      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:18      1986          when w0n99-opt-rh-optsw1
start:19      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:20      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:19      1989          else
start:20      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:19      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:18      1992          when w0n99-opt-rh-optsr1
start:19      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:20      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:19      1995          else
start:20      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:19      1997          end-if
1998        when w0n99-opt-rh-optip1
end:18      1998          when w0n99-opt-rh-optip1
start:19      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:20      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:19      2001          else
start:20      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:19      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:18      2004          when w0n99-opt-rh-optcl1
start:19      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:20      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:19      2007          else
start:20      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:19      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:18      2010          when w0n99-opt-rh-optsp1
start:19      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:20      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:19      2013          else
start:20      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:19      2015          end-if
2016        when w0n99-opt-rh-optra1
end:18      2016          when w0n99-opt-rh-optra1
start:19      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:18      2018          when other
start:19      2018          when other
2019        continue
2020        end-evaluate
end:18      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:19      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:20      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:19      3201          else
start:20      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:19      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:20      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:21      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:22      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:21      3336          else
start:22      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:21      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:22      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:21      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:20      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:19      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:18      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:17      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:18      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:17      902          go to 0n99-1540-lapse-support-x
start:18      902          go to 0n99-1540-lapse-support-x
903        end-if
end:17      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
812        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:16      812          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
813        else
end:15      813          else
start:16      813          else
814        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:17      814          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:18      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:19      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:18      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:19      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:20      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:19      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:18      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:19      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:18      932          go to 0n99-1550-lapse-fin-opt-x
start:19      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:18      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:17      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
814        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:16      814          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
815        end-if
end:15      815          end-if
816        else
end:14      816          else
start:15      816          else
817        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
start:16      817          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
939    0n99-1560-check-abn-support.
940        set w0n99-abn-fnd-avl-n to true
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
start:17      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
end:16      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
942        move rpol-plan-id to l0o34-plan-id
943        move rpol-cd-opt-ofp-act to l0o34-cd-opt-ofp-act
944        move l0o33-opt-eff-dt(w0n99-one) to l0o34-opt-eff-dt
945        move w0n99-opt-rh-id to l0o34-opt-rh-id
946        move l0o33-opt-sign-dt(w0n99-one) to l0o34-opt-sign-dt
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
start:17      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:18      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:17      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
end:16      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
948        if not l0o34-retrn-ok
start:17      948          if not l0o34-retrn-ok
949        set l0n99-retrn-error to true
950        go to 0n99-1560-check-abn-support-x
end:16      950          go to 0n99-1560-check-abn-support-x
start:17      950          go to 0n99-1560-check-abn-support-x
951        end-if
end:16      951          end-if
952        perform varying j from 1 by 1 until j > w0n99-two
start:17      952          perform varying j from 1 by 1 until j > w0n99-two
953        perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
start:18      953          perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
954        if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
start:19      954          if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
955        set w0n99-abn-fnd-avl-y to true
956        end-if
end:18      956          end-if
957        end-perform
end:17      957          end-perform
958        end-perform
end:16      958          end-perform
959        continue.
960    0n99-1560-check-abn-support-x.
961        exit.
817        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
end:15      817          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
818        if w0n99-abn-fnd-avl-y
start:16      818          if w0n99-abn-fnd-avl-y
819        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
start:17      819          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
962    0n99-1570-mod-fin-opt.
963        initialize w0n99-fnd-ope-dir-cd
964        initialize w0n99-fnd-rel-rt
965        initialize w0n99-fnd-pct
966        initialize w0n99-fnd-ref-amt
967        initialize w0n99-fnd-amt
968        move w0n99-one to w0n99-fnd-num
969        if l0n99-chk-admsblty-mod
start:18      969          if l0n99-chk-admsblty-mod
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
start:19      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
end:18      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
971        set l0o40-record-fopt-info to true
972        move rpol-pol-id to l0o40-pol-id
973        move rpol-plan-id to l0o40-plan-id
974        move w0n99-opt-rh-id to l0o40-opt-rh-id
975        move rpol-cd-opt-ofp-act to l0o40-cd-opt-ofp-act
976        move rpol-pol-base-cvg-num to l0o40-cvg-num-n
977        move l0o34-opt-typ-cd to w0n99-opt-typ-cd
978        move l0n99-ope-eff-dt to l0o40-ref-eff-dt
979        move l0n99-ope-eff-dt to l0o40-da-fcn-pol-cvt
980        move l0n99-ope-eff-dt to l0o40-db-fcn-pol
981        move l0o33-recv-whole-file-dt(w0n99-one) to l0o40-recv-whole-file-dt
982        move l0n99-ost-ind to l0o40-ost-ind
983        move wglob-transaction-id to w0n99-transaction-id
984        move l0o33-opt-nxt-actv-dt(w0n99-one) to l0o40-opt-nxt-actv-dt
985        set l0o40-stp-08 to true
986        set wglob-transaction-mdof to true
987        evaluate true
start:19      988          when w0n99-opt-typ-cl
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
start:20      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:21      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:23      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:25      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:24      1226          end-if
1227        else
end:23      1227          else
start:24      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:24      1234          end-if
1235        end-if
end:23      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:22      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:21      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:22      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:23      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:24      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:25      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:24      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:25      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:24      1246          else
start:25      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:26      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:25      1249          end-if
1250        end-if
end:24      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:25      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:24      1253          end-if
1254        else
end:23      1254          else
start:24      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:24      1261          end-if
1262        end-if
end:23      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:22      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:21      1209          end-if
1210        end-perform
end:20      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:20      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
end:19      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
990        when w0n99-opt-typ-re
end:18      990          when w0n99-opt-typ-re
start:19      990          when w0n99-opt-typ-re
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
start:20      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:21      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:23      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:25      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:24      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:25      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:24      1310          end-if
1311        else
end:23      1311          else
start:24      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:24      1318          end-if
1319        end-if
end:23      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:22      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:21      1291          end-if
1292        end-perform
end:20      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:20      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
end:19      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
992        when w0n99-opt-typ-sp
end:18      992          when w0n99-opt-typ-sp
start:19      992          when w0n99-opt-typ-sp
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
start:20      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:21      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:23      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:25      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:24      1368          end-if
1369        else
end:23      1369          else
start:24      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:24      1376          end-if
1377        end-if
end:23      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:22      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:21      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:22      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:23      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:24      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:25      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:24      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:25      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:24      1388          else
start:25      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:26      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:25      1391          end-if
1392        end-if
end:24      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:25      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:24      1395          end-if
1396        else
end:23      1396          else
start:24      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:24      1403          end-if
1404        end-if
end:23      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:22      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:21      1351          end-if
1352        end-perform
end:20      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:20      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
end:19      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
994        when w0n99-opt-typ-sr
end:18      994          when w0n99-opt-typ-sr
start:19      994          when w0n99-opt-typ-sr
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
start:20      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:21      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:20      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:21      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:23      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:22      2830          else
start:23      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:22      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:22      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:21      1125          go to 0n99-1590-cvgu-browse-x
start:22      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:21      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:22      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:23      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:25      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:28      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:27      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:27      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:25      1591          go to 0n99-3010-stop-win-x
start:26      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:25      1592          end-if
1593        if w0n99-ope-dir-entree
start:26      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:28      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:27      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:28      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:27      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:25      1595          else
start:26      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:27      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:27      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:27      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:25      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:26      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:25      1600          end-if
1601        end-if
end:24      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:22      1133          when w0n99-opt-typ-sl
start:23      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:25      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:28      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:27      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:27      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:25      1702          go to 0n99-3020-stop-loss-x
start:26      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:25      1703          end-if
1704        if w0n99-ope-dir-entree
start:26      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:28      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:27      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:28      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:27      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:25      1706          else
start:26      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:27      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:27      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:27      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:25      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:26      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:25      1711          end-if
1712        end-if
end:24      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:22      1135          when w0n99-opt-typ-sr
start:23      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:25      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:28      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:27      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:27      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:25      1813          go to 0n99-3030-stop-lr-x
start:26      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:25      1814          end-if
1815        if w0n99-ope-dir-entree
start:26      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:28      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:27      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:28      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:27      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:25      1817          else
start:26      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:27      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:27      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:27      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:25      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:26      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:25      1822          end-if
1823        end-if
end:24      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:22      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:21      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:20      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:21      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:22      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:21      1906          end-if
1907        if w0n99-fl-abe-y
start:22      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:21      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:20      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
end:19      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
996        when w0n99-opt-typ-sl
end:18      996          when w0n99-opt-typ-sl
start:19      996          when w0n99-opt-typ-sl
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
start:20      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:21      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:20      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:21      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:23      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:22      2830          else
start:23      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:22      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:22      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:21      1125          go to 0n99-1590-cvgu-browse-x
start:22      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:21      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:22      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:23      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:25      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:28      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:27      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:27      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:25      1591          go to 0n99-3010-stop-win-x
start:26      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:25      1592          end-if
1593        if w0n99-ope-dir-entree
start:26      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:28      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:27      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:28      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:27      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:25      1595          else
start:26      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:27      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:27      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:27      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:25      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:26      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:25      1600          end-if
1601        end-if
end:24      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:22      1133          when w0n99-opt-typ-sl
start:23      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:25      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:28      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:27      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:27      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:25      1702          go to 0n99-3020-stop-loss-x
start:26      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:25      1703          end-if
1704        if w0n99-ope-dir-entree
start:26      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:28      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:27      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:28      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:27      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:25      1706          else
start:26      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:27      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:27      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:27      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:25      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:26      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:25      1711          end-if
1712        end-if
end:24      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:22      1135          when w0n99-opt-typ-sr
start:23      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:25      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:28      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:27      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:27      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:25      1813          go to 0n99-3030-stop-lr-x
start:26      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:25      1814          end-if
1815        if w0n99-ope-dir-entree
start:26      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:28      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:27      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:28      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:27      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:25      1817          else
start:26      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:27      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:27      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:27      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:25      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:26      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:25      1822          end-if
1823        end-if
end:24      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:22      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:21      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:20      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:21      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:22      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:21      1795          end-if
1796        if w0n99-fl-abe-y
start:22      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:21      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:20      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
end:19      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
998        when w0n99-opt-typ-sw
end:18      998          when w0n99-opt-typ-sw
start:19      998          when w0n99-opt-typ-sw
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
start:20      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:21      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:20      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:21      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:23      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:22      2830          else
start:23      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:22      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:22      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:21      1125          go to 0n99-1590-cvgu-browse-x
start:22      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:21      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:22      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:23      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:25      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:28      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:27      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:27      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:25      1591          go to 0n99-3010-stop-win-x
start:26      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:25      1592          end-if
1593        if w0n99-ope-dir-entree
start:26      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:28      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:27      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:28      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:27      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:25      1595          else
start:26      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:27      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:27      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:27      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:25      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:26      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:25      1600          end-if
1601        end-if
end:24      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:22      1133          when w0n99-opt-typ-sl
start:23      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:25      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:28      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:27      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:27      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:25      1702          go to 0n99-3020-stop-loss-x
start:26      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:25      1703          end-if
1704        if w0n99-ope-dir-entree
start:26      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:28      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:27      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:28      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:27      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:25      1706          else
start:26      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:27      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:27      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:27      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:25      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:26      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:25      1711          end-if
1712        end-if
end:24      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:22      1135          when w0n99-opt-typ-sr
start:23      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:25      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:28      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:27      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:27      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:25      1813          go to 0n99-3030-stop-lr-x
start:26      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:25      1814          end-if
1815        if w0n99-ope-dir-entree
start:26      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:28      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:27      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:28      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:27      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:25      1817          else
start:26      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:27      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:27      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:27      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:25      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:26      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:25      1822          end-if
1823        end-if
end:24      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:22      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:21      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:20      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:21      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:22      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:21      1684          end-if
1685        if w0n99-fl-abe-y
start:22      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:21      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:20      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
end:19      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1000        when w0n99-opt-typ-ip
end:18      1000          when w0n99-opt-typ-ip
start:19      1000          when w0n99-opt-typ-ip
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
start:20      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:21      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:23      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:25      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:24      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:25      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:24      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:25      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:24      1549          end-if
1550        else
end:23      1550          else
start:24      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:24      1558          end-if
1559        end-if
end:23      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:22      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:21      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:22      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:23      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:24      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:25      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:24      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:25      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:24      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:25      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:24      1573          end-if
1574        else
end:23      1574          else
start:24      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:24      1582          end-if
1583        end-if
end:23      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:22      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:21      1526          end-if
1527        end-perform
end:20      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:20      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
end:19      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1002        when other
end:18      1002          when other
start:19      1002          when other
1003        go to 0n99-1570-mod-fin-opt-x
end:18      1003          go to 0n99-1570-mod-fin-opt-x
start:19      1003          go to 0n99-1570-mod-fin-opt-x
1004        end-evaluate
end:18      1004          end-evaluate
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
start:19      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
2251    0o40-1000-record-fopt-info.
2252        set l0o40-record-fopt-info to true
2253        perform 0o40-0000-call thru 0o40-0000-call-x
start:20      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2253        perform 0o40-0000-call thru 0o40-0000-call-x
end:19      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2254        continue.
2255    0o40-1000-record-fopt-info-x.
2256        exit.
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
end:18      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
1006        if l0o40-retrn-error or w0n99-cpb-csq-blk
start:19      1006          if l0o40-retrn-error or w0n99-cpb-csq-blk
1007        set l0n99-retrn-error to true
1008        move 'sc0n990012' to wglob-msg-ref-info
1009        move rpol-pol-id to wglob-msg-parm(1)
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:20      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:21      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:20      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:19      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1011        go to 0n99-1570-mod-fin-opt-x
end:18      1011          go to 0n99-1570-mod-fin-opt-x
start:19      1011          go to 0n99-1570-mod-fin-opt-x
1012        end-if
end:18      1012          end-if
1013        move w0n99-transaction-id to wglob-transaction-id
1014        set w0n99-lapse-flag-n to true
1015        perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
start:19      1015          perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
1016        if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
start:20      1016          if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
1017        set w0n99-lapse-flag-y to true
1018        end-if
end:19      1018          end-if
1019        end-perform
end:18      1019          end-perform
1020        if w0n99-lapse-flag-y
start:19      1020          if w0n99-lapse-flag-y
1021        initialize w0n99-lapse-supp-ind
1022        if w0n99-abe-fnd-dbt-y
start:20      1022          if w0n99-abe-fnd-dbt-y
1023        if w0n99-mltpl-dbt-fnd-y
start:21      1023          if w0n99-mltpl-dbt-fnd-y
1024        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:22      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:23      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:24      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:23      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:24      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:23      895          go to 0n99-1540-lapse-support-x
start:24      895          go to 0n99-1540-lapse-support-x
896        end-if
end:23      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:22      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:23      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:24      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:25      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:24      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:23      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:24      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:23      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:24      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:23      1971          when w0n99-opt-rh-optrpp
start:24      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:23      1973          when w0n99-opt-rh-optecr
start:24      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:25      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:24      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:25      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:24      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:23      1980          when w0n99-opt-rh-optsl1
start:24      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:25      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:24      1983          else
start:25      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:24      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:23      1986          when w0n99-opt-rh-optsw1
start:24      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:25      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:24      1989          else
start:25      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:24      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:23      1992          when w0n99-opt-rh-optsr1
start:24      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:25      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:24      1995          else
start:25      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:24      1997          end-if
1998        when w0n99-opt-rh-optip1
end:23      1998          when w0n99-opt-rh-optip1
start:24      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:25      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:24      2001          else
start:25      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:24      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:23      2004          when w0n99-opt-rh-optcl1
start:24      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:25      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:24      2007          else
start:25      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:24      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:23      2010          when w0n99-opt-rh-optsp1
start:24      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:25      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:24      2013          else
start:25      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:24      2015          end-if
2016        when w0n99-opt-rh-optra1
end:23      2016          when w0n99-opt-rh-optra1
start:24      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:23      2018          when other
start:24      2018          when other
2019        continue
2020        end-evaluate
end:23      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:24      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:25      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:24      3201          else
start:25      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:24      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:25      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:24      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:23      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:22      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:23      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:22      902          go to 0n99-1540-lapse-support-x
start:23      902          go to 0n99-1540-lapse-support-x
903        end-if
end:22      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:21      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1026        if l0n99-retrn-error
start:22      1026          if l0n99-retrn-error
1027        go to 0n99-1570-mod-fin-opt-x
end:21      1027          go to 0n99-1570-mod-fin-opt-x
start:22      1027          go to 0n99-1570-mod-fin-opt-x
1028        end-if
end:21      1028          end-if
1029        else
end:20      1029          else
start:21      1029          else
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:22      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:23      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:24      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:23      932          go to 0n99-1550-lapse-fin-opt-x
start:24      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:23      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:22      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:21      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1031        if l0n99-retrn-error
start:22      1031          if l0n99-retrn-error
1032        go to 0n99-1570-mod-fin-opt-x
end:21      1032          go to 0n99-1570-mod-fin-opt-x
start:22      1032          go to 0n99-1570-mod-fin-opt-x
1033        end-if
end:21      1033          end-if
1034        end-if
end:20      1034          end-if
1035        end-if
end:19      1035          end-if
1036        if w0n99-abe-fnd-rcp-y
start:20      1036          if w0n99-abe-fnd-rcp-y
1037        if w0n99-mltpl-rcp-fnd-y
start:21      1037          if w0n99-mltpl-rcp-fnd-y
1038        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:22      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:23      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:24      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:23      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:24      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:23      895          go to 0n99-1540-lapse-support-x
start:24      895          go to 0n99-1540-lapse-support-x
896        end-if
end:23      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:22      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:23      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:24      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:25      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:24      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:23      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:24      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:23      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:24      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:23      1971          when w0n99-opt-rh-optrpp
start:24      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:23      1973          when w0n99-opt-rh-optecr
start:24      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:25      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:24      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:25      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:24      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:23      1980          when w0n99-opt-rh-optsl1
start:24      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:25      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:24      1983          else
start:25      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:24      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:23      1986          when w0n99-opt-rh-optsw1
start:24      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:25      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:24      1989          else
start:25      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:24      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:23      1992          when w0n99-opt-rh-optsr1
start:24      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:25      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:24      1995          else
start:25      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:24      1997          end-if
1998        when w0n99-opt-rh-optip1
end:23      1998          when w0n99-opt-rh-optip1
start:24      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:25      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:24      2001          else
start:25      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:24      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:23      2004          when w0n99-opt-rh-optcl1
start:24      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:25      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:24      2007          else
start:25      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:24      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:23      2010          when w0n99-opt-rh-optsp1
start:24      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:25      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:24      2013          else
start:25      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:24      2015          end-if
2016        when w0n99-opt-rh-optra1
end:23      2016          when w0n99-opt-rh-optra1
start:24      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:23      2018          when other
start:24      2018          when other
2019        continue
2020        end-evaluate
end:23      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:24      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:25      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:24      3201          else
start:25      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:24      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:25      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:24      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:23      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:22      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:23      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:22      902          go to 0n99-1540-lapse-support-x
start:23      902          go to 0n99-1540-lapse-support-x
903        end-if
end:22      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:21      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1040        if l0n99-retrn-error
start:22      1040          if l0n99-retrn-error
1041        go to 0n99-1570-mod-fin-opt-x
end:21      1041          go to 0n99-1570-mod-fin-opt-x
start:22      1041          go to 0n99-1570-mod-fin-opt-x
1042        end-if
end:21      1042          end-if
1043        else
end:20      1043          else
start:21      1043          else
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:22      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:23      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:24      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:23      932          go to 0n99-1550-lapse-fin-opt-x
start:24      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:23      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:22      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:21      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1045        if l0n99-retrn-error
start:22      1045          if l0n99-retrn-error
1046        go to 0n99-1570-mod-fin-opt-x
end:21      1046          go to 0n99-1570-mod-fin-opt-x
start:22      1046          go to 0n99-1570-mod-fin-opt-x
1047        end-if
end:21      1047          end-if
1048        end-if
end:20      1048          end-if
1049        end-if
end:19      1049          end-if
1050        if w0n99-abe-fnd-tgt-y
start:20      1050          if w0n99-abe-fnd-tgt-y
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:21      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:22      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:22      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:23      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:22      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:23      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:22      932          go to 0n99-1550-lapse-fin-opt-x
start:23      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:22      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:21      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:20      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1052        if l0n99-retrn-error
start:21      1052          if l0n99-retrn-error
1053        go to 0n99-1570-mod-fin-opt-x
end:20      1053          go to 0n99-1570-mod-fin-opt-x
start:21      1053          go to 0n99-1570-mod-fin-opt-x
1054        end-if
end:20      1054          end-if
1055        end-if
end:19      1055          end-if
1056        end-if
end:18      1056          end-if
1057        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
start:19      1057          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
1058        set w0n99-ref-amt-updt-y to true
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
start:20      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:21      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:20      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:21      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:22      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:21      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:20      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:21      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
end:20      1159          go to 0n99-1600-mod-ref-amt-x
start:21      1159          go to 0n99-1600-mod-ref-amt-x
1160        end-if
end:20      1160          end-if
1161        compute w0n99-fnd-ref-amt = l0o37-fnd-ref-amt + l0n99-abe-cv-amt
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:21      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:20      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1163        set l0o37-rqst-calc to true
1164        set l0o37-ref-val-calc-ind-t to true
1165        move rpol-pol-id to l0o37-pol-id
1166        move l0n99-abn-fnd-id to l0o37-fnd-id
1167        move w0n99-opt-rh-id to l0o37-opt-rh-id
1168        move w0n99-abn-opt-num to l0o37-opt-num
1169        move w0n99-stp-cd-5 to l0o37-stp-cd
1170        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1171        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1172        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:21      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:22      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:21      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:20      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1174        if not l0o37-retrn-ok
start:21      1174          if not l0o37-retrn-ok
1175        set l0n99-retrn-error to true
1176        go to 0n99-1600-mod-ref-amt-x
end:20      1176          go to 0n99-1600-mod-ref-amt-x
start:21      1176          go to 0n99-1600-mod-ref-amt-x
1177        end-if
end:20      1177          end-if
1178        continue.
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
end:19      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1060        end-if
end:18      1060          end-if
1061        if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
start:19      1061          if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
start:20      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1071    0n99-1580-mod-ref-val.
1072        if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
start:21      1072          if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
1073        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
start:22      1073          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
1074        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0n99-abn-cv-amt
1075        end-if
end:21      1075          end-if
1076        if w0n99-abe-fnd-dbt-y
start:22      1076          if w0n99-abe-fnd-dbt-y
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:23      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:22      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1078        set l0o37-rqst-calc to true
1079        set l0o37-ref-val-calc-ind-t to true
1080        move rpol-pol-id to l0o37-pol-id
1081        move l0n99-abn-fnd-id to l0o37-fnd-id
1082        move w0n99-opt-rh-id to l0o37-opt-rh-id
1083        move w0n99-abn-opt-num to l0o37-opt-num
1084        move l0o40-stp-cd to l0o37-stp-cd
1085        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1086        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1087        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:23      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:24      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:23      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:22      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1089        if not l0o37-retrn-ok or w0n99-cpb-csq-blk
start:23      1089          if not l0o37-retrn-ok or w0n99-cpb-csq-blk
1090        set l0n99-retrn-error to true
1091        move 'sc0n990015' to wglob-msg-ref-info
1092        move rpol-pol-id to wglob-msg-parm(1)
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:24      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:23      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1094        go to 0n99-1580-mod-ref-val-x
end:22      1094          go to 0n99-1580-mod-ref-val-x
start:23      1094          go to 0n99-1580-mod-ref-val-x
1095        end-if
end:22      1095          end-if
1096        end-if
end:21      1096          end-if
1097        end-if
end:20      1097          end-if
1098        continue.
1099    0n99-1580-mod-ref-val-x.
1100        exit.
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
end:19      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1063        end-if
end:18      1063          end-if
1064        if l0n99-retrn-ok
start:19      1064          if l0n99-retrn-ok
1065        set w0n99-prcs-gevt-y to true
1066        end-if
end:18      1066          end-if
1067        end-if
end:17      1067          end-if
1068        continue.
1069    0n99-1570-mod-fin-opt-x.
1070        exit.
819        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
end:16      819          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
820        else
end:15      820          else
start:16      820          else
821        if w0n99-mltpl-dbt-fnd-y
start:17      821          if w0n99-mltpl-dbt-fnd-y
822        move l0n99-abe-fnd-id to w0n99-term-fnd-id
823        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:18      823          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:19      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:20      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:19      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:20      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:21      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:20      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:19      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:20      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:19      895          go to 0n99-1540-lapse-support-x
start:20      895          go to 0n99-1540-lapse-support-x
896        end-if
end:19      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:18      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:19      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:20      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:21      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:22      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:23      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:22      3336          else
start:23      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:22      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:23      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:22      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:21      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:20      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:19      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:20      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:19      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:20      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:19      1971          when w0n99-opt-rh-optrpp
start:20      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:19      1973          when w0n99-opt-rh-optecr
start:20      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:21      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:20      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:21      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:20      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:19      1980          when w0n99-opt-rh-optsl1
start:20      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:21      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:20      1983          else
start:21      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:20      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:19      1986          when w0n99-opt-rh-optsw1
start:20      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:21      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:20      1989          else
start:21      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:20      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:19      1992          when w0n99-opt-rh-optsr1
start:20      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:21      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:20      1995          else
start:21      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:20      1997          end-if
1998        when w0n99-opt-rh-optip1
end:19      1998          when w0n99-opt-rh-optip1
start:20      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:21      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:20      2001          else
start:21      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:20      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:19      2004          when w0n99-opt-rh-optcl1
start:20      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:21      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:20      2007          else
start:21      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:20      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:19      2010          when w0n99-opt-rh-optsp1
start:20      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:21      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:20      2013          else
start:21      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:20      2015          end-if
2016        when w0n99-opt-rh-optra1
end:19      2016          when w0n99-opt-rh-optra1
start:20      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:19      2018          when other
start:20      2018          when other
2019        continue
2020        end-evaluate
end:19      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:20      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:21      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:20      3201          else
start:21      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:20      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:21      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:22      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:23      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:22      3336          else
start:23      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:22      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:23      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:22      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:21      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:20      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:19      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:18      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:19      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:18      902          go to 0n99-1540-lapse-support-x
start:19      902          go to 0n99-1540-lapse-support-x
903        end-if
end:18      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
823        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:17      823          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
824        else
end:16      824          else
start:17      824          else
825        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:18      825          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:19      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:20      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:19      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:20      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:21      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:20      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:19      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:20      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:19      932          go to 0n99-1550-lapse-fin-opt-x
start:20      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:19      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:18      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
825        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:17      825          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
826        end-if
end:16      826          end-if
827        end-if
end:15      827          end-if
828        end-if
end:14      828          end-if
829        continue.
830    0n99-1510-abe-fnd-dbt-x.
831        exit.
832    0n99-1520-abe-fnd-rcp.
833        if w0n99-abn-fnd-dbt-y
start:15      833          if w0n99-abn-fnd-dbt-y
834        if w0n99-mltpl-rcp-fnd-y
start:16      834          if w0n99-mltpl-rcp-fnd-y
835        move l0n99-abe-fnd-id to w0n99-term-fnd-id
836        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:17      836          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:18      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:19      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:18      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:19      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:20      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:19      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:18      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:19      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:18      895          go to 0n99-1540-lapse-support-x
start:19      895          go to 0n99-1540-lapse-support-x
896        end-if
end:18      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:17      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:18      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:19      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:20      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:21      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:22      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:21      3336          else
start:22      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:21      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:22      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:21      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:20      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:19      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:18      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:19      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:18      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:19      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:18      1971          when w0n99-opt-rh-optrpp
start:19      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:18      1973          when w0n99-opt-rh-optecr
start:19      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:20      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:19      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:20      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:19      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:18      1980          when w0n99-opt-rh-optsl1
start:19      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:20      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:19      1983          else
start:20      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:19      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:18      1986          when w0n99-opt-rh-optsw1
start:19      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:20      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:19      1989          else
start:20      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:19      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:18      1992          when w0n99-opt-rh-optsr1
start:19      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:20      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:19      1995          else
start:20      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:19      1997          end-if
1998        when w0n99-opt-rh-optip1
end:18      1998          when w0n99-opt-rh-optip1
start:19      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:20      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:19      2001          else
start:20      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:19      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:18      2004          when w0n99-opt-rh-optcl1
start:19      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:20      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:19      2007          else
start:20      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:19      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:18      2010          when w0n99-opt-rh-optsp1
start:19      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:20      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:19      2013          else
start:20      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:19      2015          end-if
2016        when w0n99-opt-rh-optra1
end:18      2016          when w0n99-opt-rh-optra1
start:19      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:18      2018          when other
start:19      2018          when other
2019        continue
2020        end-evaluate
end:18      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:19      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:20      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:19      3201          else
start:20      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:19      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:20      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:21      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:22      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:21      3336          else
start:22      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:21      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:22      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:21      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:20      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:19      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:18      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:17      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:18      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:17      902          go to 0n99-1540-lapse-support-x
start:18      902          go to 0n99-1540-lapse-support-x
903        end-if
end:17      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
836        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:16      836          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
837        else
end:15      837          else
start:16      837          else
838        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:17      838          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:18      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:19      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:18      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:19      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:20      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:19      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:18      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:19      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:18      932          go to 0n99-1550-lapse-fin-opt-x
start:19      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:18      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:17      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
838        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:16      838          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
839        end-if
end:15      839          end-if
840        else
end:14      840          else
start:15      840          else
841        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
start:16      841          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
939    0n99-1560-check-abn-support.
940        set w0n99-abn-fnd-avl-n to true
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
start:17      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
end:16      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
942        move rpol-plan-id to l0o34-plan-id
943        move rpol-cd-opt-ofp-act to l0o34-cd-opt-ofp-act
944        move l0o33-opt-eff-dt(w0n99-one) to l0o34-opt-eff-dt
945        move w0n99-opt-rh-id to l0o34-opt-rh-id
946        move l0o33-opt-sign-dt(w0n99-one) to l0o34-opt-sign-dt
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
start:17      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:18      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:17      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
end:16      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
948        if not l0o34-retrn-ok
start:17      948          if not l0o34-retrn-ok
949        set l0n99-retrn-error to true
950        go to 0n99-1560-check-abn-support-x
end:16      950          go to 0n99-1560-check-abn-support-x
start:17      950          go to 0n99-1560-check-abn-support-x
951        end-if
end:16      951          end-if
952        perform varying j from 1 by 1 until j > w0n99-two
start:17      952          perform varying j from 1 by 1 until j > w0n99-two
953        perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
start:18      953          perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
954        if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
start:19      954          if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
955        set w0n99-abn-fnd-avl-y to true
956        end-if
end:18      956          end-if
957        end-perform
end:17      957          end-perform
958        end-perform
end:16      958          end-perform
959        continue.
960    0n99-1560-check-abn-support-x.
961        exit.
841        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
end:15      841          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
842        if w0n99-abn-fnd-avl-y
start:16      842          if w0n99-abn-fnd-avl-y
843        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
start:17      843          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
962    0n99-1570-mod-fin-opt.
963        initialize w0n99-fnd-ope-dir-cd
964        initialize w0n99-fnd-rel-rt
965        initialize w0n99-fnd-pct
966        initialize w0n99-fnd-ref-amt
967        initialize w0n99-fnd-amt
968        move w0n99-one to w0n99-fnd-num
969        if l0n99-chk-admsblty-mod
start:18      969          if l0n99-chk-admsblty-mod
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
start:19      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
end:18      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
971        set l0o40-record-fopt-info to true
972        move rpol-pol-id to l0o40-pol-id
973        move rpol-plan-id to l0o40-plan-id
974        move w0n99-opt-rh-id to l0o40-opt-rh-id
975        move rpol-cd-opt-ofp-act to l0o40-cd-opt-ofp-act
976        move rpol-pol-base-cvg-num to l0o40-cvg-num-n
977        move l0o34-opt-typ-cd to w0n99-opt-typ-cd
978        move l0n99-ope-eff-dt to l0o40-ref-eff-dt
979        move l0n99-ope-eff-dt to l0o40-da-fcn-pol-cvt
980        move l0n99-ope-eff-dt to l0o40-db-fcn-pol
981        move l0o33-recv-whole-file-dt(w0n99-one) to l0o40-recv-whole-file-dt
982        move l0n99-ost-ind to l0o40-ost-ind
983        move wglob-transaction-id to w0n99-transaction-id
984        move l0o33-opt-nxt-actv-dt(w0n99-one) to l0o40-opt-nxt-actv-dt
985        set l0o40-stp-08 to true
986        set wglob-transaction-mdof to true
987        evaluate true
start:19      988          when w0n99-opt-typ-cl
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
start:20      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:21      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:23      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:25      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:24      1226          end-if
1227        else
end:23      1227          else
start:24      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:24      1234          end-if
1235        end-if
end:23      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:22      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:21      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:22      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:23      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:24      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:25      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:24      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:25      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:24      1246          else
start:25      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:26      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:25      1249          end-if
1250        end-if
end:24      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:25      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:24      1253          end-if
1254        else
end:23      1254          else
start:24      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:24      1261          end-if
1262        end-if
end:23      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:22      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:21      1209          end-if
1210        end-perform
end:20      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:20      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
end:19      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
990        when w0n99-opt-typ-re
end:18      990          when w0n99-opt-typ-re
start:19      990          when w0n99-opt-typ-re
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
start:20      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:21      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:23      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:25      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:24      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:25      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:24      1310          end-if
1311        else
end:23      1311          else
start:24      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:24      1318          end-if
1319        end-if
end:23      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:22      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:21      1291          end-if
1292        end-perform
end:20      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:20      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
end:19      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
992        when w0n99-opt-typ-sp
end:18      992          when w0n99-opt-typ-sp
start:19      992          when w0n99-opt-typ-sp
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
start:20      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:21      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:23      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:25      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:24      1368          end-if
1369        else
end:23      1369          else
start:24      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:24      1376          end-if
1377        end-if
end:23      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:22      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:21      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:22      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:23      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:24      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:25      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:24      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:25      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:24      1388          else
start:25      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:26      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:25      1391          end-if
1392        end-if
end:24      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:25      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:24      1395          end-if
1396        else
end:23      1396          else
start:24      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:24      1403          end-if
1404        end-if
end:23      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:22      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:21      1351          end-if
1352        end-perform
end:20      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:20      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
end:19      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
994        when w0n99-opt-typ-sr
end:18      994          when w0n99-opt-typ-sr
start:19      994          when w0n99-opt-typ-sr
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
start:20      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:21      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:20      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:21      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:23      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:22      2830          else
start:23      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:22      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:22      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:21      1125          go to 0n99-1590-cvgu-browse-x
start:22      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:21      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:22      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:23      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:25      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:28      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:27      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:27      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:25      1591          go to 0n99-3010-stop-win-x
start:26      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:25      1592          end-if
1593        if w0n99-ope-dir-entree
start:26      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:28      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:27      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:28      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:27      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:25      1595          else
start:26      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:27      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:27      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:27      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:25      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:26      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:25      1600          end-if
1601        end-if
end:24      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:22      1133          when w0n99-opt-typ-sl
start:23      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:25      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:28      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:27      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:27      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:25      1702          go to 0n99-3020-stop-loss-x
start:26      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:25      1703          end-if
1704        if w0n99-ope-dir-entree
start:26      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:28      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:27      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:28      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:27      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:25      1706          else
start:26      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:27      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:27      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:27      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:25      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:26      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:25      1711          end-if
1712        end-if
end:24      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:22      1135          when w0n99-opt-typ-sr
start:23      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:25      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:28      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:27      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:27      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:25      1813          go to 0n99-3030-stop-lr-x
start:26      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:25      1814          end-if
1815        if w0n99-ope-dir-entree
start:26      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:28      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:27      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:28      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:27      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:25      1817          else
start:26      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:27      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:27      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:27      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:25      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:26      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:25      1822          end-if
1823        end-if
end:24      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:22      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:21      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:20      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:21      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:22      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:21      1906          end-if
1907        if w0n99-fl-abe-y
start:22      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:21      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:20      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
end:19      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
996        when w0n99-opt-typ-sl
end:18      996          when w0n99-opt-typ-sl
start:19      996          when w0n99-opt-typ-sl
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
start:20      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:21      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:20      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:21      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:23      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:22      2830          else
start:23      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:22      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:22      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:21      1125          go to 0n99-1590-cvgu-browse-x
start:22      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:21      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:22      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:23      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:25      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:28      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:27      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:27      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:25      1591          go to 0n99-3010-stop-win-x
start:26      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:25      1592          end-if
1593        if w0n99-ope-dir-entree
start:26      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:28      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:27      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:28      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:27      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:25      1595          else
start:26      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:27      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:27      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:27      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:25      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:26      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:25      1600          end-if
1601        end-if
end:24      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:22      1133          when w0n99-opt-typ-sl
start:23      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:25      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:28      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:27      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:27      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:25      1702          go to 0n99-3020-stop-loss-x
start:26      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:25      1703          end-if
1704        if w0n99-ope-dir-entree
start:26      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:28      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:27      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:28      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:27      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:25      1706          else
start:26      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:27      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:27      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:27      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:25      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:26      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:25      1711          end-if
1712        end-if
end:24      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:22      1135          when w0n99-opt-typ-sr
start:23      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:25      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:28      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:27      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:27      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:25      1813          go to 0n99-3030-stop-lr-x
start:26      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:25      1814          end-if
1815        if w0n99-ope-dir-entree
start:26      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:28      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:27      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:28      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:27      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:25      1817          else
start:26      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:27      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:27      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:27      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:25      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:26      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:25      1822          end-if
1823        end-if
end:24      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:22      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:21      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:20      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:21      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:22      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:21      1795          end-if
1796        if w0n99-fl-abe-y
start:22      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:21      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:20      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
end:19      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
998        when w0n99-opt-typ-sw
end:18      998          when w0n99-opt-typ-sw
start:19      998          when w0n99-opt-typ-sw
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
start:20      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:21      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:20      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:21      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:23      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:22      2830          else
start:23      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:22      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:22      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:21      1125          go to 0n99-1590-cvgu-browse-x
start:22      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:21      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:22      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:23      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:25      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:28      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:27      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:27      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:25      1591          go to 0n99-3010-stop-win-x
start:26      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:25      1592          end-if
1593        if w0n99-ope-dir-entree
start:26      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:28      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:27      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:28      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:27      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:25      1595          else
start:26      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:27      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:27      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:27      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:25      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:26      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:25      1600          end-if
1601        end-if
end:24      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:22      1133          when w0n99-opt-typ-sl
start:23      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:25      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:28      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:27      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:27      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:25      1702          go to 0n99-3020-stop-loss-x
start:26      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:25      1703          end-if
1704        if w0n99-ope-dir-entree
start:26      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:28      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:27      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:28      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:27      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:25      1706          else
start:26      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:27      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:27      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:27      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:25      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:26      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:25      1711          end-if
1712        end-if
end:24      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:22      1135          when w0n99-opt-typ-sr
start:23      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:25      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:28      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:27      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:27      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:25      1813          go to 0n99-3030-stop-lr-x
start:26      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:25      1814          end-if
1815        if w0n99-ope-dir-entree
start:26      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:28      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:27      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:28      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:27      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:25      1817          else
start:26      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:27      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:27      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:27      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:25      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:26      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:25      1822          end-if
1823        end-if
end:24      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:22      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:21      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:20      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:21      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:22      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:21      1684          end-if
1685        if w0n99-fl-abe-y
start:22      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:21      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:20      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
end:19      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1000        when w0n99-opt-typ-ip
end:18      1000          when w0n99-opt-typ-ip
start:19      1000          when w0n99-opt-typ-ip
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
start:20      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:21      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:23      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:25      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:24      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:25      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:24      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:25      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:24      1549          end-if
1550        else
end:23      1550          else
start:24      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:24      1558          end-if
1559        end-if
end:23      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:22      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:21      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:22      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:23      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:24      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:25      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:24      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:25      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:24      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:25      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:24      1573          end-if
1574        else
end:23      1574          else
start:24      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:24      1582          end-if
1583        end-if
end:23      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:22      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:21      1526          end-if
1527        end-perform
end:20      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:20      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
end:19      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1002        when other
end:18      1002          when other
start:19      1002          when other
1003        go to 0n99-1570-mod-fin-opt-x
end:18      1003          go to 0n99-1570-mod-fin-opt-x
start:19      1003          go to 0n99-1570-mod-fin-opt-x
1004        end-evaluate
end:18      1004          end-evaluate
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
start:19      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
2251    0o40-1000-record-fopt-info.
2252        set l0o40-record-fopt-info to true
2253        perform 0o40-0000-call thru 0o40-0000-call-x
start:20      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2253        perform 0o40-0000-call thru 0o40-0000-call-x
end:19      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2254        continue.
2255    0o40-1000-record-fopt-info-x.
2256        exit.
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
end:18      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
1006        if l0o40-retrn-error or w0n99-cpb-csq-blk
start:19      1006          if l0o40-retrn-error or w0n99-cpb-csq-blk
1007        set l0n99-retrn-error to true
1008        move 'sc0n990012' to wglob-msg-ref-info
1009        move rpol-pol-id to wglob-msg-parm(1)
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:20      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:21      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:20      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:19      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1011        go to 0n99-1570-mod-fin-opt-x
end:18      1011          go to 0n99-1570-mod-fin-opt-x
start:19      1011          go to 0n99-1570-mod-fin-opt-x
1012        end-if
end:18      1012          end-if
1013        move w0n99-transaction-id to wglob-transaction-id
1014        set w0n99-lapse-flag-n to true
1015        perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
start:19      1015          perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
1016        if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
start:20      1016          if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
1017        set w0n99-lapse-flag-y to true
1018        end-if
end:19      1018          end-if
1019        end-perform
end:18      1019          end-perform
1020        if w0n99-lapse-flag-y
start:19      1020          if w0n99-lapse-flag-y
1021        initialize w0n99-lapse-supp-ind
1022        if w0n99-abe-fnd-dbt-y
start:20      1022          if w0n99-abe-fnd-dbt-y
1023        if w0n99-mltpl-dbt-fnd-y
start:21      1023          if w0n99-mltpl-dbt-fnd-y
1024        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:22      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:23      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:24      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:23      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:24      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:23      895          go to 0n99-1540-lapse-support-x
start:24      895          go to 0n99-1540-lapse-support-x
896        end-if
end:23      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:22      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:23      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:24      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:25      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:24      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:23      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:24      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:23      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:24      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:23      1971          when w0n99-opt-rh-optrpp
start:24      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:23      1973          when w0n99-opt-rh-optecr
start:24      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:25      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:24      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:25      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:24      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:23      1980          when w0n99-opt-rh-optsl1
start:24      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:25      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:24      1983          else
start:25      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:24      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:23      1986          when w0n99-opt-rh-optsw1
start:24      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:25      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:24      1989          else
start:25      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:24      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:23      1992          when w0n99-opt-rh-optsr1
start:24      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:25      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:24      1995          else
start:25      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:24      1997          end-if
1998        when w0n99-opt-rh-optip1
end:23      1998          when w0n99-opt-rh-optip1
start:24      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:25      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:24      2001          else
start:25      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:24      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:23      2004          when w0n99-opt-rh-optcl1
start:24      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:25      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:24      2007          else
start:25      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:24      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:23      2010          when w0n99-opt-rh-optsp1
start:24      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:25      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:24      2013          else
start:25      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:24      2015          end-if
2016        when w0n99-opt-rh-optra1
end:23      2016          when w0n99-opt-rh-optra1
start:24      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:23      2018          when other
start:24      2018          when other
2019        continue
2020        end-evaluate
end:23      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:24      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:25      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:24      3201          else
start:25      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:24      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:25      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:24      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:23      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:22      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:23      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:22      902          go to 0n99-1540-lapse-support-x
start:23      902          go to 0n99-1540-lapse-support-x
903        end-if
end:22      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:21      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1026        if l0n99-retrn-error
start:22      1026          if l0n99-retrn-error
1027        go to 0n99-1570-mod-fin-opt-x
end:21      1027          go to 0n99-1570-mod-fin-opt-x
start:22      1027          go to 0n99-1570-mod-fin-opt-x
1028        end-if
end:21      1028          end-if
1029        else
end:20      1029          else
start:21      1029          else
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:22      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:23      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:24      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:23      932          go to 0n99-1550-lapse-fin-opt-x
start:24      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:23      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:22      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:21      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1031        if l0n99-retrn-error
start:22      1031          if l0n99-retrn-error
1032        go to 0n99-1570-mod-fin-opt-x
end:21      1032          go to 0n99-1570-mod-fin-opt-x
start:22      1032          go to 0n99-1570-mod-fin-opt-x
1033        end-if
end:21      1033          end-if
1034        end-if
end:20      1034          end-if
1035        end-if
end:19      1035          end-if
1036        if w0n99-abe-fnd-rcp-y
start:20      1036          if w0n99-abe-fnd-rcp-y
1037        if w0n99-mltpl-rcp-fnd-y
start:21      1037          if w0n99-mltpl-rcp-fnd-y
1038        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:22      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:23      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:24      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:23      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:24      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:23      895          go to 0n99-1540-lapse-support-x
start:24      895          go to 0n99-1540-lapse-support-x
896        end-if
end:23      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:22      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:23      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:24      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:25      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:24      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:23      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:24      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:23      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:24      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:23      1971          when w0n99-opt-rh-optrpp
start:24      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:23      1973          when w0n99-opt-rh-optecr
start:24      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:25      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:24      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:25      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:24      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:23      1980          when w0n99-opt-rh-optsl1
start:24      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:25      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:24      1983          else
start:25      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:24      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:23      1986          when w0n99-opt-rh-optsw1
start:24      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:25      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:24      1989          else
start:25      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:24      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:23      1992          when w0n99-opt-rh-optsr1
start:24      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:25      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:24      1995          else
start:25      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:24      1997          end-if
1998        when w0n99-opt-rh-optip1
end:23      1998          when w0n99-opt-rh-optip1
start:24      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:25      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:24      2001          else
start:25      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:24      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:23      2004          when w0n99-opt-rh-optcl1
start:24      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:25      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:24      2007          else
start:25      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:24      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:23      2010          when w0n99-opt-rh-optsp1
start:24      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:25      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:24      2013          else
start:25      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:24      2015          end-if
2016        when w0n99-opt-rh-optra1
end:23      2016          when w0n99-opt-rh-optra1
start:24      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:23      2018          when other
start:24      2018          when other
2019        continue
2020        end-evaluate
end:23      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:24      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:25      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:24      3201          else
start:25      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:24      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:25      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:24      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:23      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:22      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:23      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:22      902          go to 0n99-1540-lapse-support-x
start:23      902          go to 0n99-1540-lapse-support-x
903        end-if
end:22      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:21      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1040        if l0n99-retrn-error
start:22      1040          if l0n99-retrn-error
1041        go to 0n99-1570-mod-fin-opt-x
end:21      1041          go to 0n99-1570-mod-fin-opt-x
start:22      1041          go to 0n99-1570-mod-fin-opt-x
1042        end-if
end:21      1042          end-if
1043        else
end:20      1043          else
start:21      1043          else
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:22      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:23      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:24      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:23      932          go to 0n99-1550-lapse-fin-opt-x
start:24      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:23      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:22      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:21      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1045        if l0n99-retrn-error
start:22      1045          if l0n99-retrn-error
1046        go to 0n99-1570-mod-fin-opt-x
end:21      1046          go to 0n99-1570-mod-fin-opt-x
start:22      1046          go to 0n99-1570-mod-fin-opt-x
1047        end-if
end:21      1047          end-if
1048        end-if
end:20      1048          end-if
1049        end-if
end:19      1049          end-if
1050        if w0n99-abe-fnd-tgt-y
start:20      1050          if w0n99-abe-fnd-tgt-y
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:21      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:22      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:22      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:23      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:22      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:23      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:22      932          go to 0n99-1550-lapse-fin-opt-x
start:23      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:22      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:21      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:20      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1052        if l0n99-retrn-error
start:21      1052          if l0n99-retrn-error
1053        go to 0n99-1570-mod-fin-opt-x
end:20      1053          go to 0n99-1570-mod-fin-opt-x
start:21      1053          go to 0n99-1570-mod-fin-opt-x
1054        end-if
end:20      1054          end-if
1055        end-if
end:19      1055          end-if
1056        end-if
end:18      1056          end-if
1057        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
start:19      1057          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
1058        set w0n99-ref-amt-updt-y to true
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
start:20      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:21      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:20      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:21      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:22      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:21      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:20      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:21      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
end:20      1159          go to 0n99-1600-mod-ref-amt-x
start:21      1159          go to 0n99-1600-mod-ref-amt-x
1160        end-if
end:20      1160          end-if
1161        compute w0n99-fnd-ref-amt = l0o37-fnd-ref-amt + l0n99-abe-cv-amt
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:21      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:20      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1163        set l0o37-rqst-calc to true
1164        set l0o37-ref-val-calc-ind-t to true
1165        move rpol-pol-id to l0o37-pol-id
1166        move l0n99-abn-fnd-id to l0o37-fnd-id
1167        move w0n99-opt-rh-id to l0o37-opt-rh-id
1168        move w0n99-abn-opt-num to l0o37-opt-num
1169        move w0n99-stp-cd-5 to l0o37-stp-cd
1170        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1171        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1172        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:21      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:22      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:21      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:20      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1174        if not l0o37-retrn-ok
start:21      1174          if not l0o37-retrn-ok
1175        set l0n99-retrn-error to true
1176        go to 0n99-1600-mod-ref-amt-x
end:20      1176          go to 0n99-1600-mod-ref-amt-x
start:21      1176          go to 0n99-1600-mod-ref-amt-x
1177        end-if
end:20      1177          end-if
1178        continue.
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
end:19      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1060        end-if
end:18      1060          end-if
1061        if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
start:19      1061          if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
start:20      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1071    0n99-1580-mod-ref-val.
1072        if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
start:21      1072          if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
1073        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
start:22      1073          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
1074        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0n99-abn-cv-amt
1075        end-if
end:21      1075          end-if
1076        if w0n99-abe-fnd-dbt-y
start:22      1076          if w0n99-abe-fnd-dbt-y
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:23      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:22      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1078        set l0o37-rqst-calc to true
1079        set l0o37-ref-val-calc-ind-t to true
1080        move rpol-pol-id to l0o37-pol-id
1081        move l0n99-abn-fnd-id to l0o37-fnd-id
1082        move w0n99-opt-rh-id to l0o37-opt-rh-id
1083        move w0n99-abn-opt-num to l0o37-opt-num
1084        move l0o40-stp-cd to l0o37-stp-cd
1085        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1086        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1087        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:23      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:24      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:23      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:22      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1089        if not l0o37-retrn-ok or w0n99-cpb-csq-blk
start:23      1089          if not l0o37-retrn-ok or w0n99-cpb-csq-blk
1090        set l0n99-retrn-error to true
1091        move 'sc0n990015' to wglob-msg-ref-info
1092        move rpol-pol-id to wglob-msg-parm(1)
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:24      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:23      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1094        go to 0n99-1580-mod-ref-val-x
end:22      1094          go to 0n99-1580-mod-ref-val-x
start:23      1094          go to 0n99-1580-mod-ref-val-x
1095        end-if
end:22      1095          end-if
1096        end-if
end:21      1096          end-if
1097        end-if
end:20      1097          end-if
1098        continue.
1099    0n99-1580-mod-ref-val-x.
1100        exit.
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
end:19      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1063        end-if
end:18      1063          end-if
1064        if l0n99-retrn-ok
start:19      1064          if l0n99-retrn-ok
1065        set w0n99-prcs-gevt-y to true
1066        end-if
end:18      1066          end-if
1067        end-if
end:17      1067          end-if
1068        continue.
1069    0n99-1570-mod-fin-opt-x.
1070        exit.
843        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
end:16      843          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
844        else
end:15      844          else
start:16      844          else
845        if w0n99-mltpl-rcp-fnd-y
start:17      845          if w0n99-mltpl-rcp-fnd-y
846        move l0n99-abe-fnd-id to w0n99-term-fnd-id
847        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:18      847          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:19      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:20      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:19      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:20      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:21      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:20      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:19      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:20      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:19      895          go to 0n99-1540-lapse-support-x
start:20      895          go to 0n99-1540-lapse-support-x
896        end-if
end:19      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:18      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:19      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:20      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:21      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:22      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:23      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:22      3336          else
start:23      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:22      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:23      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:22      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:21      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:20      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:19      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:20      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:19      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:20      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:19      1971          when w0n99-opt-rh-optrpp
start:20      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:19      1973          when w0n99-opt-rh-optecr
start:20      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:21      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:20      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:21      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:20      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:19      1980          when w0n99-opt-rh-optsl1
start:20      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:21      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:20      1983          else
start:21      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:20      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:19      1986          when w0n99-opt-rh-optsw1
start:20      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:21      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:20      1989          else
start:21      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:20      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:19      1992          when w0n99-opt-rh-optsr1
start:20      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:21      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:20      1995          else
start:21      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:20      1997          end-if
1998        when w0n99-opt-rh-optip1
end:19      1998          when w0n99-opt-rh-optip1
start:20      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:21      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:20      2001          else
start:21      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:20      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:19      2004          when w0n99-opt-rh-optcl1
start:20      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:21      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:20      2007          else
start:21      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:20      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:19      2010          when w0n99-opt-rh-optsp1
start:20      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:21      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:20      2013          else
start:21      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:20      2015          end-if
2016        when w0n99-opt-rh-optra1
end:19      2016          when w0n99-opt-rh-optra1
start:20      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:19      2018          when other
start:20      2018          when other
2019        continue
2020        end-evaluate
end:19      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:20      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:21      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:20      3201          else
start:21      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:20      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:21      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:22      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:23      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:22      3336          else
start:23      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:22      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:23      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:22      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:21      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:20      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:19      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:18      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:19      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:18      902          go to 0n99-1540-lapse-support-x
start:19      902          go to 0n99-1540-lapse-support-x
903        end-if
end:18      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
847        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:17      847          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
848        else
end:16      848          else
start:17      848          else
849        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:18      849          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:19      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:20      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:19      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:20      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:21      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:20      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:19      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:20      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:19      932          go to 0n99-1550-lapse-fin-opt-x
start:20      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:19      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:18      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
849        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:17      849          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
850        end-if
end:16      850          end-if
851        end-if
end:15      851          end-if
852        end-if
end:14      852          end-if
853        continue.
854    0n99-1520-abe-fnd-rcp-x.
855        exit.
856    0n99-1530-abe-fnd-tgt.
857        if w0n99-abn-fnd-tgt-y
start:15      857          if w0n99-abn-fnd-tgt-y
858        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
start:16      858          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
939    0n99-1560-check-abn-support.
940        set w0n99-abn-fnd-avl-n to true
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
start:17      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
end:16      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
942        move rpol-plan-id to l0o34-plan-id
943        move rpol-cd-opt-ofp-act to l0o34-cd-opt-ofp-act
944        move l0o33-opt-eff-dt(w0n99-one) to l0o34-opt-eff-dt
945        move w0n99-opt-rh-id to l0o34-opt-rh-id
946        move l0o33-opt-sign-dt(w0n99-one) to l0o34-opt-sign-dt
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
start:17      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:18      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:17      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
end:16      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
948        if not l0o34-retrn-ok
start:17      948          if not l0o34-retrn-ok
949        set l0n99-retrn-error to true
950        go to 0n99-1560-check-abn-support-x
end:16      950          go to 0n99-1560-check-abn-support-x
start:17      950          go to 0n99-1560-check-abn-support-x
951        end-if
end:16      951          end-if
952        perform varying j from 1 by 1 until j > w0n99-two
start:17      952          perform varying j from 1 by 1 until j > w0n99-two
953        perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
start:18      953          perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
954        if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
start:19      954          if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
955        set w0n99-abn-fnd-avl-y to true
956        end-if
end:18      956          end-if
957        end-perform
end:17      957          end-perform
958        end-perform
end:16      958          end-perform
959        continue.
960    0n99-1560-check-abn-support-x.
961        exit.
858        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
end:15      858          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
859        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
start:16      859          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
962    0n99-1570-mod-fin-opt.
963        initialize w0n99-fnd-ope-dir-cd
964        initialize w0n99-fnd-rel-rt
965        initialize w0n99-fnd-pct
966        initialize w0n99-fnd-ref-amt
967        initialize w0n99-fnd-amt
968        move w0n99-one to w0n99-fnd-num
969        if l0n99-chk-admsblty-mod
start:17      969          if l0n99-chk-admsblty-mod
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
start:18      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
end:17      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
971        set l0o40-record-fopt-info to true
972        move rpol-pol-id to l0o40-pol-id
973        move rpol-plan-id to l0o40-plan-id
974        move w0n99-opt-rh-id to l0o40-opt-rh-id
975        move rpol-cd-opt-ofp-act to l0o40-cd-opt-ofp-act
976        move rpol-pol-base-cvg-num to l0o40-cvg-num-n
977        move l0o34-opt-typ-cd to w0n99-opt-typ-cd
978        move l0n99-ope-eff-dt to l0o40-ref-eff-dt
979        move l0n99-ope-eff-dt to l0o40-da-fcn-pol-cvt
980        move l0n99-ope-eff-dt to l0o40-db-fcn-pol
981        move l0o33-recv-whole-file-dt(w0n99-one) to l0o40-recv-whole-file-dt
982        move l0n99-ost-ind to l0o40-ost-ind
983        move wglob-transaction-id to w0n99-transaction-id
984        move l0o33-opt-nxt-actv-dt(w0n99-one) to l0o40-opt-nxt-actv-dt
985        set l0o40-stp-08 to true
986        set wglob-transaction-mdof to true
987        evaluate true
start:18      988          when w0n99-opt-typ-cl
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
start:19      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:20      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:21      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:22      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:23      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:24      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:23      1226          end-if
1227        else
end:22      1227          else
start:23      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:24      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:23      1234          end-if
1235        end-if
end:22      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:21      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:20      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:21      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:22      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:23      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:24      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:23      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:24      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:23      1246          else
start:24      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:25      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:24      1249          end-if
1250        end-if
end:23      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:24      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:23      1253          end-if
1254        else
end:22      1254          else
start:23      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:24      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:23      1261          end-if
1262        end-if
end:22      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:21      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:20      1209          end-if
1210        end-perform
end:19      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:20      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:19      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
end:18      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
990        when w0n99-opt-typ-re
end:17      990          when w0n99-opt-typ-re
start:18      990          when w0n99-opt-typ-re
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
start:19      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:20      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:21      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:22      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:23      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:24      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:23      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:24      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:23      1310          end-if
1311        else
end:22      1311          else
start:23      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:24      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:23      1318          end-if
1319        end-if
end:22      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:21      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:20      1291          end-if
1292        end-perform
end:19      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:20      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:19      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
end:18      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
992        when w0n99-opt-typ-sp
end:17      992          when w0n99-opt-typ-sp
start:18      992          when w0n99-opt-typ-sp
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
start:19      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:20      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:21      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:22      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:23      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:24      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:23      1368          end-if
1369        else
end:22      1369          else
start:23      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:24      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:23      1376          end-if
1377        end-if
end:22      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:21      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:20      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:21      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:22      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:23      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:24      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:23      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:24      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:23      1388          else
start:24      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:25      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:24      1391          end-if
1392        end-if
end:23      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:24      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:23      1395          end-if
1396        else
end:22      1396          else
start:23      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:24      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:23      1403          end-if
1404        end-if
end:22      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:21      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:20      1351          end-if
1352        end-perform
end:19      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:20      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:19      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
end:18      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
994        when w0n99-opt-typ-sr
end:17      994          when w0n99-opt-typ-sr
start:18      994          when w0n99-opt-typ-sr
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
start:19      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:20      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:19      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:20      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:22      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:21      2830          else
start:22      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:21      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:23      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:22      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:21      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:20      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:21      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:22      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:21      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:20      1125          go to 0n99-1590-cvgu-browse-x
start:21      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:20      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:23      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:22      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:21      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:20      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:21      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:22      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:24      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:25      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:27      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:27      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:26      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:27      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:26      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:25      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:24      1591          go to 0n99-3010-stop-win-x
start:25      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:24      1592          end-if
1593        if w0n99-ope-dir-entree
start:25      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:27      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:26      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:27      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:26      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:25      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:24      1595          else
start:25      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:27      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:26      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:27      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:26      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:27      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:26      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:25      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:24      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:25      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:24      1600          end-if
1601        end-if
end:23      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:22      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:21      1133          when w0n99-opt-typ-sl
start:22      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:24      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:25      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:27      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:27      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:26      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:27      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:26      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:25      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:24      1702          go to 0n99-3020-stop-loss-x
start:25      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:24      1703          end-if
1704        if w0n99-ope-dir-entree
start:25      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:27      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:26      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:27      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:26      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:25      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:24      1706          else
start:25      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:27      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:26      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:27      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:26      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:27      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:26      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:25      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:24      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:25      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:24      1711          end-if
1712        end-if
end:23      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:22      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:21      1135          when w0n99-opt-typ-sr
start:22      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:24      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:25      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:27      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:27      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:26      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:27      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:26      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:25      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:24      1813          go to 0n99-3030-stop-lr-x
start:25      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:24      1814          end-if
1815        if w0n99-ope-dir-entree
start:25      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:27      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:26      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:27      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:26      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:25      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:24      1817          else
start:25      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:27      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:26      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:27      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:26      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:27      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:26      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:25      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:24      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:25      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:24      1822          end-if
1823        end-if
end:23      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:22      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:21      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:20      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:23      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:22      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:21      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:20      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:19      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:20      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:21      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:20      1906          end-if
1907        if w0n99-fl-abe-y
start:21      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:20      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:19      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
end:18      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
996        when w0n99-opt-typ-sl
end:17      996          when w0n99-opt-typ-sl
start:18      996          when w0n99-opt-typ-sl
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
start:19      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:20      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:19      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:20      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:22      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:21      2830          else
start:22      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:21      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:23      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:22      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:21      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:20      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:21      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:22      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:21      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:20      1125          go to 0n99-1590-cvgu-browse-x
start:21      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:20      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:23      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:22      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:21      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:20      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:21      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:22      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:24      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:25      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:27      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:27      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:26      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:27      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:26      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:25      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:24      1591          go to 0n99-3010-stop-win-x
start:25      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:24      1592          end-if
1593        if w0n99-ope-dir-entree
start:25      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:27      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:26      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:27      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:26      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:25      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:24      1595          else
start:25      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:27      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:26      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:27      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:26      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:27      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:26      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:25      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:24      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:25      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:24      1600          end-if
1601        end-if
end:23      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:22      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:21      1133          when w0n99-opt-typ-sl
start:22      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:24      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:25      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:27      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:27      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:26      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:27      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:26      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:25      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:24      1702          go to 0n99-3020-stop-loss-x
start:25      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:24      1703          end-if
1704        if w0n99-ope-dir-entree
start:25      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:27      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:26      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:27      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:26      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:25      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:24      1706          else
start:25      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:27      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:26      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:27      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:26      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:27      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:26      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:25      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:24      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:25      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:24      1711          end-if
1712        end-if
end:23      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:22      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:21      1135          when w0n99-opt-typ-sr
start:22      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:24      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:25      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:27      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:27      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:26      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:27      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:26      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:25      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:24      1813          go to 0n99-3030-stop-lr-x
start:25      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:24      1814          end-if
1815        if w0n99-ope-dir-entree
start:25      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:27      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:26      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:27      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:26      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:25      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:24      1817          else
start:25      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:27      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:26      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:27      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:26      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:27      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:26      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:25      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:24      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:25      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:24      1822          end-if
1823        end-if
end:23      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:22      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:21      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:20      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:23      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:22      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:21      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:20      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:19      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:20      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:21      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:20      1795          end-if
1796        if w0n99-fl-abe-y
start:21      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:20      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:19      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
end:18      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
998        when w0n99-opt-typ-sw
end:17      998          when w0n99-opt-typ-sw
start:18      998          when w0n99-opt-typ-sw
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
start:19      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:20      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:19      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:20      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:22      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:21      2830          else
start:22      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:21      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:23      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:22      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:21      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:20      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:21      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:22      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:21      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:20      1125          go to 0n99-1590-cvgu-browse-x
start:21      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:20      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:23      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:22      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:21      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:20      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:21      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:22      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:24      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:25      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:27      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:27      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:26      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:27      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:26      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:25      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:24      1591          go to 0n99-3010-stop-win-x
start:25      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:24      1592          end-if
1593        if w0n99-ope-dir-entree
start:25      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:27      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:26      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:27      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:26      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:25      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:24      1595          else
start:25      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:27      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:26      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:27      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:26      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:27      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:26      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:25      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:24      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:25      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:24      1600          end-if
1601        end-if
end:23      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:22      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:21      1133          when w0n99-opt-typ-sl
start:22      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:24      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:25      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:27      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:27      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:26      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:27      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:26      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:25      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:24      1702          go to 0n99-3020-stop-loss-x
start:25      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:24      1703          end-if
1704        if w0n99-ope-dir-entree
start:25      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:27      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:26      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:27      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:26      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:25      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:24      1706          else
start:25      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:27      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:26      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:27      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:26      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:27      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:26      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:25      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:24      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:25      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:24      1711          end-if
1712        end-if
end:23      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:22      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:21      1135          when w0n99-opt-typ-sr
start:22      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:24      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:25      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:27      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:27      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:26      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:27      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:26      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:25      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:24      1813          go to 0n99-3030-stop-lr-x
start:25      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:24      1814          end-if
1815        if w0n99-ope-dir-entree
start:25      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:27      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:26      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:27      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:26      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:25      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:24      1817          else
start:25      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:27      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:26      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:27      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:26      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:27      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:26      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:25      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:24      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:25      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:24      1822          end-if
1823        end-if
end:23      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:22      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:21      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:20      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:23      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:25      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:24      3336          else
start:25      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:24      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:24      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:23      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:22      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:21      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:20      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:19      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:20      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:21      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:20      1684          end-if
1685        if w0n99-fl-abe-y
start:21      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:20      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:19      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
end:18      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1000        when w0n99-opt-typ-ip
end:17      1000          when w0n99-opt-typ-ip
start:18      1000          when w0n99-opt-typ-ip
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
start:19      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:20      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:21      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:22      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:23      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:24      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:23      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:24      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:23      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:24      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:23      1549          end-if
1550        else
end:22      1550          else
start:23      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:24      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:23      1558          end-if
1559        end-if
end:22      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:21      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:20      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:21      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:22      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:23      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:24      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:23      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:24      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:23      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:24      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:23      1573          end-if
1574        else
end:22      1574          else
start:23      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:24      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:23      1582          end-if
1583        end-if
end:22      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:21      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:20      1526          end-if
1527        end-perform
end:19      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:20      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:19      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
end:18      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1002        when other
end:17      1002          when other
start:18      1002          when other
1003        go to 0n99-1570-mod-fin-opt-x
end:17      1003          go to 0n99-1570-mod-fin-opt-x
start:18      1003          go to 0n99-1570-mod-fin-opt-x
1004        end-evaluate
end:17      1004          end-evaluate
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
start:18      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
2251    0o40-1000-record-fopt-info.
2252        set l0o40-record-fopt-info to true
2253        perform 0o40-0000-call thru 0o40-0000-call-x
start:19      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2253        perform 0o40-0000-call thru 0o40-0000-call-x
end:18      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2254        continue.
2255    0o40-1000-record-fopt-info-x.
2256        exit.
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
end:17      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
1006        if l0o40-retrn-error or w0n99-cpb-csq-blk
start:18      1006          if l0o40-retrn-error or w0n99-cpb-csq-blk
1007        set l0n99-retrn-error to true
1008        move 'sc0n990012' to wglob-msg-ref-info
1009        move rpol-pol-id to wglob-msg-parm(1)
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:19      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:20      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:19      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:18      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1011        go to 0n99-1570-mod-fin-opt-x
end:17      1011          go to 0n99-1570-mod-fin-opt-x
start:18      1011          go to 0n99-1570-mod-fin-opt-x
1012        end-if
end:17      1012          end-if
1013        move w0n99-transaction-id to wglob-transaction-id
1014        set w0n99-lapse-flag-n to true
1015        perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
start:18      1015          perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
1016        if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
start:19      1016          if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
1017        set w0n99-lapse-flag-y to true
1018        end-if
end:18      1018          end-if
1019        end-perform
end:17      1019          end-perform
1020        if w0n99-lapse-flag-y
start:18      1020          if w0n99-lapse-flag-y
1021        initialize w0n99-lapse-supp-ind
1022        if w0n99-abe-fnd-dbt-y
start:19      1022          if w0n99-abe-fnd-dbt-y
1023        if w0n99-mltpl-dbt-fnd-y
start:20      1023          if w0n99-mltpl-dbt-fnd-y
1024        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:21      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:22      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:23      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:22      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:23      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:24      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:23      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:22      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:23      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:22      895          go to 0n99-1540-lapse-support-x
start:23      895          go to 0n99-1540-lapse-support-x
896        end-if
end:22      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:21      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:22      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:23      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:24      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:23      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:22      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:23      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:22      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:23      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:22      1971          when w0n99-opt-rh-optrpp
start:23      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:22      1973          when w0n99-opt-rh-optecr
start:23      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:24      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:23      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:24      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:23      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:22      1980          when w0n99-opt-rh-optsl1
start:23      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:24      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:23      1983          else
start:24      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:23      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:22      1986          when w0n99-opt-rh-optsw1
start:23      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:24      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:23      1989          else
start:24      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:23      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:22      1992          when w0n99-opt-rh-optsr1
start:23      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:24      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:23      1995          else
start:24      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:23      1997          end-if
1998        when w0n99-opt-rh-optip1
end:22      1998          when w0n99-opt-rh-optip1
start:23      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:24      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:23      2001          else
start:24      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:23      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:22      2004          when w0n99-opt-rh-optcl1
start:23      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:24      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:23      2007          else
start:24      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:23      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:22      2010          when w0n99-opt-rh-optsp1
start:23      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:24      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:23      2013          else
start:24      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:23      2015          end-if
2016        when w0n99-opt-rh-optra1
end:22      2016          when w0n99-opt-rh-optra1
start:23      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:22      2018          when other
start:23      2018          when other
2019        continue
2020        end-evaluate
end:22      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:23      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:24      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:23      3201          else
start:24      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:23      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:24      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:23      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:22      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:21      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:22      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:21      902          go to 0n99-1540-lapse-support-x
start:22      902          go to 0n99-1540-lapse-support-x
903        end-if
end:21      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:20      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1026        if l0n99-retrn-error
start:21      1026          if l0n99-retrn-error
1027        go to 0n99-1570-mod-fin-opt-x
end:20      1027          go to 0n99-1570-mod-fin-opt-x
start:21      1027          go to 0n99-1570-mod-fin-opt-x
1028        end-if
end:20      1028          end-if
1029        else
end:19      1029          else
start:20      1029          else
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:21      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:22      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:22      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:23      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:22      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:23      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:22      932          go to 0n99-1550-lapse-fin-opt-x
start:23      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:22      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:21      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:20      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1031        if l0n99-retrn-error
start:21      1031          if l0n99-retrn-error
1032        go to 0n99-1570-mod-fin-opt-x
end:20      1032          go to 0n99-1570-mod-fin-opt-x
start:21      1032          go to 0n99-1570-mod-fin-opt-x
1033        end-if
end:20      1033          end-if
1034        end-if
end:19      1034          end-if
1035        end-if
end:18      1035          end-if
1036        if w0n99-abe-fnd-rcp-y
start:19      1036          if w0n99-abe-fnd-rcp-y
1037        if w0n99-mltpl-rcp-fnd-y
start:20      1037          if w0n99-mltpl-rcp-fnd-y
1038        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:21      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:22      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:23      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:22      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:23      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:24      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:23      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:22      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:23      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:22      895          go to 0n99-1540-lapse-support-x
start:23      895          go to 0n99-1540-lapse-support-x
896        end-if
end:22      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:21      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:22      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:23      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:24      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:23      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:22      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:23      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:22      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:23      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:22      1971          when w0n99-opt-rh-optrpp
start:23      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:22      1973          when w0n99-opt-rh-optecr
start:23      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:24      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:23      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:24      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:23      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:22      1980          when w0n99-opt-rh-optsl1
start:23      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:24      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:23      1983          else
start:24      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:23      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:22      1986          when w0n99-opt-rh-optsw1
start:23      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:24      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:23      1989          else
start:24      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:23      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:22      1992          when w0n99-opt-rh-optsr1
start:23      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:24      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:23      1995          else
start:24      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:23      1997          end-if
1998        when w0n99-opt-rh-optip1
end:22      1998          when w0n99-opt-rh-optip1
start:23      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:24      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:23      2001          else
start:24      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:23      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:22      2004          when w0n99-opt-rh-optcl1
start:23      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:24      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:23      2007          else
start:24      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:23      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:22      2010          when w0n99-opt-rh-optsp1
start:23      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:24      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:23      2013          else
start:24      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:23      2015          end-if
2016        when w0n99-opt-rh-optra1
end:22      2016          when w0n99-opt-rh-optra1
start:23      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:22      2018          when other
start:23      2018          when other
2019        continue
2020        end-evaluate
end:22      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:23      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:24      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:23      3201          else
start:24      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:23      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:24      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:23      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:22      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:21      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:22      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:21      902          go to 0n99-1540-lapse-support-x
start:22      902          go to 0n99-1540-lapse-support-x
903        end-if
end:21      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:20      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1040        if l0n99-retrn-error
start:21      1040          if l0n99-retrn-error
1041        go to 0n99-1570-mod-fin-opt-x
end:20      1041          go to 0n99-1570-mod-fin-opt-x
start:21      1041          go to 0n99-1570-mod-fin-opt-x
1042        end-if
end:20      1042          end-if
1043        else
end:19      1043          else
start:20      1043          else
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:21      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:22      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:22      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:23      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:22      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:23      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:22      932          go to 0n99-1550-lapse-fin-opt-x
start:23      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:22      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:21      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:20      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1045        if l0n99-retrn-error
start:21      1045          if l0n99-retrn-error
1046        go to 0n99-1570-mod-fin-opt-x
end:20      1046          go to 0n99-1570-mod-fin-opt-x
start:21      1046          go to 0n99-1570-mod-fin-opt-x
1047        end-if
end:20      1047          end-if
1048        end-if
end:19      1048          end-if
1049        end-if
end:18      1049          end-if
1050        if w0n99-abe-fnd-tgt-y
start:19      1050          if w0n99-abe-fnd-tgt-y
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:20      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:21      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:22      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:21      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:22      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:23      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:22      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:21      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:22      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:21      932          go to 0n99-1550-lapse-fin-opt-x
start:22      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:21      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:20      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:19      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1052        if l0n99-retrn-error
start:20      1052          if l0n99-retrn-error
1053        go to 0n99-1570-mod-fin-opt-x
end:19      1053          go to 0n99-1570-mod-fin-opt-x
start:20      1053          go to 0n99-1570-mod-fin-opt-x
1054        end-if
end:19      1054          end-if
1055        end-if
end:18      1055          end-if
1056        end-if
end:17      1056          end-if
1057        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
start:18      1057          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
1058        set w0n99-ref-amt-updt-y to true
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
start:19      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:20      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:19      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:20      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:21      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:20      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:19      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:20      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
end:19      1159          go to 0n99-1600-mod-ref-amt-x
start:20      1159          go to 0n99-1600-mod-ref-amt-x
1160        end-if
end:19      1160          end-if
1161        compute w0n99-fnd-ref-amt = l0o37-fnd-ref-amt + l0n99-abe-cv-amt
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:20      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:19      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1163        set l0o37-rqst-calc to true
1164        set l0o37-ref-val-calc-ind-t to true
1165        move rpol-pol-id to l0o37-pol-id
1166        move l0n99-abn-fnd-id to l0o37-fnd-id
1167        move w0n99-opt-rh-id to l0o37-opt-rh-id
1168        move w0n99-abn-opt-num to l0o37-opt-num
1169        move w0n99-stp-cd-5 to l0o37-stp-cd
1170        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1171        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1172        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:20      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:21      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:20      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:19      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1174        if not l0o37-retrn-ok
start:20      1174          if not l0o37-retrn-ok
1175        set l0n99-retrn-error to true
1176        go to 0n99-1600-mod-ref-amt-x
end:19      1176          go to 0n99-1600-mod-ref-amt-x
start:20      1176          go to 0n99-1600-mod-ref-amt-x
1177        end-if
end:19      1177          end-if
1178        continue.
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
end:18      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1060        end-if
end:17      1060          end-if
1061        if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
start:18      1061          if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
start:19      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1071    0n99-1580-mod-ref-val.
1072        if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
start:20      1072          if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
1073        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
start:21      1073          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
1074        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0n99-abn-cv-amt
1075        end-if
end:20      1075          end-if
1076        if w0n99-abe-fnd-dbt-y
start:21      1076          if w0n99-abe-fnd-dbt-y
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:22      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:21      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1078        set l0o37-rqst-calc to true
1079        set l0o37-ref-val-calc-ind-t to true
1080        move rpol-pol-id to l0o37-pol-id
1081        move l0n99-abn-fnd-id to l0o37-fnd-id
1082        move w0n99-opt-rh-id to l0o37-opt-rh-id
1083        move w0n99-abn-opt-num to l0o37-opt-num
1084        move l0o40-stp-cd to l0o37-stp-cd
1085        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1086        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1087        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:22      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:23      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:22      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:21      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1089        if not l0o37-retrn-ok or w0n99-cpb-csq-blk
start:22      1089          if not l0o37-retrn-ok or w0n99-cpb-csq-blk
1090        set l0n99-retrn-error to true
1091        move 'sc0n990015' to wglob-msg-ref-info
1092        move rpol-pol-id to wglob-msg-parm(1)
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1094        go to 0n99-1580-mod-ref-val-x
end:21      1094          go to 0n99-1580-mod-ref-val-x
start:22      1094          go to 0n99-1580-mod-ref-val-x
1095        end-if
end:21      1095          end-if
1096        end-if
end:20      1096          end-if
1097        end-if
end:19      1097          end-if
1098        continue.
1099    0n99-1580-mod-ref-val-x.
1100        exit.
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
end:18      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1063        end-if
end:17      1063          end-if
1064        if l0n99-retrn-ok
start:18      1064          if l0n99-retrn-ok
1065        set w0n99-prcs-gevt-y to true
1066        end-if
end:17      1066          end-if
1067        end-if
end:16      1067          end-if
1068        continue.
1069    0n99-1570-mod-fin-opt-x.
1070        exit.
859        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
end:15      859          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
860        else
end:14      860          else
start:15      860          else
861        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
start:16      861          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
939    0n99-1560-check-abn-support.
940        set w0n99-abn-fnd-avl-n to true
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
start:17      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
end:16      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
942        move rpol-plan-id to l0o34-plan-id
943        move rpol-cd-opt-ofp-act to l0o34-cd-opt-ofp-act
944        move l0o33-opt-eff-dt(w0n99-one) to l0o34-opt-eff-dt
945        move w0n99-opt-rh-id to l0o34-opt-rh-id
946        move l0o33-opt-sign-dt(w0n99-one) to l0o34-opt-sign-dt
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
start:17      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:18      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:17      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
end:16      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
948        if not l0o34-retrn-ok
start:17      948          if not l0o34-retrn-ok
949        set l0n99-retrn-error to true
950        go to 0n99-1560-check-abn-support-x
end:16      950          go to 0n99-1560-check-abn-support-x
start:17      950          go to 0n99-1560-check-abn-support-x
951        end-if
end:16      951          end-if
952        perform varying j from 1 by 1 until j > w0n99-two
start:17      952          perform varying j from 1 by 1 until j > w0n99-two
953        perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
start:18      953          perform varying i from 1 by 1 until i > wglob-max-fnd-plan-qty or l0o34-fnd-id(j,i) = spaces
954        if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
start:19      954          if l0o34-fnd-id(j,i) = l0n99-abn-fnd-id and l0o34-ope-dir-cd(j) = w0n99-ope-dir-cd
955        set w0n99-abn-fnd-avl-y to true
956        end-if
end:18      956          end-if
957        end-perform
end:17      957          end-perform
958        end-perform
end:16      958          end-perform
959        continue.
960    0n99-1560-check-abn-support-x.
961        exit.
861        perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
end:15      861          perform 0n99-1560-check-abn-support thru 0n99-1560-check-abn-support-x
862        if w0n99-abn-fnd-avl-y
start:16      862          if w0n99-abn-fnd-avl-y
863        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
start:17      863          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
962    0n99-1570-mod-fin-opt.
963        initialize w0n99-fnd-ope-dir-cd
964        initialize w0n99-fnd-rel-rt
965        initialize w0n99-fnd-pct
966        initialize w0n99-fnd-ref-amt
967        initialize w0n99-fnd-amt
968        move w0n99-one to w0n99-fnd-num
969        if l0n99-chk-admsblty-mod
start:18      969          if l0n99-chk-admsblty-mod
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
start:19      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
end:18      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
971        set l0o40-record-fopt-info to true
972        move rpol-pol-id to l0o40-pol-id
973        move rpol-plan-id to l0o40-plan-id
974        move w0n99-opt-rh-id to l0o40-opt-rh-id
975        move rpol-cd-opt-ofp-act to l0o40-cd-opt-ofp-act
976        move rpol-pol-base-cvg-num to l0o40-cvg-num-n
977        move l0o34-opt-typ-cd to w0n99-opt-typ-cd
978        move l0n99-ope-eff-dt to l0o40-ref-eff-dt
979        move l0n99-ope-eff-dt to l0o40-da-fcn-pol-cvt
980        move l0n99-ope-eff-dt to l0o40-db-fcn-pol
981        move l0o33-recv-whole-file-dt(w0n99-one) to l0o40-recv-whole-file-dt
982        move l0n99-ost-ind to l0o40-ost-ind
983        move wglob-transaction-id to w0n99-transaction-id
984        move l0o33-opt-nxt-actv-dt(w0n99-one) to l0o40-opt-nxt-actv-dt
985        set l0o40-stp-08 to true
986        set wglob-transaction-mdof to true
987        evaluate true
start:19      988          when w0n99-opt-typ-cl
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
start:20      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:21      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:23      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:25      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:24      1226          end-if
1227        else
end:23      1227          else
start:24      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:24      1234          end-if
1235        end-if
end:23      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:22      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:21      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:22      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:23      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:24      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:25      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:24      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:25      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:24      1246          else
start:25      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:26      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:25      1249          end-if
1250        end-if
end:24      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:25      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:24      1253          end-if
1254        else
end:23      1254          else
start:24      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:24      1261          end-if
1262        end-if
end:23      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:22      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:21      1209          end-if
1210        end-perform
end:20      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:20      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
end:19      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
990        when w0n99-opt-typ-re
end:18      990          when w0n99-opt-typ-re
start:19      990          when w0n99-opt-typ-re
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
start:20      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:21      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:23      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:25      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:24      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:25      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:24      1310          end-if
1311        else
end:23      1311          else
start:24      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:24      1318          end-if
1319        end-if
end:23      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:22      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:21      1291          end-if
1292        end-perform
end:20      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:20      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
end:19      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
992        when w0n99-opt-typ-sp
end:18      992          when w0n99-opt-typ-sp
start:19      992          when w0n99-opt-typ-sp
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
start:20      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:21      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:23      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:25      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:24      1368          end-if
1369        else
end:23      1369          else
start:24      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:24      1376          end-if
1377        end-if
end:23      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:22      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:21      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:22      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:23      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:24      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:25      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:24      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:25      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:24      1388          else
start:25      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:26      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:25      1391          end-if
1392        end-if
end:24      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:25      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:24      1395          end-if
1396        else
end:23      1396          else
start:24      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:24      1403          end-if
1404        end-if
end:23      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:22      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:21      1351          end-if
1352        end-perform
end:20      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:20      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
end:19      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
994        when w0n99-opt-typ-sr
end:18      994          when w0n99-opt-typ-sr
start:19      994          when w0n99-opt-typ-sr
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
start:20      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:21      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:20      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:21      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:23      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:22      2830          else
start:23      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:22      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:22      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:21      1125          go to 0n99-1590-cvgu-browse-x
start:22      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:21      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:22      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:23      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:25      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:28      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:27      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:27      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:25      1591          go to 0n99-3010-stop-win-x
start:26      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:25      1592          end-if
1593        if w0n99-ope-dir-entree
start:26      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:28      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:27      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:28      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:27      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:25      1595          else
start:26      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:27      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:27      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:27      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:25      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:26      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:25      1600          end-if
1601        end-if
end:24      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:22      1133          when w0n99-opt-typ-sl
start:23      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:25      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:28      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:27      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:27      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:25      1702          go to 0n99-3020-stop-loss-x
start:26      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:25      1703          end-if
1704        if w0n99-ope-dir-entree
start:26      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:28      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:27      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:28      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:27      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:25      1706          else
start:26      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:27      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:27      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:27      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:25      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:26      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:25      1711          end-if
1712        end-if
end:24      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:22      1135          when w0n99-opt-typ-sr
start:23      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:25      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:28      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:27      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:27      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:25      1813          go to 0n99-3030-stop-lr-x
start:26      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:25      1814          end-if
1815        if w0n99-ope-dir-entree
start:26      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:28      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:27      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:28      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:27      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:25      1817          else
start:26      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:27      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:27      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:27      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:25      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:26      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:25      1822          end-if
1823        end-if
end:24      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:22      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:21      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:20      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:21      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:22      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:21      1906          end-if
1907        if w0n99-fl-abe-y
start:22      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:21      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:20      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
end:19      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
996        when w0n99-opt-typ-sl
end:18      996          when w0n99-opt-typ-sl
start:19      996          when w0n99-opt-typ-sl
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
start:20      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:21      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:20      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:21      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:23      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:22      2830          else
start:23      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:22      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:22      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:21      1125          go to 0n99-1590-cvgu-browse-x
start:22      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:21      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:22      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:23      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:25      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:28      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:27      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:27      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:25      1591          go to 0n99-3010-stop-win-x
start:26      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:25      1592          end-if
1593        if w0n99-ope-dir-entree
start:26      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:28      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:27      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:28      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:27      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:25      1595          else
start:26      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:27      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:27      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:27      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:25      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:26      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:25      1600          end-if
1601        end-if
end:24      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:22      1133          when w0n99-opt-typ-sl
start:23      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:25      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:28      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:27      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:27      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:25      1702          go to 0n99-3020-stop-loss-x
start:26      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:25      1703          end-if
1704        if w0n99-ope-dir-entree
start:26      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:28      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:27      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:28      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:27      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:25      1706          else
start:26      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:27      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:27      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:27      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:25      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:26      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:25      1711          end-if
1712        end-if
end:24      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:22      1135          when w0n99-opt-typ-sr
start:23      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:25      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:28      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:27      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:27      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:25      1813          go to 0n99-3030-stop-lr-x
start:26      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:25      1814          end-if
1815        if w0n99-ope-dir-entree
start:26      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:28      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:27      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:28      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:27      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:25      1817          else
start:26      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:27      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:27      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:27      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:25      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:26      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:25      1822          end-if
1823        end-if
end:24      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:22      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:21      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:20      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:21      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:22      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:21      1795          end-if
1796        if w0n99-fl-abe-y
start:22      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:21      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:20      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
end:19      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
998        when w0n99-opt-typ-sw
end:18      998          when w0n99-opt-typ-sw
start:19      998          when w0n99-opt-typ-sw
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
start:20      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:21      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:20      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:21      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:22      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:23      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:22      2830          else
start:23      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:22      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:21      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:22      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:23      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:23      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:22      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:21      1125          go to 0n99-1590-cvgu-browse-x
start:22      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:21      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:22      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:21      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:22      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:23      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:24      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:25      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:27      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:28      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:27      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:27      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:26      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:25      1591          go to 0n99-3010-stop-win-x
start:26      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:25      1592          end-if
1593        if w0n99-ope-dir-entree
start:26      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:27      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:28      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:27      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:28      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:27      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:26      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:25      1595          else
start:26      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:27      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:27      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:27      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:27      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:26      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:25      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:26      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:25      1600          end-if
1601        end-if
end:24      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:23      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:22      1133          when w0n99-opt-typ-sl
start:23      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:24      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:25      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:27      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:28      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:27      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:27      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:26      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:25      1702          go to 0n99-3020-stop-loss-x
start:26      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:25      1703          end-if
1704        if w0n99-ope-dir-entree
start:26      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:27      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:28      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:27      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:28      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:27      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:26      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:25      1706          else
start:26      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:27      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:27      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:27      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:27      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:26      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:25      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:26      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:25      1711          end-if
1712        end-if
end:24      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:23      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:22      1135          when w0n99-opt-typ-sr
start:23      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:24      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:25      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:26      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:27      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:28      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:29      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:28      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:27      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:28      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:27      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:26      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:25      1813          go to 0n99-3030-stop-lr-x
start:26      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:25      1814          end-if
1815        if w0n99-ope-dir-entree
start:26      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:27      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:28      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:27      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:28      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:27      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:26      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:25      1817          else
start:26      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:27      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:28      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:27      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:28      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:27      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:28      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:27      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:26      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:25      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:26      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:25      1822          end-if
1823        end-if
end:24      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:23      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:22      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:23      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:24      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:25      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:24      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:23      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:22      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:21      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:22      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:23      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:24      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:25      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:26      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:25      3336          else
start:26      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:25      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:25      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:24      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:23      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:22      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:21      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:20      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:21      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:22      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:21      1684          end-if
1685        if w0n99-fl-abe-y
start:22      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:21      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:20      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
end:19      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1000        when w0n99-opt-typ-ip
end:18      1000          when w0n99-opt-typ-ip
start:19      1000          when w0n99-opt-typ-ip
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
start:20      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:21      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:22      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:23      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:24      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:25      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:24      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:25      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:24      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:25      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:24      1549          end-if
1550        else
end:23      1550          else
start:24      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:24      1558          end-if
1559        end-if
end:23      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:22      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:21      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:22      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:23      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:24      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:25      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:24      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:25      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:24      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:25      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:24      1573          end-if
1574        else
end:23      1574          else
start:24      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:25      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:24      1582          end-if
1583        end-if
end:23      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:22      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:21      1526          end-if
1527        end-perform
end:20      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:21      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:20      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
end:19      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1002        when other
end:18      1002          when other
start:19      1002          when other
1003        go to 0n99-1570-mod-fin-opt-x
end:18      1003          go to 0n99-1570-mod-fin-opt-x
start:19      1003          go to 0n99-1570-mod-fin-opt-x
1004        end-evaluate
end:18      1004          end-evaluate
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
start:19      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
2251    0o40-1000-record-fopt-info.
2252        set l0o40-record-fopt-info to true
2253        perform 0o40-0000-call thru 0o40-0000-call-x
start:20      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2253        perform 0o40-0000-call thru 0o40-0000-call-x
end:19      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2254        continue.
2255    0o40-1000-record-fopt-info-x.
2256        exit.
1005        perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
end:18      1005          perform 0o40-1000-record-fopt-info thru 0o40-1000-record-fopt-info-x
1006        if l0o40-retrn-error or w0n99-cpb-csq-blk
start:19      1006          if l0o40-retrn-error or w0n99-cpb-csq-blk
1007        set l0n99-retrn-error to true
1008        move 'sc0n990012' to wglob-msg-ref-info
1009        move rpol-pol-id to wglob-msg-parm(1)
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:20      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:21      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:20      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1010        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:19      1010          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1011        go to 0n99-1570-mod-fin-opt-x
end:18      1011          go to 0n99-1570-mod-fin-opt-x
start:19      1011          go to 0n99-1570-mod-fin-opt-x
1012        end-if
end:18      1012          end-if
1013        move w0n99-transaction-id to wglob-transaction-id
1014        set w0n99-lapse-flag-n to true
1015        perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
start:19      1015          perform varying xx from 1 by 1 until xx > w0n99-twenty or l0o40-int-rh-id-2(w0n99-one,xx) = (spaces or low-values) or w0n99-lapse-flag-y
1016        if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
start:20      1016          if (l0o40-cpb-csq-blk(w0n99-one,xx) or l0o40-cpb-csq-ter(w0n99-one,xx) )
1017        set w0n99-lapse-flag-y to true
1018        end-if
end:19      1018          end-if
1019        end-perform
end:18      1019          end-perform
1020        if w0n99-lapse-flag-y
start:19      1020          if w0n99-lapse-flag-y
1021        initialize w0n99-lapse-supp-ind
1022        if w0n99-abe-fnd-dbt-y
start:20      1022          if w0n99-abe-fnd-dbt-y
1023        if w0n99-mltpl-dbt-fnd-y
start:21      1023          if w0n99-mltpl-dbt-fnd-y
1024        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:22      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:23      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:24      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:23      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:24      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:23      895          go to 0n99-1540-lapse-support-x
start:24      895          go to 0n99-1540-lapse-support-x
896        end-if
end:23      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:22      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:23      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:24      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:25      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:24      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:23      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:24      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:23      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:24      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:23      1971          when w0n99-opt-rh-optrpp
start:24      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:23      1973          when w0n99-opt-rh-optecr
start:24      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:25      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:24      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:25      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:24      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:23      1980          when w0n99-opt-rh-optsl1
start:24      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:25      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:24      1983          else
start:25      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:24      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:23      1986          when w0n99-opt-rh-optsw1
start:24      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:25      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:24      1989          else
start:25      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:24      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:23      1992          when w0n99-opt-rh-optsr1
start:24      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:25      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:24      1995          else
start:25      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:24      1997          end-if
1998        when w0n99-opt-rh-optip1
end:23      1998          when w0n99-opt-rh-optip1
start:24      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:25      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:24      2001          else
start:25      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:24      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:23      2004          when w0n99-opt-rh-optcl1
start:24      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:25      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:24      2007          else
start:25      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:24      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:23      2010          when w0n99-opt-rh-optsp1
start:24      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:25      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:24      2013          else
start:25      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:24      2015          end-if
2016        when w0n99-opt-rh-optra1
end:23      2016          when w0n99-opt-rh-optra1
start:24      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:23      2018          when other
start:24      2018          when other
2019        continue
2020        end-evaluate
end:23      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:24      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:25      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:24      3201          else
start:25      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:24      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:25      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:24      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:23      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:22      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:23      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:22      902          go to 0n99-1540-lapse-support-x
start:23      902          go to 0n99-1540-lapse-support-x
903        end-if
end:22      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1025        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:21      1025          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1026        if l0n99-retrn-error
start:22      1026          if l0n99-retrn-error
1027        go to 0n99-1570-mod-fin-opt-x
end:21      1027          go to 0n99-1570-mod-fin-opt-x
start:22      1027          go to 0n99-1570-mod-fin-opt-x
1028        end-if
end:21      1028          end-if
1029        else
end:20      1029          else
start:21      1029          else
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:22      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:23      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:24      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:23      932          go to 0n99-1550-lapse-fin-opt-x
start:24      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:23      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:22      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1030        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:21      1030          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1031        if l0n99-retrn-error
start:22      1031          if l0n99-retrn-error
1032        go to 0n99-1570-mod-fin-opt-x
end:21      1032          go to 0n99-1570-mod-fin-opt-x
start:22      1032          go to 0n99-1570-mod-fin-opt-x
1033        end-if
end:21      1033          end-if
1034        end-if
end:20      1034          end-if
1035        end-if
end:19      1035          end-if
1036        if w0n99-abe-fnd-rcp-y
start:20      1036          if w0n99-abe-fnd-rcp-y
1037        if w0n99-mltpl-rcp-fnd-y
start:21      1037          if w0n99-mltpl-rcp-fnd-y
1038        move l0n99-abe-fnd-id to w0n99-term-fnd-id
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
start:22      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:23      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:24      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:23      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:24      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
end:23      895          go to 0n99-1540-lapse-support-x
start:24      895          go to 0n99-1540-lapse-support-x
896        end-if
end:23      896          end-if
897        set w0n99-prcs-gevt-y to true
898        end-if
end:22      898          end-if
899        set w0n99-lapse-supp-y to true
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
start:23      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:24      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:25      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:24      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:23      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:24      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:23      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:24      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:23      1971          when w0n99-opt-rh-optrpp
start:24      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:23      1973          when w0n99-opt-rh-optecr
start:24      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:25      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:24      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:25      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:24      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:23      1980          when w0n99-opt-rh-optsl1
start:24      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:25      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:24      1983          else
start:25      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:24      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:23      1986          when w0n99-opt-rh-optsw1
start:24      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:25      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:24      1989          else
start:25      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:24      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:23      1992          when w0n99-opt-rh-optsr1
start:24      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:25      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:24      1995          else
start:25      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:24      1997          end-if
1998        when w0n99-opt-rh-optip1
end:23      1998          when w0n99-opt-rh-optip1
start:24      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:25      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:24      2001          else
start:25      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:24      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:23      2004          when w0n99-opt-rh-optcl1
start:24      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:25      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:24      2007          else
start:25      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:24      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:23      2010          when w0n99-opt-rh-optsp1
start:24      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:25      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:24      2013          else
start:25      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:24      2015          end-if
2016        when w0n99-opt-rh-optra1
end:23      2016          when w0n99-opt-rh-optra1
start:24      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:23      2018          when other
start:24      2018          when other
2019        continue
2020        end-evaluate
end:23      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:24      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:25      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:24      3201          else
start:25      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:24      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:25      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:26      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:27      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:26      3336          else
start:27      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:26      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:27      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:26      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:25      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:24      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:23      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
900        perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
end:22      900          perform 0n99-5000-gevt-write thru 0n99-5000-gevt-write-x
901        if l0n99-retrn-error
start:23      901          if l0n99-retrn-error
902        go to 0n99-1540-lapse-support-x
end:22      902          go to 0n99-1540-lapse-support-x
start:23      902          go to 0n99-1540-lapse-support-x
903        end-if
end:22      903          end-if
904        continue.
905    0n99-1540-lapse-support-x.
906        exit.
1039        perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
end:21      1039          perform 0n99-1540-lapse-support thru 0n99-1540-lapse-support-x
1040        if l0n99-retrn-error
start:22      1040          if l0n99-retrn-error
1041        go to 0n99-1570-mod-fin-opt-x
end:21      1041          go to 0n99-1570-mod-fin-opt-x
start:22      1041          go to 0n99-1570-mod-fin-opt-x
1042        end-if
end:21      1042          end-if
1043        else
end:20      1043          else
start:21      1043          else
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:22      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:23      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:24      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:24      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:25      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:24      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:23      932          go to 0n99-1550-lapse-fin-opt-x
start:24      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:23      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:22      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1044        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:21      1044          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1045        if l0n99-retrn-error
start:22      1045          if l0n99-retrn-error
1046        go to 0n99-1570-mod-fin-opt-x
end:21      1046          go to 0n99-1570-mod-fin-opt-x
start:22      1046          go to 0n99-1570-mod-fin-opt-x
1047        end-if
end:21      1047          end-if
1048        end-if
end:20      1048          end-if
1049        end-if
end:19      1049          end-if
1050        if w0n99-abe-fnd-tgt-y
start:20      1050          if w0n99-abe-fnd-tgt-y
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:21      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:22      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:23      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:22      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:23      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:24      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:23      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:22      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:23      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:22      932          go to 0n99-1550-lapse-fin-opt-x
start:23      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:22      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:21      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
1051        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:20      1051          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
1052        if l0n99-retrn-error
start:21      1052          if l0n99-retrn-error
1053        go to 0n99-1570-mod-fin-opt-x
end:20      1053          go to 0n99-1570-mod-fin-opt-x
start:21      1053          go to 0n99-1570-mod-fin-opt-x
1054        end-if
end:20      1054          end-if
1055        end-if
end:19      1055          end-if
1056        end-if
end:18      1056          end-if
1057        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
start:19      1057          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y and l0n99-abe-cv-amt > zeroes and l0n99-abn-cv-amt > zeroes and w0n99-lapse-flag-n
1058        set w0n99-ref-amt-updt-y to true
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
start:20      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:21      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:20      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:21      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:22      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:21      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:20      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:21      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
end:20      1159          go to 0n99-1600-mod-ref-amt-x
start:21      1159          go to 0n99-1600-mod-ref-amt-x
1160        end-if
end:20      1160          end-if
1161        compute w0n99-fnd-ref-amt = l0o37-fnd-ref-amt + l0n99-abe-cv-amt
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:21      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1162        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:20      1162          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1163        set l0o37-rqst-calc to true
1164        set l0o37-ref-val-calc-ind-t to true
1165        move rpol-pol-id to l0o37-pol-id
1166        move l0n99-abn-fnd-id to l0o37-fnd-id
1167        move w0n99-opt-rh-id to l0o37-opt-rh-id
1168        move w0n99-abn-opt-num to l0o37-opt-num
1169        move w0n99-stp-cd-5 to l0o37-stp-cd
1170        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1171        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1172        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:21      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:22      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:21      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1173        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:20      1173          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1174        if not l0o37-retrn-ok
start:21      1174          if not l0o37-retrn-ok
1175        set l0n99-retrn-error to true
1176        go to 0n99-1600-mod-ref-amt-x
end:20      1176          go to 0n99-1600-mod-ref-amt-x
start:21      1176          go to 0n99-1600-mod-ref-amt-x
1177        end-if
end:20      1177          end-if
1178        continue.
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
1059        perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
end:19      1059          perform 0n99-1600-mod-ref-amt thru 0n99-1600-mod-ref-amt-x
1060        end-if
end:18      1060          end-if
1061        if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
start:19      1061          if l0o40-retrn-ok and w0n99-cpb-csq-use and w0n99-lapse-flag-n and w0n99-ref-amt-updt-n
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
start:20      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1071    0n99-1580-mod-ref-val.
1072        if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
start:21      1072          if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
1073        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
start:22      1073          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
1074        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0n99-abn-cv-amt
1075        end-if
end:21      1075          end-if
1076        if w0n99-abe-fnd-dbt-y
start:22      1076          if w0n99-abe-fnd-dbt-y
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:23      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:22      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1078        set l0o37-rqst-calc to true
1079        set l0o37-ref-val-calc-ind-t to true
1080        move rpol-pol-id to l0o37-pol-id
1081        move l0n99-abn-fnd-id to l0o37-fnd-id
1082        move w0n99-opt-rh-id to l0o37-opt-rh-id
1083        move w0n99-abn-opt-num to l0o37-opt-num
1084        move l0o40-stp-cd to l0o37-stp-cd
1085        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1086        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1087        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:23      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:24      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:23      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:22      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1089        if not l0o37-retrn-ok or w0n99-cpb-csq-blk
start:23      1089          if not l0o37-retrn-ok or w0n99-cpb-csq-blk
1090        set l0n99-retrn-error to true
1091        move 'sc0n990015' to wglob-msg-ref-info
1092        move rpol-pol-id to wglob-msg-parm(1)
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:24      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:25      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:24      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:23      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1094        go to 0n99-1580-mod-ref-val-x
end:22      1094          go to 0n99-1580-mod-ref-val-x
start:23      1094          go to 0n99-1580-mod-ref-val-x
1095        end-if
end:22      1095          end-if
1096        end-if
end:21      1096          end-if
1097        end-if
end:20      1097          end-if
1098        continue.
1099    0n99-1580-mod-ref-val-x.
1100        exit.
1062        perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
end:19      1062          perform 0n99-1580-mod-ref-val thru 0n99-1580-mod-ref-val-x
1063        end-if
end:18      1063          end-if
1064        if l0n99-retrn-ok
start:19      1064          if l0n99-retrn-ok
1065        set w0n99-prcs-gevt-y to true
1066        end-if
end:18      1066          end-if
1067        end-if
end:17      1067          end-if
1068        continue.
1069    0n99-1570-mod-fin-opt-x.
1070        exit.
863        perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
end:16      863          perform 0n99-1570-mod-fin-opt thru 0n99-1570-mod-fin-opt-x
864        else
end:15      864          else
start:16      864          else
865        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
start:17      865          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:18      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:19      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:18      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:19      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:20      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:19      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:18      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:19      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
end:18      932          go to 0n99-1550-lapse-fin-opt-x
start:19      932          go to 0n99-1550-lapse-fin-opt-x
933        end-if
end:18      933          end-if
934        set w0n99-prcs-gevt-y to true
935        end-if
end:17      935          end-if
936        continue.
937    0n99-1550-lapse-fin-opt-x.
938        exit.
865        perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
end:16      865          perform 0n99-1550-lapse-fin-opt thru 0n99-1550-lapse-fin-opt-x
866        end-if
end:15      866          end-if
867        end-if
end:14      867          end-if
868        continue.
869    0n99-1530-abe-fnd-tgt-x.
870        exit.
871    0n99-1540-lapse-support.
872        if l0n99-chk-admsblty-mod
start:15      872          if l0n99-chk-admsblty-mod
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:16      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
873        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:15      873          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
874        set l0o38-supp-lvl-lapse-opt to true
875        set l0o38-lapse-incmpt-batch to true
876        move rpol-pol-id to l0o38-pol-id
877        move rpol-plan-id to l0o38-plan-id
878        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
879        move w0n99-opt-rh-id to l0o38-opt-rh-id
880        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
881        move spaces to l0o38-opt-end-cd
882        set l0o38-opt-stat-mtv-o to true
883        move w0n99-term-fnd-id to l0o38-fnd-id
884        move wwkdt-zero-dt to l0o38-opt-eff-dt
885        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
886        move wwkdt-zero-dt to l0o38-db-fcn-pol
887        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
888        set l0o38-dsv-fnd-sta-vid to true
889        move spaces to l0o38-retro-actv-cd
890        move spaces to l0o38-retro-actv-asa-num
891        move wwkdt-zero-dt to l0o38-mdt-eff-dt
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
start:16      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:17      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:16      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
892        perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
end:15      892          perform 0o38-2000-supp-lvl-lapse-opt thru 0o38-2000-supp-lvl-lapse-opt-x
893        if l0o38-retrn-error
start:16      893          if l0o38-retrn-error
894        set l0n99-retrn-error to true
895        go to 0n99-1540-lapse-support-x
start:17      895          go to 0n99-1540-lapse-support-x
905    0n99-1540-lapse-support-x.
906        exit.
907    0n99-1550-lapse-fin-opt.
908        if l0n99-chk-admsblty-mod
start:18      908          if l0n99-chk-admsblty-mod
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
start:19      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
909        perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
end:18      909          perform 0o38-1000-build-parm-info thru 0o38-1000-build-parm-info-x
910        set l0o38-lapse-opt to true
911        move rpol-pol-id to l0o38-pol-id
912        move rpol-plan-id to l0o38-plan-id
913        move rpol-cd-opt-ofp-act to l0o38-cd-opt-ofp-act
914        move w0n99-opt-rh-id to l0o38-opt-rh-id
915        move l0n99-ope-eff-dt to l0o38-pchst-eff-dt
916        move spaces to l0o38-opt-end-cd
917        set l0o38-opt-stat-mtv-o to true
918        move spaces to l0o38-fnd-id
919        move wwkdt-zero-dt to l0o38-opt-eff-dt
920        move rpol-pol-iss-eff-dt to l0o38-pol-iss-eff-dt
921        move wwkdt-zero-dt to l0o38-db-fcn-pol
922        move lpga-tmsp-avn-uni to l0o38-tmsp-avn-uni
923        set l0o38-dsv-fnd-sta-dec to true
924        move spaces to l0o38-retro-actv-cd
925        move spaces to l0o38-retro-actv-asa-num
926        move wwkdt-zero-dt to l0o38-mdt-eff-dt
927        set l0o38-opt-end-r to true
928        set l0o38-lapse-incmpt-batch to true
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
start:19      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:20      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:19      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
929        perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
end:18      929          perform 0o38-1000-lapse-opt thru 0o38-1000-lapse-opt-x
930        if l0o38-retrn-error
start:19      930          if l0o38-retrn-error
931        set l0n99-retrn-error to true
932        go to 0n99-1550-lapse-fin-opt-x
start:20      932          go to 0n99-1550-lapse-fin-opt-x
937    0n99-1550-lapse-fin-opt-x.
938        exit.
939    0n99-1560-check-abn-support.
940        set w0n99-abn-fnd-avl-n to true
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
start:21      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
941        perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
end:20      941          perform 0o34-1000-build-parm-info thru 0o34-1000-build-parm-info-x
942        move rpol-plan-id to l0o34-plan-id
943        move rpol-cd-opt-ofp-act to l0o34-cd-opt-ofp-act
944        move l0o33-opt-eff-dt(w0n99-one) to l0o34-opt-eff-dt
945        move w0n99-opt-rh-id to l0o34-opt-rh-id
946        move l0o33-opt-sign-dt(w0n99-one) to l0o34-opt-sign-dt
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
start:21      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:22      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:21      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
947        perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
end:20      947          perform 0o34-1000-read-fopt-rep thru 0o34-1000-read-fopt-rep-x
948        if not l0o34-retrn-ok
start:21      948          if not l0o34-retrn-ok
949        set l0n99-retrn-error to true
950        go to 0n99-1560-check-abn-support-x
start:22      950          go to 0n99-1560-check-abn-support-x
960    0n99-1560-check-abn-support-x.
961        exit.
962    0n99-1570-mod-fin-opt.
963        initialize w0n99-fnd-ope-dir-cd
964        initialize w0n99-fnd-rel-rt
965        initialize w0n99-fnd-pct
966        initialize w0n99-fnd-ref-amt
967        initialize w0n99-fnd-amt
968        move w0n99-one to w0n99-fnd-num
969        if l0n99-chk-admsblty-mod
start:23      969          if l0n99-chk-admsblty-mod
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
start:24      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
970        perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
end:23      970          perform 0o40-1000-build-parm-info thru 0o40-1000-build-parm-info-x
971        set l0o40-record-fopt-info to true
972        move rpol-pol-id to l0o40-pol-id
973        move rpol-plan-id to l0o40-plan-id
974        move w0n99-opt-rh-id to l0o40-opt-rh-id
975        move rpol-cd-opt-ofp-act to l0o40-cd-opt-ofp-act
976        move rpol-pol-base-cvg-num to l0o40-cvg-num-n
977        move l0o34-opt-typ-cd to w0n99-opt-typ-cd
978        move l0n99-ope-eff-dt to l0o40-ref-eff-dt
979        move l0n99-ope-eff-dt to l0o40-da-fcn-pol-cvt
980        move l0n99-ope-eff-dt to l0o40-db-fcn-pol
981        move l0o33-recv-whole-file-dt(w0n99-one) to l0o40-recv-whole-file-dt
982        move l0n99-ost-ind to l0o40-ost-ind
983        move wglob-transaction-id to w0n99-transaction-id
984        move l0o33-opt-nxt-actv-dt(w0n99-one) to l0o40-opt-nxt-actv-dt
985        set l0o40-stp-08 to true
986        set wglob-transaction-mdof to true
987        evaluate true
start:24      988          when w0n99-opt-typ-cl
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
start:25      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:26      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:27      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:28      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:29      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:30      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:29      1226          end-if
1227        else
end:28      1227          else
start:29      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:30      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:29      1234          end-if
1235        end-if
end:28      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:27      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:26      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:27      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:28      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:29      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:30      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:29      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:30      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:29      1246          else
start:30      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:31      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:30      1249          end-if
1250        end-if
end:29      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:30      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:29      1253          end-if
1254        else
end:28      1254          else
start:29      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:30      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:29      1261          end-if
1262        end-if
end:28      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:27      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:26      1209          end-if
1210        end-perform
end:25      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:25      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
989        perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
end:24      989          perform 0n99-2010-opt-cl thru 0n99-2010-opt-cl-x
990        when w0n99-opt-typ-re
end:23      990          when w0n99-opt-typ-re
start:24      990          when w0n99-opt-typ-re
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
start:25      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:26      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:27      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:28      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:29      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:30      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:29      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:30      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:29      1310          end-if
1311        else
end:28      1311          else
start:29      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:30      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:29      1318          end-if
1319        end-if
end:28      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:27      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:26      1291          end-if
1292        end-perform
end:25      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:25      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
991        perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
end:24      991          perform 0n99-2011-opt-ra thru 0n99-2011-opt-ra-x
992        when w0n99-opt-typ-sp
end:23      992          when w0n99-opt-typ-sp
start:24      992          when w0n99-opt-typ-sp
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
start:25      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:26      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:27      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:28      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:29      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:30      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:29      1368          end-if
1369        else
end:28      1369          else
start:29      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:30      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:29      1376          end-if
1377        end-if
end:28      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:27      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:26      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:27      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:28      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:29      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:30      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:29      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:30      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:29      1388          else
start:30      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:31      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:30      1391          end-if
1392        end-if
end:29      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:30      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:29      1395          end-if
1396        else
end:28      1396          else
start:29      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:30      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:29      1403          end-if
1404        end-if
end:28      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:27      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:26      1351          end-if
1352        end-perform
end:25      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:25      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
993        perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
end:24      993          perform 0n99-2012-opt-sp thru 0n99-2012-opt-sp-x
994        when w0n99-opt-typ-sr
end:23      994          when w0n99-opt-typ-sr
start:24      994          when w0n99-opt-typ-sr
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
start:25      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:26      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:25      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:26      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:27      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:28      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:27      2830          else
start:28      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:27      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:28      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:29      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:31      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:30      3336          else
start:31      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:30      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:30      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:29      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:28      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:27      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:26      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:27      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:28      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:29      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:28      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:27      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:26      1125          go to 0n99-1590-cvgu-browse-x
start:27      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:26      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:27      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:28      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:29      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:31      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:30      3336          else
start:31      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:30      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:30      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:29      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:28      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:27      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:26      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:27      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:28      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:29      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:30      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:31      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:32      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:33      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:34      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:33      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:32      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:33      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:32      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:31      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:30      1591          go to 0n99-3010-stop-win-x
start:31      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:30      1592          end-if
1593        if w0n99-ope-dir-entree
start:31      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:32      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:33      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:32      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:33      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:32      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:31      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:30      1595          else
start:31      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:32      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:33      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:32      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:33      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:32      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:33      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:32      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:31      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:30      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:31      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:30      1600          end-if
1601        end-if
end:29      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:28      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:27      1133          when w0n99-opt-typ-sl
start:28      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:29      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:30      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:31      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:32      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:33      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:34      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:33      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:32      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:33      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:32      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:31      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:30      1702          go to 0n99-3020-stop-loss-x
start:31      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:30      1703          end-if
1704        if w0n99-ope-dir-entree
start:31      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:32      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:33      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:32      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:33      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:32      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:31      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:30      1706          else
start:31      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:32      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:33      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:32      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:33      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:32      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:33      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:32      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:31      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:30      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:31      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:30      1711          end-if
1712        end-if
end:29      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:28      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:27      1135          when w0n99-opt-typ-sr
start:28      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:29      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:30      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:31      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:32      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:33      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:34      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:33      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:32      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:33      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:32      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:31      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:30      1813          go to 0n99-3030-stop-lr-x
start:31      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:30      1814          end-if
1815        if w0n99-ope-dir-entree
start:31      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:32      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:33      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:32      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:33      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:32      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:31      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:30      1817          else
start:31      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:32      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:33      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:32      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:33      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:32      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:33      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:32      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:31      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:30      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:31      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:30      1822          end-if
1823        end-if
end:29      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:28      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:27      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:28      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:29      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:30      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:31      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:32      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:31      3336          else
start:32      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:31      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:32      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:29      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:28      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:27      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:26      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:27      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:28      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:29      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:31      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:30      3336          else
start:31      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:30      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:30      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:29      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:28      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:27      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:26      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:25      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:26      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:27      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:26      1906          end-if
1907        if w0n99-fl-abe-y
start:27      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:26      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:25      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
995        perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
end:24      995          perform 0n99-2013-opt-sr thru 0n99-2013-opt-sr-x
996        when w0n99-opt-typ-sl
end:23      996          when w0n99-opt-typ-sl
start:24      996          when w0n99-opt-typ-sl
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
start:25      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:26      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:25      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:26      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:27      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:28      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:27      2830          else
start:28      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:27      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:28      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:29      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:31      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:30      3336          else
start:31      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:30      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:30      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:29      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:28      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:27      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:26      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:27      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:28      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:29      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:28      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:27      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:26      1125          go to 0n99-1590-cvgu-browse-x
start:27      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:26      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:27      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:28      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:29      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:31      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:30      3336          else
start:31      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:30      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:30      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:29      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:28      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:27      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:26      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:27      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:28      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:29      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:30      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:31      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:32      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:33      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:34      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:33      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:32      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:33      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:32      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:31      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:30      1591          go to 0n99-3010-stop-win-x
start:31      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:30      1592          end-if
1593        if w0n99-ope-dir-entree
start:31      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:32      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:33      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:32      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:33      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:32      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:31      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:30      1595          else
start:31      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:32      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:33      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:32      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:33      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:32      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:33      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:32      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:31      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:30      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:31      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:30      1600          end-if
1601        end-if
end:29      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:28      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:27      1133          when w0n99-opt-typ-sl
start:28      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:29      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:30      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:31      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:32      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:33      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:34      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:33      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:32      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:33      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:32      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:31      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:30      1702          go to 0n99-3020-stop-loss-x
start:31      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:30      1703          end-if
1704        if w0n99-ope-dir-entree
start:31      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:32      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:33      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:32      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:33      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:32      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:31      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:30      1706          else
start:31      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:32      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:33      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:32      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:33      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:32      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:33      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:32      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:31      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:30      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:31      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:30      1711          end-if
1712        end-if
end:29      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:28      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:27      1135          when w0n99-opt-typ-sr
start:28      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:29      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:30      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:31      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:32      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:33      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:34      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:33      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:32      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:33      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:32      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:31      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:30      1813          go to 0n99-3030-stop-lr-x
start:31      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:30      1814          end-if
1815        if w0n99-ope-dir-entree
start:31      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:32      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:33      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:32      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:33      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:32      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:31      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:30      1817          else
start:31      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:32      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:33      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:32      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:33      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:32      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:33      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:32      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:31      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:30      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:31      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:30      1822          end-if
1823        end-if
end:29      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:28      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:27      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:28      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:29      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:30      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:31      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:32      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:31      3336          else
start:32      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:31      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:32      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:29      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:28      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:27      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:26      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:27      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:28      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:29      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:31      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:30      3336          else
start:31      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:30      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:30      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:29      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:28      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:27      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:26      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:25      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:26      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:27      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:26      1795          end-if
1796        if w0n99-fl-abe-y
start:27      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:26      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:25      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
997        perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
end:24      997          perform 0n99-2014-opt-sl thru 0n99-2014-opt-sl-x
998        when w0n99-opt-typ-sw
end:23      998          when w0n99-opt-typ-sw
start:24      998          when w0n99-opt-typ-sw
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
start:25      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:26      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:25      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:26      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:27      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:28      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:27      2830          else
start:28      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:27      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:28      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:29      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:31      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:30      3336          else
start:31      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:30      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:30      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:29      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:28      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:27      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:26      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:27      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:28      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:29      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:28      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:27      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:26      1125          go to 0n99-1590-cvgu-browse-x
start:27      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:26      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:27      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:28      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:29      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:31      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:30      3336          else
start:31      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:30      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:30      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:29      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:28      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:27      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:26      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:27      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:28      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:29      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:30      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:31      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:32      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:33      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:34      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:33      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:32      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:33      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:32      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:31      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:30      1591          go to 0n99-3010-stop-win-x
start:31      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:30      1592          end-if
1593        if w0n99-ope-dir-entree
start:31      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:32      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:33      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:32      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:33      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:32      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:31      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:30      1595          else
start:31      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:32      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:33      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:32      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:33      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:32      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:33      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:32      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:31      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:30      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:31      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:30      1600          end-if
1601        end-if
end:29      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:28      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:27      1133          when w0n99-opt-typ-sl
start:28      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:29      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:30      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:31      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:32      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:33      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:34      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:33      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:32      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:33      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:32      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:31      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:30      1702          go to 0n99-3020-stop-loss-x
start:31      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:30      1703          end-if
1704        if w0n99-ope-dir-entree
start:31      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:32      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:33      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:32      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:33      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:32      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:31      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:30      1706          else
start:31      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:32      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:33      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:32      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:33      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:32      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:33      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:32      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:31      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:30      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:31      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:30      1711          end-if
1712        end-if
end:29      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:28      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:27      1135          when w0n99-opt-typ-sr
start:28      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:29      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:30      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:31      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:32      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:33      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:34      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:33      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:32      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:33      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:32      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:31      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:30      1813          go to 0n99-3030-stop-lr-x
start:31      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:30      1814          end-if
1815        if w0n99-ope-dir-entree
start:31      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:32      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:33      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:32      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:33      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:32      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:31      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:30      1817          else
start:31      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:32      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:33      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:32      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:33      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:32      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:33      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:32      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:31      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:30      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:31      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:30      1822          end-if
1823        end-if
end:29      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:28      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:27      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:28      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:29      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:30      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:31      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:32      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:31      3336          else
start:32      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:31      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:32      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:29      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:28      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:27      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:26      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:27      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:28      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:29      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:30      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:31      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:30      3336          else
start:31      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:30      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:31      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:30      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:29      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:28      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:27      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:26      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:25      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:26      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:27      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:26      1684          end-if
1685        if w0n99-fl-abe-y
start:27      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:26      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:25      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
999        perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
end:24      999          perform 0n99-2015-opt-sw thru 0n99-2015-opt-sw-x
1000        when w0n99-opt-typ-ip
end:23      1000          when w0n99-opt-typ-ip
start:24      1000          when w0n99-opt-typ-ip
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
start:25      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:26      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:27      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:28      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:29      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:30      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:29      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:30      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:29      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:30      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:29      1549          end-if
1550        else
end:28      1550          else
start:29      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:30      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:29      1558          end-if
1559        end-if
end:28      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:27      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:26      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:27      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:28      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:29      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:30      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:29      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:30      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:29      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:30      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:29      1573          end-if
1574        else
end:28      1574          else
start:29      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:30      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:29      1582          end-if
1583        end-if
end:28      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:27      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:26      1526          end-if
1527        end-perform
end:25      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:26      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:25      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1001        perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
end:24      1001          perform 0n99-2016-opt-ip thru 0n99-2016-opt-ip-x
1002        when other
end:23      1002          when other
start:24      1002          when other
1003        go to 0n99-1570-mod-fin-opt-x
start:25      1003          go to 0n99-1570-mod-fin-opt-x
1069    0n99-1570-mod-fin-opt-x.
1070        exit.
1071    0n99-1580-mod-ref-val.
1072        if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
start:26      1072          if w0n99-opt-typ-cl or w0n99-opt-typ-sp or w0n99-opt-typ-sr or w0n99-opt-typ-sl or w0n99-opt-typ-sw
1073        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
start:27      1073          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-n and w0n99-abn-fnd-rcp-n and l0n99-abn-cv-amt > zeroes
1074        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0n99-abn-cv-amt
1075        end-if
end:26      1075          end-if
1076        if w0n99-abe-fnd-dbt-y
start:27      1076          if w0n99-abe-fnd-dbt-y
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:28      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1077        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:27      1077          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1078        set l0o37-rqst-calc to true
1079        set l0o37-ref-val-calc-ind-t to true
1080        move rpol-pol-id to l0o37-pol-id
1081        move l0n99-abn-fnd-id to l0o37-fnd-id
1082        move w0n99-opt-rh-id to l0o37-opt-rh-id
1083        move w0n99-abn-opt-num to l0o37-opt-num
1084        move l0o40-stp-cd to l0o37-stp-cd
1085        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1086        move w0n99-fnd-ref-amt to l0o37-fnd-ref-amt
1087        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
start:28      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:29      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:28      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
1088        perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
end:27      1088          perform 0o37-1000-calc-ref-val thru 0o37-1000-calc-ref-val-x
1089        if not l0o37-retrn-ok or w0n99-cpb-csq-blk
start:28      1089          if not l0o37-retrn-ok or w0n99-cpb-csq-blk
1090        set l0n99-retrn-error to true
1091        move 'sc0n990015' to wglob-msg-ref-info
1092        move rpol-pol-id to wglob-msg-parm(1)
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:29      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:30      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:29      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1093        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:28      1093          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1094        go to 0n99-1580-mod-ref-val-x
start:29      1094          go to 0n99-1580-mod-ref-val-x
1099    0n99-1580-mod-ref-val-x.
1100        exit.
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:30      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:31      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:30      2830          else
start:31      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:30      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:31      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:32      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:33      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:34      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:33      3336          else
start:34      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:33      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:34      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:33      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:32      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:31      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:30      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:29      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:30      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:31      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:32      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:31      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:30      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
start:31      1125          go to 0n99-1590-cvgu-browse-x
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1144    0n99-1600-mod-ref-amt.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
start:32      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
1145        perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
end:31      1145          perform 0o37-1000-build-parm-info thru 0o37-1000-build-parm-info-x
1146        set l0o37-rqst-fetch to true
1147        set l0o37-ref-val-calc-ind-t to true
1148        move rpol-pol-id to l0o37-pol-id
1149        move l0n99-abn-fnd-id to l0o37-fnd-id
1150        move w0n99-abn-opt-num to l0o37-opt-num
1151        move w0n99-stp-cd-5 to l0o37-stp-cd
1152        move l0n99-abn-cv-amt to l0o37-fnd-ref-amt
1153        move w0n99-opt-rh-id to l0o37-opt-rh-id
1154        move l0n99-ope-eff-dt to l0o37-val-ref-appl-strt-dt
1155        move l0o33-opt-sign-dt(w0n99-one) to l0o37-opt-sign-dt
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
start:32      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:33      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:32      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
1156        perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
end:31      1156          perform 0o37-2000-fetch-ref-val thru 0o37-2000-fetch-ref-val-x
1157        if not l0o37-retrn-ok
start:32      1157          if not l0o37-retrn-ok
1158        set l0n99-retrn-error to true
1159        go to 0n99-1600-mod-ref-amt-x
start:33      1159          go to 0n99-1600-mod-ref-amt-x
1179    0n99-1600-mod-ref-amt-x.
1180        exit.
1181    0n99-2010-opt-cl.
1182        move w0n99-opt-rh-id to l0o40-opt-cqt-rh-id
1183        move l0o34-opt-nm to l0o40-opt-nm-cqt
1184        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-cqt
1185        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-cqt-chain-num
1186        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-cqt-mode-cd
1187        move l0o34-xfer-fee-rt to l0o40-cqt-xfer-fee-rt
1188        move zeroes to l0o40-cqt-fnd-xpns-tax-rt
1189        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-cqt
1190        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-cqt
1191        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-cqt-exp-dt
1192        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-cqt-stat-cd
1193        move l0o33-res-opt-ind(w0n99-one) to l0o40-cqt-res-opt-ind
1194        move l0o34-opt-typ-cd to l0o40-cqt-opt-typ-cd
1195        move spaces to l0o40-cqt-opt-cre-ind
1196        move l0o34-cvg-auth-num to l0o40-cqt-auth-num
1197        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-cqt-stat-mtv-cd
1198        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-cqt
1199        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-cqt-mot-sta-opt-nm
1200        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-cqt-bnfy-agre-ind
1201        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-cqt-stl-opt-ind
1202        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-cqt-ope-typ-cd
1203        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:34      1203          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1204        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:35      1204          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
start:36      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:37      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:38      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:37      1226          end-if
1227        else
end:36      1227          else
start:37      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:38      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:37      1234          end-if
1235        end-if
end:36      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1205        perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
end:35      1205          perform 0n99-2010-cl-data-first thru 0n99-2010-cl-data-first-x
1206        end-if
end:34      1206          end-if
1207        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:35      1207          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
start:36      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:37      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:38      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:37      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:38      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:37      1246          else
start:38      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:39      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:38      1249          end-if
1250        end-if
end:37      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:38      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:37      1253          end-if
1254        else
end:36      1254          else
start:37      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:38      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:37      1261          end-if
1262        end-if
end:36      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1208        perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
end:35      1208          perform 0n99-2010-cl-data-second thru 0n99-2010-cl-data-second-x
1209        end-if
end:34      1209          end-if
1210        end-perform
end:33      1210          end-perform
1211        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:34      1211          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1212        move l0n99-abn-fnd-id to l0o40-cqt-fnd-id(w0n99-fnd-num)
1213        move w0n99-fnd-ope-dir-cd to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1214        move w0n99-fnd-rel-rt to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1215        move w0n99-cent to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1216        add w0n99-one to w0n99-fnd-num
1217        end-if
end:33      1217          end-if
1218        move w0n99-opt-num to w0n99-abn-opt-num
1219        continue.
1220    0n99-2010-opt-cl-x.
1221        exit.
1222    0n99-2010-cl-data-first.
1223        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:34      1223          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1224        if w0n99-fnd-ope-dir-cd = spaces
start:35      1224          if w0n99-fnd-ope-dir-cd = spaces
1225        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1226        end-if
end:34      1226          end-if
1227        else
end:33      1227          else
start:34      1227          else
1228        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:35      1228          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1229        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1230        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1231        move l0o33-fnd-rel-rt(w0n99-one, w0n99-one,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1232        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1233        add w0n99-one to w0n99-fnd-num
1234        end-if
end:34      1234          end-if
1235        end-if
end:33      1235          end-if
1236        continue.
1237    0n99-2010-cl-data-first-x.
1238        exit.
1239    0n99-2010-cl-data-second.
1240        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:34      1240          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1241        if w0n99-fnd-ope-dir-cd = spaces
start:35      1241          if w0n99-fnd-ope-dir-cd = spaces
1242        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1243        end-if
end:34      1243          end-if
1244        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:35      1244          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1245        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1246        else
end:34      1246          else
start:35      1246          else
1247        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:36      1247          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1248        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1249        end-if
end:35      1249          end-if
1250        end-if
end:34      1250          end-if
1251        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:35      1251          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1252        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1253        end-if
end:34      1253          end-if
1254        else
end:33      1254          else
start:34      1254          else
1255        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:35      1255          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1256        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-id(w0n99-fnd-num)
1257        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-cqt-ope-dir-cd(w0n99-fnd-num)
1258        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-cqt-fnd-rel-rt(w0n99-fnd-num)
1259        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-cqt(w0n99-fnd-num)
1260        add w0n99-one to w0n99-fnd-num
1261        end-if
end:34      1261          end-if
1262        end-if
end:33      1262          end-if
1263        continue.
1264    0n99-2010-cl-data-second-x.
1265        exit.
1266    0n99-2011-opt-ra.
1267        move w0n99-opt-rh-id to l0o40-opt-rlc-rh-id
1268        move l0o34-opt-nm to l0o40-opt-nm-rlc
1269        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-rlc
1270        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-rlc-chain-num
1271        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-rlc-mode-cd
1272        move l0o34-xfer-fee-rt to l0o40-rlc-xfer-fee-rt
1273        move zeroes to l0o40-rlc-fnd-xpns-tax-rt
1274        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-rlc
1275        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-rlc
1276        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-rlc-exp-dt
1277        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-rlc-stat-cd
1278        move l0o33-res-opt-ind(w0n99-one) to l0o40-rlc-res-opt-ind
1279        move l0o34-opt-typ-cd to l0o40-rlc-opt-typ-cd
1280        move spaces to l0o40-rlc-opt-cre-ind
1281        move l0o34-cvg-auth-num to l0o40-rlc-auth-num
1282        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-rlc-stat-mtv-cd
1283        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-rlc
1284        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-rlc-mot-sta-opt-nm
1285        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-rlc-bnfy-agre-ind
1286        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-rlc-stl-opt-ind
1287        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-rlc-ope-typ-cd
1288        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:34      1288          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1289        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:35      1289          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
start:36      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:37      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:38      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:37      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:38      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:37      1310          end-if
1311        else
end:36      1311          else
start:37      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:38      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:37      1318          end-if
1319        end-if
end:36      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1290        perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
end:35      1290          perform 0n99-2011-ra-data-first thru 0n99-2011-ra-data-first-x
1291        end-if
end:34      1291          end-if
1292        end-perform
end:33      1292          end-perform
1293        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:34      1293          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1294        move l0n99-abn-fnd-id to l0o40-rlc-fnd-id(w0n99-fnd-num)
1295        move w0n99-fnd-ope-dir-cd to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1296        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt (w0n99-one,w0n99-fnd-num)
1297        move w0n99-fnd-pct to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1298        add w0n99-one to w0n99-fnd-num
1299        end-if
end:33      1299          end-if
1300        continue.
1301    0n99-2011-opt-ra-x.
1302        exit.
1303    0n99-2011-ra-data-first.
1304        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:34      1304          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1305        if w0n99-fnd-ope-dir-cd = spaces
start:35      1305          if w0n99-fnd-ope-dir-cd = spaces
1306        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1307        end-if
end:34      1307          end-if
1308        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:35      1308          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1309        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1310        end-if
end:34      1310          end-if
1311        else
end:33      1311          else
start:34      1311          else
1312        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:35      1312          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1313        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-rlc-fnd-id(w0n99-fnd-num)
1314        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-rlc-ope-dir-cd(w0n99-fnd-num)
1315        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1316        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-rlc(w0n99-fnd-num)
1317        add w0n99-one to w0n99-fnd-num
1318        end-if
end:34      1318          end-if
1319        end-if
end:33      1319          end-if
1320        continue.
1321    0n99-2011-ra-data-first-x.
1322        exit.
1323    0n99-2012-opt-sp.
1324        move w0n99-opt-rh-id to l0o40-opt-spv-rh-id
1325        move l0o34-opt-nm to l0o40-opt-nm-spv
1326        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-spv
1327        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-spv-chain-num
1328        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-spv-mode-cd
1329        move l0o34-xfer-fee-rt to l0o40-spv-xfer-fee-rt
1330        move zeroes to l0o40-spv-fnd-xpns-tax-rt
1331        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-spv
1332        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-spv
1333        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-spv-exp-dt
1334        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-spv-stat-cd
1335        move l0o33-res-opt-ind(w0n99-one) to l0o40-spv-res-opt-ind
1336        move l0o34-opt-typ-cd to l0o40-spv-opt-typ-cd
1337        move spaces to l0o40-spv-opt-cre-ind
1338        move l0o34-cvg-auth-num to l0o40-spv-auth-num
1339        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-spv-stat-mtv-cd
1340        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-spv
1341        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-spv-mot-sta-opt-nm
1342        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-spv-bnfy-agre-ind
1343        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-spv-stl-opt-ind
1344        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-spv-ope-typ-cd
1345        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
start:34      1345          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = spaces or low-value
1346        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:35      1346          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
start:36      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:37      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:38      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:37      1368          end-if
1369        else
end:36      1369          else
start:37      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:38      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:37      1376          end-if
1377        end-if
end:36      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1347        perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
end:35      1347          perform 0n99-2012-sp-data-first thru 0n99-2012-sp-data-first-x
1348        end-if
end:34      1348          end-if
1349        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:35      1349          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
start:36      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:37      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:38      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:37      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:38      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:37      1388          else
start:38      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:39      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:38      1391          end-if
1392        end-if
end:37      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:38      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:37      1395          end-if
1396        else
end:36      1396          else
start:37      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:38      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:37      1403          end-if
1404        end-if
end:36      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1350        perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
end:35      1350          perform 0n99-2012-sp-data-second thru 0n99-2012-sp-data-second-x
1351        end-if
end:34      1351          end-if
1352        end-perform
end:33      1352          end-perform
1353        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:34      1353          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1354        move l0n99-abn-fnd-id to l0o40-spv-fnd-id(w0n99-fnd-num)
1355        move w0n99-fnd-ope-dir-cd to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1356        move w0n99-fnd-rel-rt to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1357        move w0n99-cent to l0o40-fnd-pct-spv(w0n99-fnd-num)
1358        add w0n99-one to w0n99-fnd-num
1359        end-if
end:33      1359          end-if
1360        move w0n99-opt-num to w0n99-abn-opt-num
1361        continue.
1362    0n99-2012-opt-sp-x.
1363        exit.
1364    0n99-2012-sp-data-first.
1365        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:34      1365          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1366        if w0n99-fnd-ope-dir-cd = spaces
start:35      1366          if w0n99-fnd-ope-dir-cd = spaces
1367        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1368        end-if
end:34      1368          end-if
1369        else
end:33      1369          else
start:34      1369          else
1370        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:35      1370          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1371        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1372        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1373        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1374        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1375        add w0n99-one to w0n99-fnd-num
1376        end-if
end:34      1376          end-if
1377        end-if
end:33      1377          end-if
1378        continue.
1379    0n99-2012-sp-data-first-x.
1380        exit.
1381    0n99-2012-sp-data-second.
1382        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:34      1382          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1383        if w0n99-fnd-ope-dir-cd = spaces
start:35      1383          if w0n99-fnd-ope-dir-cd = spaces
1384        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1385        end-if
end:34      1385          end-if
1386        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
start:35      1386          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) =l0n99-abn-fnd-id
1387        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1388        else
end:34      1388          else
start:35      1388          else
1389        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
start:36      1389          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id and w0n99-fnd-rel-rt = zeroes
1390        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to w0n99-fnd-rel-rt
1391        end-if
end:35      1391          end-if
1392        end-if
end:34      1392          end-if
1393        if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
start:35      1393          if l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx) > zeroes
1394        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + l0o33-fnd-ref-amt(w0n99-one,w0n99-two,xx)
1395        end-if
end:34      1395          end-if
1396        else
end:33      1396          else
start:34      1396          else
1397        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:35      1397          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1398        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-id(w0n99-fnd-num)
1399        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-spv-ope-dir-cd(w0n99-fnd-num)
1400        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-spv-fnd-rel-rt(w0n99-fnd-num)
1401        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-spv(w0n99-fnd-num)
1402        add w0n99-one to w0n99-fnd-num
1403        end-if
end:34      1403          end-if
1404        end-if
end:33      1404          end-if
1405        continue.
1406    0n99-2012-sp-data-second-x.
1407        exit.
1408    0n99-2013-opt-sr.
1409        move w0n99-opt-rh-id to l0o40-opt-stf-rh-id
1410        move l0o34-opt-nm to l0o40-opt-nm-stf
1411        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stf
1412        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stf-chain-num
1413        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stf-mode-cd
1414        move l0o34-xfer-fee-rt to l0o40-stf-xfer-fee-rt
1415        move zeroes to l0o40-stf-fnd-xpns-tax-rt
1416        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stf
1417        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stf
1418        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stf-exp-dt
1419        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stf-stat-cd
1420        move l0o33-res-opt-ind(w0n99-one) to l0o40-stf-res-opt-ind
1421        move l0o34-opt-typ-cd to l0o40-stf-opt-typ-cd
1422        move spaces to l0o40-stf-opt-cre-ind
1423        move l0o34-cvg-auth-num to l0o40-stf-auth-num
1424        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stf-stat-mtv-cd
1425        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stf
1426        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stf-mot-sta-opt-nm
1427        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stf-bnfy-agre-ind
1428        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stf-stl-opt-ind
1429        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stf-ope-typ-cd
1430        perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
start:34      1430          perform varying i from 1 by 1 until l0o40-stf-fnd-id(i) = spaces
1431        initialize l0o40-don-uct-stf(i)
1432        end-perform
end:33      1432          end-perform
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:34      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:35      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:36      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:35      2830          else
start:36      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:35      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:36      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:37      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:39      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:38      3336          else
start:39      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:38      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:38      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:37      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:36      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:35      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:34      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:35      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:36      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:37      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:36      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:35      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:34      1125          go to 0n99-1590-cvgu-browse-x
start:35      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:34      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:35      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:36      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:37      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:39      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:38      3336          else
start:39      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:38      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:38      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:37      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:36      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:35      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:34      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:35      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:36      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:37      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:38      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:39      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:40      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:41      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:42      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:41      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:40      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:40      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:39      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:38      1591          go to 0n99-3010-stop-win-x
start:39      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:38      1592          end-if
1593        if w0n99-ope-dir-entree
start:39      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:40      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:41      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:40      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:41      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:40      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:39      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:38      1595          else
start:39      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:40      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:41      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:40      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:41      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:40      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:41      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:40      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:39      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:38      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:39      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:38      1600          end-if
1601        end-if
end:37      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:36      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:35      1133          when w0n99-opt-typ-sl
start:36      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:37      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:38      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:39      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:40      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:41      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:42      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:41      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:40      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:40      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:39      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:38      1702          go to 0n99-3020-stop-loss-x
start:39      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:38      1703          end-if
1704        if w0n99-ope-dir-entree
start:39      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:40      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:41      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:40      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:41      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:40      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:39      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:38      1706          else
start:39      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:40      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:41      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:40      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:41      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:40      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:41      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:40      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:39      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:38      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:39      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:38      1711          end-if
1712        end-if
end:37      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:36      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:35      1135          when w0n99-opt-typ-sr
start:36      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:37      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:38      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:39      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:40      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:41      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:42      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:41      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:40      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:40      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:39      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:38      1813          go to 0n99-3030-stop-lr-x
start:39      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:38      1814          end-if
1815        if w0n99-ope-dir-entree
start:39      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:40      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:41      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:40      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:41      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:40      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:39      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:38      1817          else
start:39      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:40      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:41      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:40      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:41      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:40      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:41      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:40      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:39      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:38      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:39      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:38      1822          end-if
1823        end-if
end:37      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:36      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:35      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:36      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:37      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:38      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:39      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:40      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:39      3336          else
start:40      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:39      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:40      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:37      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:36      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:35      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:34      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:35      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:36      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:37      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:39      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:38      3336          else
start:39      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:38      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:38      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:37      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:36      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:35      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:34      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1433        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:33      1433          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
start:34      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:35      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:34      1906          end-if
1907        if w0n99-fl-abe-y
start:35      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:34      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1434        perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
end:33      1434          perform 0n99-1590-stop-lr thru 0n99-1590-stop-lr-x
1435        continue.
1436    0n99-2013-opt-sr-x.
1437        exit.
1438    0n99-2014-opt-sl.
1439        move w0n99-opt-rh-id to l0o40-opt-stl-rh-id
1440        move l0o34-opt-nm to l0o40-opt-nm-stl
1441        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stl
1442        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stl-chain-num
1443        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stl-mode-cd
1444        move l0o34-xfer-fee-rt to l0o40-stl-xfer-fee-rt
1445        move zeroes to l0o40-stl-fnd-xpns-tax-rt
1446        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stl
1447        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stl
1448        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stl-exp-dt
1449        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stl-stat-cd
1450        move l0o33-res-opt-ind(w0n99-one) to l0o40-stl-res-opt-ind
1451        move l0o34-opt-typ-cd to l0o40-stl-opt-typ-cd
1452        move spaces to l0o40-stl-opt-cre-ind
1453        move l0o34-cvg-auth-num to l0o40-stl-auth-num
1454        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stl-stat-mtv-cd
1455        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stl
1456        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stl-mot-sta-opt-nm
1457        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stl-bnfy-agre-ind
1458        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stl-stl-opt-ind
1459        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stl-ope-typ-cd
1460        perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
start:34      1460          perform varying i from 1 by 1 until l0o40-stl-fnd-id(i) = spaces
1461        initialize l0o40-don-uct-stl(i)
1462        end-perform
end:33      1462          end-perform
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:34      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:35      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:36      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:35      2830          else
start:36      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:35      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:36      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:37      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:39      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:38      3336          else
start:39      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:38      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:38      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:37      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:36      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:35      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:34      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:35      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:36      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:37      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:36      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:35      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:34      1125          go to 0n99-1590-cvgu-browse-x
start:35      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:34      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:35      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:36      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:37      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:39      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:38      3336          else
start:39      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:38      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:38      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:37      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:36      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:35      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:34      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:35      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:36      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:37      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:38      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:39      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:40      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:41      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:42      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:41      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:40      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:40      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:39      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:38      1591          go to 0n99-3010-stop-win-x
start:39      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:38      1592          end-if
1593        if w0n99-ope-dir-entree
start:39      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:40      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:41      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:40      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:41      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:40      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:39      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:38      1595          else
start:39      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:40      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:41      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:40      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:41      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:40      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:41      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:40      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:39      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:38      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:39      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:38      1600          end-if
1601        end-if
end:37      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:36      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:35      1133          when w0n99-opt-typ-sl
start:36      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:37      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:38      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:39      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:40      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:41      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:42      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:41      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:40      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:40      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:39      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:38      1702          go to 0n99-3020-stop-loss-x
start:39      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:38      1703          end-if
1704        if w0n99-ope-dir-entree
start:39      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:40      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:41      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:40      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:41      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:40      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:39      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:38      1706          else
start:39      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:40      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:41      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:40      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:41      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:40      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:41      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:40      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:39      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:38      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:39      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:38      1711          end-if
1712        end-if
end:37      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:36      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:35      1135          when w0n99-opt-typ-sr
start:36      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:37      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:38      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:39      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:40      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:41      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:42      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:41      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:40      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:40      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:39      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:38      1813          go to 0n99-3030-stop-lr-x
start:39      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:38      1814          end-if
1815        if w0n99-ope-dir-entree
start:39      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:40      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:41      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:40      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:41      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:40      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:39      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:38      1817          else
start:39      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:40      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:41      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:40      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:41      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:40      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:41      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:40      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:39      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:38      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:39      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:38      1822          end-if
1823        end-if
end:37      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:36      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:35      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:36      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:37      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:38      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:39      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:40      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:39      3336          else
start:40      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:39      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:40      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:37      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:36      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:35      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:34      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:35      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:36      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:37      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:39      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:38      3336          else
start:39      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:38      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:38      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:37      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:36      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:35      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:34      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1463        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:33      1463          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
start:34      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:35      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:34      1795          end-if
1796        if w0n99-fl-abe-y
start:35      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:34      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1464        perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
end:33      1464          perform 0n99-1590-stop-loss thru 0n99-1590-stop-loss-x
1465        continue.
1466    0n99-2014-opt-sl-x.
1467        exit.
1468    0n99-2015-opt-sw.
1469        move w0n99-opt-rh-id to l0o40-opt-stw-rh-id
1470        move l0o34-opt-nm to l0o40-opt-nm-stw
1471        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-stw
1472        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-stw-chain-num
1473        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-stw-mode-cd
1474        move l0o34-xfer-fee-rt to l0o40-stw-xfer-fee-rt
1475        move zeroes to l0o40-stw-fnd-xpns-tax-rt
1476        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-stw
1477        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs-stw
1478        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-stw-exp-dt
1479        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-stw-stat-cd
1480        move l0o33-res-opt-ind(w0n99-one) to l0o40-stw-res-opt-ind
1481        move l0o34-opt-typ-cd to l0o40-stw-opt-typ-cd
1482        move spaces to l0o40-stw-opt-cre-ind
1483        move l0o34-cvg-auth-num to l0o40-stw-auth-num
1484        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-stw-stat-mtv-cd
1485        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-stw
1486        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-stw-mot-sta-opt-nm
1487        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-stw-bnfy-agre-ind
1488        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-stw-stl-opt-ind
1489        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-stw-ope-typ-cd
1490        perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
start:34      1490          perform varying i from 1 by 1 until l0o40-stw-fnd-id(i) = spaces
1491        initialize l0o40-don-uct-stw(i)
1492        end-perform
end:33      1492          end-perform
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
start:34      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1101    0n99-1590-cvgu-browse.
1102        set w0n99-fl-abe-pr-n to true
1103        set w0n99-fl-abe-n to true
1104        move w0n99-one to w0n99-fnd-num
1105        move w0n99-ope-dir-cd to w0n99-fnd-ope-dir-cd
1106        move low-values to wcvgu-key
1107        move high-values to wcvgu-endbr-key
1108        move rpol-pol-id to wcvgu-pol-id
1109        move rpol-pol-base-cvg-num to wcvgu-cvg-num-n
1110        move zeroes to wcvgu-opt-chain-num
1111        move w0n99-opt-rh-id to wcvgu-opt-rh-id
1112        move zeroes to wcvgu-opt-num
1113        move low-values to wcvgu-fnd-id
1114        move low-values to wcvgu-ope-dir-cd
1115        move wcvgu-key to wcvgu-endbr-key
1116        move 99 to wcvgu-endbr-opt-num
1117        move high-values to wcvgu-endbr-fnd-id
1118        move high-values to wcvgu-endbr-ope-dir-cd
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
start:35      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:36      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:35      2830          else
start:36      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:35      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:36      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:37      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:39      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:38      3336          else
start:39      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:38      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:38      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:37      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:36      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:35      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
1119        perform cvgu-1000-browse thru cvgu-1000-browse-x
end:34      1119          perform cvgu-1000-browse thru cvgu-1000-browse-x
1120        if not wcvgu-io-ok
start:35      1120          if not wcvgu-io-ok
1121        set l0n99-retrn-error to true
1122        move 'sc0n990016' to wglob-msg-ref-info
1123        move rpol-pol-id to wglob-msg-parm(1)
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
start:36      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:37      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:36      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
1124        perform 0260-1000-generate-message thru 0260-1000-generate-message-x
end:35      1124          perform 0260-1000-generate-message thru 0260-1000-generate-message-x
1125        go to 0n99-1590-cvgu-browse-x
end:34      1125          go to 0n99-1590-cvgu-browse-x
start:35      1125          go to 0n99-1590-cvgu-browse-x
1126        end-if
end:34      1126          end-if
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:35      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:36      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:37      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:39      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:38      3336          else
start:39      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:38      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:38      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:37      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:36      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:35      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1127        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:34      1127          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1128        add w0n99-one to w0n99-new-opt-num
1129        perform until wcvgu-io-eof or not wcvgu-io-ok
start:35      1129          perform until wcvgu-io-eof or not wcvgu-io-ok
1130        evaluate true
start:36      1131          when w0n99-opt-typ-sw
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
start:37      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:38      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:39      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:40      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:41      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:42      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:41      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:40      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:40      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:39      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
end:38      1591          go to 0n99-3010-stop-win-x
start:39      1591          go to 0n99-3010-stop-win-x
1592        end-if
end:38      1592          end-if
1593        if w0n99-ope-dir-entree
start:39      1593          if w0n99-ope-dir-entree
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
start:40      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:41      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:40      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:41      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:40      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1594        perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
end:39      1594          perform 0n99-3012-sw-entre thru 0n99-3012-sw-entre-x
1595        else
end:38      1595          else
start:39      1595          else
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
start:40      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:41      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:40      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:41      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:40      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:41      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:40      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1596        perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
end:39      1596          perform 0n99-3011-sw-sorte thru 0n99-3011-sw-sorte-x
1597        end-if
end:38      1597          end-if
1598        if rcvgu-ope-dir-cd-s
start:39      1598          if rcvgu-ope-dir-cd-s
1599        add w0n99-one to w0n99-new-opt-num
1600        end-if
end:38      1600          end-if
1601        end-if
end:37      1601          end-if
1602        continue.
1603    0n99-3010-stop-win-x.
1604        exit.
1132        perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
end:36      1132          perform 0n99-3010-stop-win thru 0n99-3010-stop-win-x
1133        when w0n99-opt-typ-sl
end:35      1133          when w0n99-opt-typ-sl
start:36      1133          when w0n99-opt-typ-sl
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
start:37      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:38      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:39      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:40      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:41      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:42      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:41      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:40      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:40      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:39      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
end:38      1702          go to 0n99-3020-stop-loss-x
start:39      1702          go to 0n99-3020-stop-loss-x
1703        end-if
end:38      1703          end-if
1704        if w0n99-ope-dir-entree
start:39      1704          if w0n99-ope-dir-entree
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
start:40      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:41      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:40      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:41      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:40      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1705        perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
end:39      1705          perform 0n99-3022-sl-entre thru 0n99-3022-sl-entre-x
1706        else
end:38      1706          else
start:39      1706          else
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
start:40      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:41      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:40      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:41      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:40      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:41      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:40      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1707        perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
end:39      1707          perform 0n99-3021-sl-sorte thru 0n99-3021-sl-sorte-x
1708        end-if
end:38      1708          end-if
1709        if rcvgu-ope-dir-cd-s
start:39      1709          if rcvgu-ope-dir-cd-s
1710        add w0n99-one to w0n99-new-opt-num
1711        end-if
end:38      1711          end-if
1712        end-if
end:37      1712          end-if
1713        continue.
1714    0n99-3020-stop-loss-x.
1715        exit.
1134        perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
end:36      1134          perform 0n99-3020-stop-loss thru 0n99-3020-stop-loss-x
1135        when w0n99-opt-typ-sr
end:35      1135          when w0n99-opt-typ-sr
start:36      1135          when w0n99-opt-typ-sr
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
start:37      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:38      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:39      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:40      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:41      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:42      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:41      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:40      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:40      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:39      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
end:38      1813          go to 0n99-3030-stop-lr-x
start:39      1813          go to 0n99-3030-stop-lr-x
1814        end-if
end:38      1814          end-if
1815        if w0n99-ope-dir-entree
start:39      1815          if w0n99-ope-dir-entree
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
start:40      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:41      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:40      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:41      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:40      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1816        perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
end:39      1816          perform 0n99-3032-sr-entre thru 0n99-3032-sr-entre-x
1817        else
end:38      1817          else
start:39      1817          else
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
start:40      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:41      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:40      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:41      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:40      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:41      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:40      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1818        perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
end:39      1818          perform 0n99-3031-sr-sorte thru 0n99-3031-sr-sorte-x
1819        end-if
end:38      1819          end-if
1820        if rcvgu-ope-dir-cd-s
start:39      1820          if rcvgu-ope-dir-cd-s
1821        add w0n99-one to w0n99-new-opt-num
1822        end-if
end:38      1822          end-if
1823        end-if
end:37      1823          end-if
1824        continue.
1825    0n99-3030-stop-lr-x.
1826        exit.
1136        perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
end:36      1136          perform 0n99-3030-stop-lr thru 0n99-3030-stop-lr-x
1137        end-evaluate
end:35      1137          end-evaluate
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
start:36      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:37      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:38      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:39      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:40      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:39      3336          else
start:40      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:39      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:40      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:37      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:36      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
1138        perform cvgu-2000-read-next thru cvgu-2000-read-next-x
end:35      1138          perform cvgu-2000-read-next thru cvgu-2000-read-next-x
1139        end-perform
end:34      1139          end-perform
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
start:35      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:36      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:37      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:38      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:39      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:38      3336          else
start:39      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:38      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:39      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:38      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:37      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:36      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:35      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
1140        perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
end:34      1140          perform cvgu-3000-end-browse thru cvgu-3000-end-browse-x
1141        continue.
1142    0n99-1590-cvgu-browse-x.
1143        exit.
1493        perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
end:33      1493          perform 0n99-1590-cvgu-browse thru 0n99-1590-cvgu-browse-x
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
start:34      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:35      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:34      1684          end-if
1685        if w0n99-fl-abe-y
start:35      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:34      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1494        perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
end:33      1494          perform 0n99-1590-stop-win thru 0n99-1590-stop-win-x
1495        continue.
1496    0n99-2015-opt-sw-x.
1497        exit.
1498    0n99-2016-opt-ip.
1499        move w0n99-opt-rh-id to l0o40-opt-pgs-rh-id
1500        move l0o34-opt-nm to l0o40-opt-nm-pgs
1501        move l0o33-opt-eff-dt(w0n99-one) to l0o40-opt-eff-dt-pgs
1502        move l0o33-opt-chain-num(w0n99-one) to l0o40-opt-pgs-chain-num
1503        move l0o33-opt-mode-cd(w0n99-one) to l0o40-opt-pgs-mode-cd
1504        move l0o34-xfer-fee-rt to l0o40-pgs-xfer-fee-rt
1505        move zeroes to l0o40-pgs-fnd-xpns-tax-rt
1506        move l0o33-opt-dur(w0n99-one) to l0o40-opt-dur-pgs
1507        move l0o34-opt-dur-cd to l0o40-opt-dur-cd-pgs
1508        move l0o33-opt-exp-dt(w0n99-one) to l0o40-opt-pgs-exp-dt
1509        move l0o33-opt-stat-cd(w0n99-one) to l0o40-opt-pgs-stat-cd
1510        move l0o33-res-opt-ind(w0n99-one) to l0o40-pgs-res-opt-ind
1511        move l0o34-opt-typ-cd to l0o40-pgs-opt-typ-cd
1512        move spaces to l0o40-pgs-opt-cre-ind
1513        move l0o34-cvg-auth-num to l0o40-pgs-auth-num
1514        move l0o33-opt-stat-mtv-cd(w0n99-one) to l0o40-pgs-stat-mtv-cd
1515        move l0o33-manag-obj-text(w0n99-one) to l0o40-trd-opt-nm-pgs
1516        move l0o33-mot-sta-opt-nm(w0n99-one) to l0o40-pgs-mot-sta-opt-nm
1517        move l0o33-bnfy-agre-ind(w0n99-one) to l0o40-pgs-bnfy-agre-ind
1518        move l0o33-stl-typ-opt-ind(w0n99-one) to l0o40-pgs-stl-opt-ind
1519        move l0o33-opt-ope-typ-cd(w0n99-one) to l0o40-pgs-ope-typ-cd
1520        perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
start:34      1520          perform varying xx from 1 by 1 until xx > wglob-max-fnd-opt-sel or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = spaces or low-value
1521        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
start:35      1521          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-one,xx)
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
start:36      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:37      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:38      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:37      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:38      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:37      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:38      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:37      1549          end-if
1550        else
end:36      1550          else
start:37      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:38      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:37      1558          end-if
1559        end-if
end:36      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1522        perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
end:35      1522          perform 0n99-2016-ip-data-first thru 0n99-2016-ip-data-first-x
1523        end-if
end:34      1523          end-if
1524        if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
start:35      1524          if l0o33-opt-fnd-stat-act(w0n99-one,w0n99-two,xx)
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
start:36      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:37      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:38      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:37      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:38      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:37      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:38      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:37      1573          end-if
1574        else
end:36      1574          else
start:37      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:38      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:37      1582          end-if
1583        end-if
end:36      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1525        perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
end:35      1525          perform 0n99-2016-ip-data-second thru 0n99-2016-ip-data-second-x
1526        end-if
end:34      1526          end-if
1527        end-perform
end:33      1527          end-perform
1528        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:34      1528          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1529        move l0n99-abn-fnd-id to l0o40-pgs-fnd-id(w0n99-fnd-num)
1530        move w0n99-fnd-ope-dir-cd to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1531        move w0n99-fnd-rel-rt to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1532        move w0n99-fnd-pct to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1533        move w0n99-fnd-amt to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1534        add w0n99-one to w0n99-fnd-num
1535        end-if
end:33      1535          end-if
1536        continue.
1537    0n99-2016-opt-ip-x.
1538        exit.
1539    0n99-2016-ip-data-first.
1540        if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
start:34      1540          if l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-one,xx) = l0n99-abn-fnd-id
1541        if w0n99-fnd-ope-dir-cd = spaces
start:35      1541          if w0n99-fnd-ope-dir-cd = spaces
1542        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to w0n99-fnd-ope-dir-cd
1543        end-if
end:34      1543          end-if
1544        if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
start:35      1544          if l0o33-fnd-pct(w0n99-one,w0n99-one,xx) > zeroes
1545        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-one,xx)
1546        end-if
end:34      1546          end-if
1547        if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
start:35      1547          if l0o33-fnd-amt(w0n99-one,w0n99-one,xx) > zeroes
1548        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-one,xx)
1549        end-if
end:34      1549          end-if
1550        else
end:33      1550          else
start:34      1550          else
1551        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:35      1551          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1552        move l0o33-fnd-id(w0n99-one,w0n99-one,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1553        move l0o33-ope-dir-cd(w0n99-one,w0n99-one) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1554        move l0o33-fnd-rel-rt(w0n99-one,w0n99-one,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1555        move l0o33-fnd-pct(w0n99-one,w0n99-one,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1556        move l0o33-fnd-amt(w0n99-one,w0n99-one,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1557        add w0n99-one to w0n99-fnd-num
1558        end-if
end:34      1558          end-if
1559        end-if
end:33      1559          end-if
1560        continue.
1561    0n99-2016-ip-data-first-x.
1562        exit.
1563    0n99-2016-ip-data-second.
1564        if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
start:34      1564          if l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abe-fnd-id or l0o33-fnd-id(w0n99-one,w0n99-two,xx) = l0n99-abn-fnd-id
1565        if w0n99-fnd-ope-dir-cd = spaces
start:35      1565          if w0n99-fnd-ope-dir-cd = spaces
1566        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to w0n99-fnd-ope-dir-cd
1567        end-if
end:34      1567          end-if
1568        if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
start:35      1568          if l0o33-fnd-pct(w0n99-one,w0n99-two,xx) >zeroes
1569        compute w0n99-fnd-pct = w0n99-fnd-pct + l0o33-fnd-pct(w0n99-one,w0n99-two,xx)
1570        end-if
end:34      1570          end-if
1571        if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
start:35      1571          if l0o33-fnd-amt(w0n99-one,w0n99-two,xx) >zeroes
1572        compute w0n99-fnd-amt = w0n99-fnd-amt + l0o33-fnd-amt(w0n99-one,w0n99-two,xx)
1573        end-if
end:34      1573          end-if
1574        else
end:33      1574          else
start:34      1574          else
1575        if w0n99-fnd-num <= wglob-max-fnd-opt-sel
start:35      1575          if w0n99-fnd-num <= wglob-max-fnd-opt-sel
1576        move l0o33-fnd-id(w0n99-one,w0n99-two,xx) to l0o40-pgs-fnd-id(w0n99-fnd-num)
1577        move l0o33-ope-dir-cd(w0n99-one,w0n99-two) to l0o40-pgs-ope-dir-cd(w0n99-fnd-num)
1578        move l0o33-fnd-rel-rt(w0n99-one,w0n99-two,xx) to l0o40-fnd-rel-rt(w0n99-one,w0n99-fnd-num)
1579        move l0o33-fnd-pct(w0n99-one,w0n99-two,xx) to l0o40-fnd-pct-pgs(w0n99-fnd-num)
1580        move l0o33-fnd-amt(w0n99-one,w0n99-two,xx) to l0o40-fnd-amt-pgs(w0n99-fnd-num)
1581        add w0n99-one to w0n99-fnd-num
1582        end-if
end:34      1582          end-if
1583        end-if
end:33      1583          end-if
1584        continue.
1585    0n99-2016-ip-data-second-x.
1586        exit.
1587    0n99-3010-stop-win.
1588        if rcvgu-opt-fnd-stat-cd-a
start:34      1588          if rcvgu-opt-fnd-stat-cd-a
1589        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:35      1589          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
start:36      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:37      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:38      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:37      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:36      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:37      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:36      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1590        perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
end:35      1590          perform 0n99-3013-lapse-pair-sw thru 0n99-3013-lapse-pair-sw-x
1591        go to 0n99-3010-stop-win-x
start:36      1591          go to 0n99-3010-stop-win-x
1603    0n99-3010-stop-win-x.
1604        exit.
1605    0n99-3011-sw-sorte.
1606        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:37      1606          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1607        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1608        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1609        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1610        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1611        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1612        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1613        add 1 to w0n99-fnd-num
1614        end-if
end:36      1614          end-if
1615        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:37      1615          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1616        set w0n99-fl-abe-pr-y to true
1617        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1618        move spaces to w0n99-abe-pr-long-desc
1619        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1620        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1621        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1622        end-if
end:36      1622          end-if
1623        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:37      1623          if rcvgu-fnd-id = l0n99-abe-fnd-id
1624        set w0n99-fl-abe-y to true
1625        move spaces to w0n99-abe-long-desc
1626        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1627        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1628        move w0n99-cent to w0n99-abe-fnd-pct
1629        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1630        end-if
end:36      1630          end-if
1631        continue.
1632    0n99-3011-sw-sorte-x.
1633        exit.
1634    0n99-3012-sw-entre.
1635        if rcvgu-ope-dir-cd-s
start:37      1635          if rcvgu-ope-dir-cd-s
1636        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1637        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1638        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1639        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1640        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1641        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1642        add w0n99-one to w0n99-fnd-num
1643        end-if
end:36      1643          end-if
1644        if rcvgu-ope-dir-cd-e
start:37      1644          if rcvgu-ope-dir-cd-e
1645        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1646        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1647        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1648        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1649        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1650        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1651        add w0n99-one to w0n99-fnd-num
1652        end-if
end:36      1652          end-if
1653        continue.
1654    0n99-3012-sw-entre-x.
1655        exit.
1656    0n99-3013-lapse-pair-sw.
1657        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:37      1657          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1658        move rcvgu-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1659        move spaces to l0o40-long-desc-stw(w0n99-fnd-num)
1660        move rcvgu-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1661        move rcvgu-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1662        move rcvgu-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1663        move rcvgu-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1664        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:38      1664          if rcvgu-fnd-id = l0n99-abn-fnd-id
1665        move rcvgu-opt-num to w0n99-new-opt-num
1666        end-if
end:37      1666          end-if
1667        add w0n99-one to w0n99-fnd-num
1668        end-if
end:36      1668          end-if
1669        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:37      1669          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1670        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1671        end-if
end:36      1671          end-if
1672        continue.
1673    0n99-3013-lapse-pair-sw-x.
1674        exit.
1675    0n99-1590-stop-win.
1676        if w0n99-fl-abe-pr-y
start:37      1676          if w0n99-fl-abe-pr-y
1677        move w0n99-abe-pr-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1678        move w0n99-abe-pr-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1679        move w0n99-abe-pr-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1680        move w0n99-abe-pr-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1681        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1682        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1683        add w0n99-one to w0n99-fnd-num
1684        end-if
end:36      1684          end-if
1685        if w0n99-fl-abe-y
start:37      1685          if w0n99-fl-abe-y
1686        move l0n99-abn-fnd-id to l0o40-stw-fnd-id(w0n99-fnd-num)
1687        move w0n99-abe-long-desc to l0o40-long-desc-stw(w0n99-fnd-num)
1688        move w0n99-abe-ope-dir-cd to l0o40-stw-ope-dir-cd(w0n99-fnd-num)
1689        move w0n99-abe-fnd-rel-rt to l0o40-stw-fnd-rel-rt(w0n99-fnd-num)
1690        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stw(w0n99-fnd-num)
1691        move w0n99-new-opt-num to l0o40-stw-opt-num(w0n99-fnd-num)
1692        add w0n99-one to w0n99-fnd-num
1693        end-if
end:36      1693          end-if
1694        move w0n99-new-opt-num to w0n99-abn-opt-num
1695        continue.
1696    0n99-1590-stop-win-x.
1697        exit.
1698    0n99-3020-stop-loss.
1699        if rcvgu-opt-fnd-stat-cd-a
start:37      1699          if rcvgu-opt-fnd-stat-cd-a
1700        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:38      1700          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
start:39      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:40      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:40      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:39      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:40      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:39      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1701        perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
end:38      1701          perform 0n99-3023-lapse-pair-sl thru 0n99-3023-lapse-pair-sl-x
1702        go to 0n99-3020-stop-loss-x
start:39      1702          go to 0n99-3020-stop-loss-x
1714    0n99-3020-stop-loss-x.
1715        exit.
1716    0n99-3021-sl-sorte.
1717        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:40      1717          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1718        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1719        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1720        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1721        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1722        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1723        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1724        add w0n99-one to w0n99-fnd-num
1725        end-if
end:39      1725          end-if
1726        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:40      1726          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1727        set w0n99-fl-abe-pr-y to true
1728        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1729        move spaces to w0n99-abe-pr-long-desc
1730        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1731        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1732        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1733        end-if
end:39      1733          end-if
1734        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:40      1734          if rcvgu-fnd-id = l0n99-abe-fnd-id
1735        set w0n99-fl-abe-y to true
1736        move spaces to w0n99-abe-long-desc
1737        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1738        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1739        move w0n99-cent to w0n99-abe-fnd-pct
1740        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1741        end-if
end:39      1741          end-if
1742        continue.
1743    0n99-3021-sl-sorte-x.
1744        exit.
1745    0n99-3022-sl-entre.
1746        if rcvgu-ope-dir-cd-s
start:40      1746          if rcvgu-ope-dir-cd-s
1747        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1748        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1749        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1750        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1751        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1752        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1753        add w0n99-one to w0n99-fnd-num
1754        end-if
end:39      1754          end-if
1755        if rcvgu-ope-dir-cd-e
start:40      1755          if rcvgu-ope-dir-cd-e
1756        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1757        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1758        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1759        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1760        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1761        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1762        add w0n99-one to w0n99-fnd-num
1763        end-if
end:39      1763          end-if
1764        continue.
1765    0n99-3022-sl-entre-x.
1766        exit.
1767    0n99-3023-lapse-pair-sl.
1768        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:40      1768          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1769        move rcvgu-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1770        move spaces to l0o40-long-desc-stl(w0n99-fnd-num)
1771        move rcvgu-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1772        move rcvgu-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1773        move rcvgu-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1774        move rcvgu-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1775        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:41      1775          if rcvgu-fnd-id = l0n99-abn-fnd-id
1776        move rcvgu-opt-num to w0n99-new-opt-num
1777        end-if
end:40      1777          end-if
1778        add w0n99-one to w0n99-fnd-num
1779        end-if
end:39      1779          end-if
1780        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:40      1780          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1781        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1782        end-if
end:39      1782          end-if
1783        continue.
1784    0n99-3023-lapse-pair-sl-x.
1785        exit.
1786    0n99-1590-stop-loss.
1787        if w0n99-fl-abe-pr-y
start:40      1787          if w0n99-fl-abe-pr-y
1788        move w0n99-abe-pr-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1789        move w0n99-abe-pr-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1790        move w0n99-abe-pr-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1791        move w0n99-abe-pr-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1792        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1793        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1794        add w0n99-one to w0n99-fnd-num
1795        end-if
end:39      1795          end-if
1796        if w0n99-fl-abe-y
start:40      1796          if w0n99-fl-abe-y
1797        move l0n99-abn-fnd-id to l0o40-stl-fnd-id(w0n99-fnd-num)
1798        move w0n99-abe-long-desc to l0o40-long-desc-stl(w0n99-fnd-num)
1799        move w0n99-abe-ope-dir-cd to l0o40-stl-ope-dir-cd(w0n99-fnd-num)
1800        move w0n99-abe-fnd-rel-rt to l0o40-stl-fnd-rel-rt(w0n99-fnd-num)
1801        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stl(w0n99-fnd-num)
1802        move w0n99-new-opt-num to l0o40-stl-opt-num(w0n99-fnd-num)
1803        add w0n99-one to w0n99-fnd-num
1804        end-if
end:39      1804          end-if
1805        move w0n99-new-opt-num to w0n99-abn-opt-num
1806        continue.
1807    0n99-1590-stop-loss-x.
1808        exit.
1809    0n99-3030-stop-lr.
1810        if rcvgu-opt-fnd-stat-cd-a
start:40      1810          if rcvgu-opt-fnd-stat-cd-a
1811        if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
start:41      1811          if w0n99-abe-fnd-dbt-y and w0n99-abn-fnd-dbt-y
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
start:42      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:43      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:44      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:43      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:42      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:43      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:42      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1812        perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
end:41      1812          perform 0n99-3033-lapse-pair-sr thru 0n99-3033-lapse-pair-sr-x
1813        go to 0n99-3030-stop-lr-x
start:42      1813          go to 0n99-3030-stop-lr-x
1825    0n99-3030-stop-lr-x.
1826        exit.
1827    0n99-3031-sr-sorte.
1828        if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
start:43      1828          if (rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-fnd-id not = l0n99-abn-fnd-id and rcvgu-opt-num not = w0n99-opt-num)
1829        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1830        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1831        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1832        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1833        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1834        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1835        add w0n99-one to w0n99-fnd-num
1836        end-if
end:42      1836          end-if
1837        if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
start:43      1837          if rcvgu-opt-num = w0n99-opt-num and rcvgu-fnd-id not = l0n99-abe-fnd-id
1838        set w0n99-fl-abe-pr-y to true
1839        move rcvgu-fnd-id to w0n99-abe-pr-fnd-id
1840        move spaces to w0n99-abe-pr-long-desc
1841        move rcvgu-ope-dir-cd to w0n99-abe-pr-ope-dir-cd
1842        move rcvgu-fnd-rel-rt to w0n99-abe-pr-fnd-rel-rt
1843        move rcvgu-fnd-pct to w0n99-abe-pr-fnd-pct
1844        end-if
end:42      1844          end-if
1845        if rcvgu-fnd-id = l0n99-abe-fnd-id
start:43      1845          if rcvgu-fnd-id = l0n99-abe-fnd-id
1846        set w0n99-fl-abe-y to true
1847        move spaces to w0n99-abe-long-desc
1848        move rcvgu-ope-dir-cd to w0n99-abe-ope-dir-cd
1849        move rcvgu-fnd-rel-rt to w0n99-abe-fnd-rel-rt
1850        move w0n99-cent to w0n99-abe-fnd-pct
1851        move rcvgu-fnd-ref-amt to w0n99-fnd-ref-amt
1852        end-if
end:42      1852          end-if
1853        continue.
1854    0n99-3031-sr-sorte-x.
1855        exit.
1856    0n99-3032-sr-entre.
1857        if rcvgu-ope-dir-cd-s
start:43      1857          if rcvgu-ope-dir-cd-s
1858        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1859        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1860        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1861        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1862        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1863        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1864        add w0n99-one to w0n99-fnd-num
1865        end-if
end:42      1865          end-if
1866        if rcvgu-ope-dir-cd-e
start:43      1866          if rcvgu-ope-dir-cd-e
1867        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1868        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1869        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1870        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1871        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1872        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1873        add w0n99-one to w0n99-fnd-num
1874        end-if
end:42      1874          end-if
1875        continue.
1876    0n99-3032-sr-entre-x.
1877        exit.
1878    0n99-3033-lapse-pair-sr.
1879        if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
start:43      1879          if rcvgu-fnd-id not = l0n99-abe-fnd-id and rcvgu-opt-num not = w0n99-opt-num
1880        move rcvgu-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1881        move spaces to l0o40-long-desc-stf(w0n99-fnd-num)
1882        move rcvgu-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1883        move rcvgu-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1884        move rcvgu-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1885        move rcvgu-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1886        if rcvgu-fnd-id = l0n99-abn-fnd-id
start:44      1886          if rcvgu-fnd-id = l0n99-abn-fnd-id
1887        move rcvgu-opt-num to w0n99-new-opt-num
1888        end-if
end:43      1888          end-if
1889        add w0n99-one to w0n99-fnd-num
1890        end-if
end:42      1890          end-if
1891        if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
start:43      1891          if rcvgu-fnd-id = l0n99-abe-fnd-id or rcvgu-fnd-id = l0n99-abn-fnd-id
1892        compute w0n99-fnd-ref-amt = w0n99-fnd-ref-amt + rcvgu-fnd-ref-amt
1893        end-if
end:42      1893          end-if
1894        continue.
1895    0n99-3033-lapse-pair-sr-x.
1896        exit.
1897    0n99-1590-stop-lr.
1898        if w0n99-fl-abe-pr-y
start:43      1898          if w0n99-fl-abe-pr-y
1899        move w0n99-abe-pr-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1900        move w0n99-abe-pr-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1901        move w0n99-abe-pr-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1902        move w0n99-abe-pr-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1903        move w0n99-abe-pr-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1904        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1905        add w0n99-one to w0n99-fnd-num
1906        end-if
end:42      1906          end-if
1907        if w0n99-fl-abe-y
start:43      1907          if w0n99-fl-abe-y
1908        move l0n99-abn-fnd-id to l0o40-stf-fnd-id(w0n99-fnd-num)
1909        move w0n99-abe-long-desc to l0o40-long-desc-stf(w0n99-fnd-num)
1910        move w0n99-abe-ope-dir-cd to l0o40-stf-ope-dir-cd(w0n99-fnd-num)
1911        move w0n99-abe-fnd-rel-rt to l0o40-stf-fnd-rel-rt(w0n99-fnd-num)
1912        move w0n99-abe-fnd-pct to l0o40-fnd-pct-stf(w0n99-fnd-num)
1913        move w0n99-new-opt-num to l0o40-stf-opt-num(w0n99-fnd-num)
1914        add w0n99-one to w0n99-fnd-num
1915        end-if
end:42      1915          end-if
1916        move w0n99-new-opt-num to w0n99-abn-opt-num
1917        continue.
1918    0n99-1590-stop-lr-x.
1919        exit.
1920    0n99-4000-phsm-write.
1921        set l2400-create-history to true
1922        perform 2400-0000-init-parm-info thru 2400-0000-init-parm-info-x
start:43      1922          perform 2400-0000-init-parm-info thru 2400-0000-init-parm-info-x
2286    2400-0000-init-parm-info.
2287        initialize l2400-input-parm-info.
2288        if lpga-pchst-area-init-both or lpga-pchst-undo-process
start:44      2288          if lpga-pchst-area-init-both or lpga-pchst-undo-process
2289        set l2400-generate-history-no to true
2290        go to 2400-0000-init-parm-info-x
end:43      2290          go to 2400-0000-init-parm-info-x
start:44      2290          go to 2400-0000-init-parm-info-x
2291        end-if.
end:43      2291          end-if.
2292        move wpgws-crnt-pgm-id to l2400-pgm-id.
2293        move l2400-pgm-num to wptab-pol-actv-typ-id.
2294        perform ptab-1000-read thru ptab-1000-read-x.
start:44      2294          perform ptab-1000-read thru ptab-1000-read-x.
3222    ptab-1000-read.
3223        if wptab-company-required
start:45      3223          if wptab-company-required
3224        move wglob-company-code to wptab-co-id
3225        else
end:44      3225          else
start:45      3225          else
3226        move spaces to wptab-co-id
3227        end-if.
end:44      3227          end-if.
3228        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3229        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3230        evaluate true
start:45      3231          when wglob-gptr-info-address = null
3232        move 'viid822' to wpgws-call-pgm-id
3233        when wgptr-ptab-tbl-loaded-whole
end:44      3233          when wgptr-ptab-tbl-loaded-whole
start:45      3233          when wgptr-ptab-tbl-loaded-whole
3234        move 'viidc67' to wpgws-call-pgm-id
3235        set wptab-tbl-address to wgptr-ptab-tbl-address
3236        move wgptr-ptab-stack-ptr to wptab-stack-ptr
3237        when wgptr-ptab-tbl-loaded-partl
end:44      3237          when wgptr-ptab-tbl-loaded-partl
start:45      3237          when wgptr-ptab-tbl-loaded-partl
3238        move 'viidc66' to wpgws-call-pgm-id
3239        set wptab-tbl-address to wgptr-ptab-tbl-address
3240        move wgptr-ptab-stack-ptr to wptab-stack-ptr
3241        when other
end:44      3241          when other
start:45      3241          when other
3242        move 'viid822' to wpgws-call-pgm-id
3243        end-evaluate.
end:44      3243          end-evaluate.
3244        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3245        set wptab-rqst-select to true.
3246        call wpgws-call-pgm-id using sqlca wptab-io-work-area rptab-rec-info.
3247        if wptab-io-error
start:45      3247          if wptab-io-error
3248        move wptab-table-name to l0030-table-name
3249        move wptab-rqst-cd to l0030-io-command
3250        move wptab-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3251        move wptab-optm-sql-reqir to l0030-optm-sql-reqir
3252        move wptab-optm-sql-exec to l0030-optm-sql-exec
3253        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:46      3253          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:47      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:46      3336          else
start:47      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:46      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:47      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:46      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3253        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:45      3253          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3254        end-if.
end:44      3254          end-if.
3255        if wglob-gptr-info-address not = null
start:45      3255          if wglob-gptr-info-address not = null
3256        move wptab-stack-ptr to wgptr-ptab-stack-ptr
3257        end-if.
end:44      3257          end-if.
3258        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3259        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3260    ptab-1000-read-x.
3261        exit.
2294        perform ptab-1000-read thru ptab-1000-read-x.
end:43      2294          perform ptab-1000-read thru ptab-1000-read-x.
2295        if not wptab-io-ok
start:44      2295          if not wptab-io-ok
2296        set rptab-pol-actv-prces-info to true
2297        end-if.
end:43      2297          end-if.
2298        if rptab-pol-actv-prces-info
start:44      2298          if rptab-pol-actv-prces-info
2299        set l2400-generate-history-info to true
2300        if rpol-pol-ins-typ-flexible or rpol-pol-ins-typ-seg-fund or lpga-pchst-area-init-info
start:45      2300          if rpol-pol-ins-typ-flexible or rpol-pol-ins-typ-seg-fund or lpga-pchst-area-init-info
2301        perform 2400-9100-check-for-history thru 2400-9100-check-for-history-x
start:46      2301          perform 2400-9100-check-for-history thru 2400-9100-check-for-history-x
2510    2400-9100-check-for-history.
2511        if l2400-create-history
start:47      2511          if l2400-create-history
2512        set l2400-generate-history-info to true
2513        else
end:46      2513          else
start:47      2513          else
2514        set l2400-generate-history-no to true
2515        end-if.
end:46      2515          end-if.
2516    2400-9100-check-for-history-x.
2517        exit.
2301        perform 2400-9100-check-for-history thru 2400-9100-check-for-history-x
end:45      2301          perform 2400-9100-check-for-history thru 2400-9100-check-for-history-x
2302        evaluate true
start:46      2303          when l2400-generate-history-no
2304        go to 2400-0000-init-parm-info-x
end:45      2304          go to 2400-0000-init-parm-info-x
start:46      2304          go to 2400-0000-init-parm-info-x
2305        end-evaluate
end:45      2305          end-evaluate
2306        end-if
end:44      2306          end-if
2307        else
end:43      2307          else
start:44      2307          else
2308        if lpga-pchst-area-init-active
start:45      2308          if lpga-pchst-area-init-active
2309        set l2400-generate-history-no to true
2310        go to 2400-0000-init-parm-info-x
end:44      2310          go to 2400-0000-init-parm-info-x
start:45      2310          go to 2400-0000-init-parm-info-x
2311        end-if
end:44      2311          end-if
2312        set l2400-generate-history-active to true
2313        end-if.
end:43      2313          end-if.
2314        if not lpga-pchst-area-initialized
start:44      2314          if not lpga-pchst-area-initialized
2315        move zero to lpga-pchst-sequence
2316        if l2400-generate-history-info
start:45      2316          if l2400-generate-history-info
2317        set lpga-pchst-area-init-info to true
2318        else
end:44      2318          else
start:45      2318          else
2319        set lpga-pchst-area-init-active to true
2320        end-if
end:44      2320          end-if
2321        else
end:43      2321          else
start:44      2321          else
2322        set lpga-pchst-area-init-both to true
2323        end-if.
end:43      2323          end-if.
2324        perform 2400-0100-init-orig-policy thru 2400-0100-init-orig-policy-x.
start:44      2324          perform 2400-0100-init-orig-policy thru 2400-0100-init-orig-policy-x.
2329    2400-0100-init-orig-policy.
2330        move rpol-pol-cvg-rec-ctr-n to l2400-orig-pol-cvg-rec-ctr-n.
2331        if rpol-pol-suspended
start:45      2331          if rpol-pol-suspended
2332        move rpol-pol-spnd-cstat-cd to l2400-orig-pol-cstat-cd
2333        else
end:44      2333          else
start:45      2333          else
2334        move rpol-pol-cstat-cd to l2400-orig-pol-cstat-cd
2335        end-if.
end:44      2335          end-if.
2336        move rpol-pol-db-opt-cd to l2400-orig-pol-db-opt-cd.
2337        move rpol-pol-bill-typ-cd to l2400-orig-pol-bill-typ-cd.
2338        move rpol-pol-bill-mode-cd to l2400-orig-pol-bill-mode-cd.
2339        move rpol-pol-crnt-mode-fct to l2400-orig-pol-crnt-mode-fct.
2340        move rpol-mode-fct-restr-ind to l2400-orig-mode-fct-restr-ind.
2341        move rpol-pol-pfee-fct to l2400-orig-pol-pfee-fct.
2342        move rpol-pol-pfee-restr-ind to l2400-orig-pol-pfee-restr-ind.
2343        move rpol-cli-crnt-loc-cd to l2400-orig-cli-crnt-loc-cd.
2344        move rpol-pol-iss-eff-dt to l2400-orig-pol-iss-eff-dt.
2345        move rpol-pol-rbill-cd to l2400-orig-pol-rbill-cd.
2346        move rpol-peri-pmt-susp-cd to l2400-orig-peri-pmt-susp-cd.
2347        move rpol-pol-pd-to-dt-num to l2400-orig-pol-pd-to-dt-num.
2348        move rpol-pol-bill-to-dt-num to l2400-orig-pol-bill-to-dt-num.
2349        move rpol-pol-sndry-amt to l2400-orig-pol-sndry-amt.
2350        move rpol-pol-tax-typ-cd to l2400-orig-pol-tax-typ-cd.
2351        move rpol-pol-tax-struct-cd to l2400-orig-pol-tax-str-cd.
2352        move rpol-pol-mprem-amt to l2400-orig-pol-mprem-amt.
2353        move rpol-pol-pac-drw-dy-cd to l2400-orig-pol-pac-drw-dy-cd.
2354        move rpol-pol-ul-prces-dt to l2400-orig-pol-ul-prces-dt.
2355        move rpol-pol-restr-cd to l2400-orig-pol-restr-cd.
2356        move rpol-bnfy-clause-typ-cd to l2400-orig-bnfy-clause-typ-cd.
2357        move rpol-comm-calc-opt-cd to l2400-comm-calc-opt-cd.
2358        move rpol-pol-enhc-chng-dt to l2400-orig-pol-enhc-chng-dt.
2359        move rpol-pol-grs-aprem-amt to l2400-orig-pol-grs-aprem-amt.
2360        move rpol-frst-cvg-enhc-dt to l2400-frst-cvg-enhc-dt.
2361        move rpol-pol-anpayo-1-amt to l2400-anpayo-1-amt.
2362        move rpol-pol-bill-strt-dt to l2400-orig-bill-strt-dt
2363        move rpol-pol-ceas-reasn-cd to l2400-orig-pol-ceas-reasn-cd
2364        move rpol-peri-actv-dur to l2400-orig-peri-actv-dur
2365        move rpol-asso-svc-typ-cd to l2400-asso-svc-typ-cd
2366        move rpol-asso-svc-stat-cd to l2400-asso-svc-stat-cd
2367        move rpol-asso-svc-strt-dt to l2400-asso-svc-strt-dt
2368        move rpol-asso-svc-end-dt to l2400-asso-svc-end-dt
2369        move rpol-pol-redc-mult-fct to l2400-pol-redc-mult-fct
2370        move rpol-pol-rsk-pfl-cd to l2400-orig-pol-rsk-pfl-cd
2371        move rpol-latst-bnfy-chng-dt to l2400-orig-latst-bnfy-chng-dt
2372        move rpol-latst-bnfy-nochng-dt to l2400-ori-latst-bnfy-nochng-dt
2373        move rpol-bnfy-nochng-cd to l2400-orig-bnfy-nochng-cd
2374        move rpol-lapse-reasn-cd to l2400-orig-lapse-reasn-cd
2375        move rpol-lapse-sub-reasn-cd to l2400-orig-lapse-sub-reasn-cd
2376        continue.
2377    2400-0100-init-orig-policy-x.
2378        exit.
2324        perform 2400-0100-init-orig-policy thru 2400-0100-init-orig-policy-x.
end:43      2324          perform 2400-0100-init-orig-policy thru 2400-0100-init-orig-policy-x.
2325        perform 2400-0200-init-orig-cvgs thru 2400-0200-init-orig-cvgs-x varying l2400-cvg from +1 by +1 until l2400-cvg > rpol-pol-cvg-rec-ctr-n.
start:44      2325          perform 2400-0200-init-orig-cvgs thru 2400-0200-init-orig-cvgs-x varying l2400-cvg from +1 by +1 until l2400-cvg > rpol-pol-cvg-rec-ctr-n.
2379    2400-0200-init-orig-cvgs.
2380        move wcvgs-cvg-cstat-cd(l2400-cvg) to l2400-orig-cvg-cstat-cd(l2400-cvg)
2381        move wcvgs-plan-id-base(l2400-cvg) to l2400-orig-plan-id-base(l2400-cvg) .
2382        move wcvgs-plan-id-rs(l2400-cvg) to l2400-orig-plan-id-rs(l2400-cvg) .
2383        move wcvgs-cvg-smkr-cd(l2400-cvg) to l2400-orig-cvg-smkr-cd(l2400-cvg) .
2384        move wcvgs-cvg-par-cd(l2400-cvg) to l2400-orig-cvg-par-cd(l2400-cvg) .
2385        move wcvgs-cvg-sex-cd(l2400-cvg) to l2400-orig-cvg-sex-cd(l2400-cvg) .
2386        move wcvgs-cvg-rt-age(l2400-cvg) to l2400-orig-cvg-rt-age(l2400-cvg) .
2387        move wcvgs-cvg-stbl-1-cd(l2400-cvg) to l2400-orig-cvg-stbl-1-cd(l2400-cvg) .
2388        move wcvgs-cvg-dedbl-peri-cd(l2400-cvg) to l2400-orig-cvg-stbl-2-cd(l2400-cvg)
2389        if wcvgs-cvg-bnft-obs-fin(l2400-cvg)
start:45      2389          if wcvgs-cvg-bnft-obs-fin(l2400-cvg)
2390        move wcvgs-prem-pay-dur(l2400-cvg) to l2400-orig-cvg-stbl-3-cd(l2400-cvg)
2391        else
end:44      2391          else
start:45      2391          else
2392        move wcvgs-cvg-allow-dur-cd(l2400-cvg) to l2400-orig-cvg-stbl-3-cd(l2400-cvg)
2393        end-if
end:44      2393          end-if
2394        move wcvgs-cvg-occp-clas-cd(l2400-cvg) to l2400-orig-cvg-stbl-4-cd(l2400-cvg) .
2395        move wcvgs-rel-cvg-num(l2400-cvg) to l2400-orig-rel-cvg-num(l2400-cvg) .
2396        move wcvgs-cvg-enhc-typ-cd(l2400-cvg) to l2400-orig-cvg-enhc-typ-cd(l2400-cvg) .
2397        move wcvgs-cvg-fe-reasn-cd(l2400-cvg) to l2400-orig-cvg-fe-reasn-cd(l2400-cvg) .
2398        move wcvgs-cvg-me-fct(l2400-cvg) to l2400-orig-cvg-me-fct(l2400-cvg) .
2399        move wcvgs-cvg-me-reasn-cd(l2400-cvg) to l2400-orig-cvg-me-reasn-cd(l2400-cvg) .
2400        move wcvgs-age-rat-reasn-cd(l2400-cvg) to l2400-orig-age-rat-reasn-cd(l2400-cvg) .
2401        move wcvgs-ult-prem-rt-age(l2400-cvg) to l2400-orig-ult-prem-rt-age(l2400-cvg) .
2402        move wcvgs-cvg-iss-eff-dt(l2400-cvg) to l2400-orig-cvg-iss-eff-dt(l2400-cvg) .
2403        move wcvgs-cvg-int-payo-cd(l2400-cvg) to l2400-orig-cvg-int-payo-cd(l2400-cvg) .
2404        move wcvgs-anim-nm(l2400-cvg) to l2400-anim-nm(l2400-cvg)
2405        move wcvgs-anim-num(l2400-cvg) to l2400-anim-num(l2400-cvg)
2406        move wcvgs-cvg-mprem-amt(l2400-cvg) to l2400-orig-cvg-mprem-amt(l2400-cvg) .
2407        move wcvgs-cvg-restr-prem-cd(l2400-cvg) to l2400-orig-cvg-restr-prem-cd(l2400-cvg) .
2408        move wcvgs-cvg-basic-prem-amt(l2400-cvg) to l2400-orig-cvg-basic-prem-amt(l2400-cvg) .
2409        if rpol-pol-ins-typ-fpa-segf
start:45      2409          if rpol-pol-ins-typ-fpa-segf
2410        move wcvgs-cvg-in-alloc-cd(l2400-cvg) to l2400-orig-cvg-in-alloc-cd(l2400-cvg)
2411        move wcvgs-in-alloc-amt-pct(l2400-cvg) to l2400-orig-in-alloc-amt-pct(l2400-cvg)
2412        end-if
end:44      2412          end-if
2413        move wcvgs-mat-xpry-recalc-cd(l2400-cvg) to l2400-orig-mat-xpry-recalc-cd(l2400-cvg) .
2414        move wcvgs-cvg-mat-xpry-dt(l2400-cvg) to l2400-orig-cvg-mat-xpry-dt(l2400-cvg) .
2415        move wcvgs-cvg-rsk-excl-ind(l2400-cvg) to l2400-orig-cvg-rsk-excl-ind(l2400-cvg) .
2416        if rpol-pol-ins-typ-fpa-segf
start:45      2416          if rpol-pol-ins-typ-fpa-segf
2417        move wcvgs-min-grs-aprem-amt(l2400-cvg) to l2400-orig-min-grs-aprem-amt(l2400-cvg)
2418        move wcvgs-cvg-enhc-amt(l2400-cvg) to l2400-orig-cvg-enhc-amt(l2400-cvg)
2419        move wcvgs-cvg-enhc-rt(l2400-cvg) to l2400-orig-cvg-enhc-rt(l2400-cvg)
2420        move wcvgs-cvg-ia-gar-amt(l2400-cvg) to l2400-orig-cvg-ia-gar-amt(l2400-cvg)
2421        move wcvgs-cvg-guar-int-pct(l2400-cvg) to l2400-orig-cvg-guar-int-pct(l2400-cvg)
2422        else
end:44      2422          else
start:45      2422          else
2423        if not rpol-pol-ins-typ-immed-anty
start:46      2423          if not rpol-pol-ins-typ-immed-anty
2424        move wcvgs-cvg-ad-mult-fct(l2400-cvg) to l2400-orig-cvg-ad-mult-fct(l2400-cvg)
2425        move wcvgs-cvg-me-dur(l2400-cvg) to l2400-orig-cvg-me-dur(l2400-cvg)
2426        move wcvgs-ult-prem-rt-cd(l2400-cvg) to l2400-orig-ult-prem-rt-cd(l2400-cvg)
2427        move wcvgs-cvg-iad-xpry-dt(l2400-cvg) to l2400-orig-cvg-iad-xpry-dt(l2400-cvg)
2428        move wcvgs-cvg-rfnd-due-amt(l2400-cvg) to l2400-orig-cvg-rfnd-due-amt(l2400-cvg)
2429        move wcvgs-cvg-ad-xpry-dt(l2400-cvg) to l2400-orig-cvg-ad-xpry-dt(l2400-cvg)
2430        move wcvgs-cvg-ad-me-dur(l2400-cvg) to l2400-orig-cvg-ad-me-dur(l2400-cvg)
2431        move wcvgs-cvg-ad-pm-dur(l2400-cvg) to l2400-orig-cvg-ad-pm-dur(l2400-cvg)
2432        move wcvgs-cvg-face-amt(l2400-cvg) to l2400-orig-cvg-face-amt(l2400-cvg)
2433        move wcvgs-cvg-iad-mult-fct(l2400-cvg) to l2400-orig-cvg-iad-mult-fct(l2400-cvg)
2434        move wcvgs-cvg-ad-face-amt(l2400-cvg) to l2400-orig-cvg-ad-face-amt(l2400-cvg)
2435        move wcvgs-cvg-fe-uprem-amt(l2400-cvg) to l2400-orig-cvg-fe-uprem-amt(l2400-cvg)
2436        move wcvgs-cvg-fe-dur(l2400-cvg) to l2400-orig-cvg-fe-dur(l2400-cvg)
2437        move wcvgs-cvg-entr-aprem-amt(l2400-cvg) to l2400-orig-cvg-entr-aprem-amt(l2400-cvg)
2438        move wcvgs-cvg-calc-aprem-amt(l2400-cvg) to l2400-orig-cvg-calc-aprem-amt(l2400-cvg)
2439        move wcvgs-cvg-ad-prem-amt(l2400-cvg) to l2400-orig-cvg-ad-prem-amt(l2400-cvg)
2440        move wcvgs-cvg-ad-me-prem-amt(l2400-cvg) to l2400-orig-cvg-ad-me-prem-amt(l2400-cvg)
2441        move wcvgs-cvg-iad-prem-amt(l2400-cvg) to l2400-orig-cvg-iad-prem-amt(l2400-cvg)
2442        move wcvgs-iad-me-prem-amt(l2400-cvg) to l2400-orig-cvg-iad-me-prem-amt(l2400-cvg)
2443        move wcvgs-cvg-fe-prem-amt(l2400-cvg) to l2400-orig-cvg-fe-prem-amt(l2400-cvg)
2444        move wcvgs-cvg-me-prem-amt(l2400-cvg) to l2400-orig-cvg-me-prem-amt(l2400-cvg)
2445        move wcvgs-cvg-sale-tax-amt(l2400-cvg) to l2400-orig-cvg-sale-tax-amt(l2400-cvg)
2446        move wcvgs-cvg-prem-redc-pct(l2400-cvg) to l2400-orig-cvg-prem-redc-pct(l2400-cvg)
2447        move wcvgs-cvg-sum-ins-amt(l2400-cvg) to l2400-orig-cvg-sum-ins-amt(l2400-cvg)
2448        move wcvgs-cvg-ad-pm-fct(l2400-cvg) to l2400-orig-cvg-ad-pm-fct(l2400-cvg)
2449        move wcvgs-cvg-ad-pm-prem-amt(l2400-cvg) to l2400-orig-cvg-ad-pm-prem-amt(l2400-cvg)
2450        move wcvgs-ke-face-amt(l2400-cvg) to l2400-orig-ke-face-amt(l2400-cvg)
2451        move wcvgs-ke-prem-amt(l2400-cvg) to l2400-orig-ke-prem-amt(l2400-cvg)
2452        move wcvgs-ass-aprem-amt(l2400-cvg) to l2400-orig-ass-aprem-amt(l2400-cvg)
2453        move wcvgs-cvg-redc-mult-fct(l2400-cvg) to l2400-orig-cvg-redc-mult-fct(l2400-cvg)
2454        move wcvgs-ke-redc-mult-fct(l2400-cvg) to l2400-orig-ke-redc-mult-fct(l2400-cvg)
2455        move wcvgs-ass-ind(l2400-cvg) to l2400-orig-ass-ind(l2400-cvg)
2456        end-if
end:45      2456          end-if
2457        end-if
end:44      2457          end-if
2458        move wcvgs-cvg-clm-chq-dt(l2400-cvg) to l2400-orig-cvg-clm-chq-dt(l2400-cvg)
2459        move wcvgs-cvgf-seq-num(l2400-cvg) to l2400-orig-cvgf-seq-num(l2400-cvg)
2460        continue.
2461    2400-0200-init-orig-cvgs-x.
2462        exit.
2325        perform 2400-0200-init-orig-cvgs thru 2400-0200-init-orig-cvgs-x varying l2400-cvg from +1 by +1 until l2400-cvg > rpol-pol-cvg-rec-ctr-n.
end:43      2325          perform 2400-0200-init-orig-cvgs thru 2400-0200-init-orig-cvgs-x varying l2400-cvg from +1 by +1 until l2400-cvg > rpol-pol-cvg-rec-ctr-n.
2326        move zero to l2400-cvg.
2327    2400-0000-init-parm-info-x.
2328        exit.
1922        perform 2400-0000-init-parm-info thru 2400-0000-init-parm-info-x
end:42      1922          perform 2400-0000-init-parm-info thru 2400-0000-init-parm-info-x
1923        perform 2400-1000-build-parm-info thru 2400-1000-build-parm-info-x
start:43      1923          perform 2400-1000-build-parm-info thru 2400-1000-build-parm-info-x
2463    2400-1000-build-parm-info.
2464        if l2400-generate-history-no
start:44      2464          if l2400-generate-history-no
2465        go to 2400-1000-build-parm-info-x
end:43      2465          go to 2400-1000-build-parm-info-x
start:44      2465          go to 2400-1000-build-parm-info-x
2466        end-if.
end:43      2466          end-if.
2467        perform 2400-1300-build-input-parms thru 2400-1300-build-input-parms-x.
start:44      2467          perform 2400-1300-build-input-parms thru 2400-1300-build-input-parms-x.
2470    2400-1300-build-input-parms.
2471        move rpol-pol-id to l2400-pol-id.
2472        move rpol-pol-spnd-ind to l2400-pol-spnd-ind.
2473        move rpol-pol-spnd-eff-dt to l2400-pol-spnd-eff-dt.
2474        move rpol-pol-ins-typ-cd to l2400-pol-ins-typ-cd.
2475        move rpol-pol-ul-prces-dt to l2400-pol-ul-prces-dt.
2476        move rpol-pol-pd-to-dt-num to l2400-pol-pd-to-dt-num.
2477        move rpol-latst-actv-dt to l2400-latst-actv-dt.
2478        move rpol-earlst-revrs-dt to l2400-earlst-revrs-dt.
2479        move wglob-process-date to l2400-eff-dt.
2480        move zero to l2400-cvg.
2481        move rpol-cd-opt-ofp-act to l2400-cd-opt-ofp-act.
2482    2400-1300-build-input-parms-x.
2483        exit.
2467        perform 2400-1300-build-input-parms thru 2400-1300-build-input-parms-x.
end:43      2467          perform 2400-1300-build-input-parms thru 2400-1300-build-input-parms-x.
2468    2400-1000-build-parm-info-x.
2469        exit.
1923        perform 2400-1000-build-parm-info thru 2400-1000-build-parm-info-x
end:42      1923          perform 2400-1000-build-parm-info thru 2400-1000-build-parm-info-x
1924        move l0n99-ope-eff-dt to l2400-eff-dt
1925        set l2400-generate-history-info to true
1926        evaluate true
start:43      1927          when w0n99-opt-rh-optqui
1928        set wglob-transaction-moop to true
1929        when w0n99-opt-rh-optrpp
end:42      1929          when w0n99-opt-rh-optrpp
start:43      1929          when w0n99-opt-rh-optrpp
1930        set wglob-transaction-moor to true
1931        when w0n99-opt-rh-optecr
end:42      1931          when w0n99-opt-rh-optecr
start:43      1931          when w0n99-opt-rh-optecr
1932        set wglob-transaction-moec to true
1933        when other
end:42      1933          when other
start:43      1933          when other
1934        continue
1935        end-evaluate
end:42      1935          end-evaluate
1936        perform 2400-1000-generate-phst thru 2400-1000-generate-phst-x
start:43      1936          perform 2400-1000-generate-phst thru 2400-1000-generate-phst-x
2528    2400-1000-generate-phst.
2529        set l2400-rqst-generate-phst to true.
2530        perform 2400-0000-call thru 2400-0000-call-x.
start:44      2530          perform 2400-0000-call thru 2400-0000-call-x.
2518    2400-0000-call.
2519        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2520        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2521        move 'vib3676' to wpgws-call-pgm-id.
2522        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2523        call wpgws-call-pgm-id using wglob-global-area l2400-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2524        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2525        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2526    2400-0000-call-x.
2527        exit.
2530        perform 2400-0000-call thru 2400-0000-call-x.
end:43      2530          perform 2400-0000-call thru 2400-0000-call-x.
2531    2400-1000-generate-phst-x.
2532        exit.
1936        perform 2400-1000-generate-phst thru 2400-1000-generate-phst-x
end:42      1936          perform 2400-1000-generate-phst thru 2400-1000-generate-phst-x
1937        if l2400-retrn-error
start:43      1937          if l2400-retrn-error
1938        set l0n99-retrn-error to true
1939        go to 0n99-4000-phsm-write-x
start:44      1939          go to 0n99-4000-phsm-write-x
1948    0n99-4000-phsm-write-x.
1949        exit.
1950    0n99-5000-gevt-write.
1951        initialize wgevt-key
1952        perform tmsp-1000-read thru tmsp-1000-read-x
start:45      1952          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:46      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:47      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:48      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:47      3336          else
start:48      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:47      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:48      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:47      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:46      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:45      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
1952        perform tmsp-1000-read thru tmsp-1000-read-x
end:44      1952          perform tmsp-1000-read thru tmsp-1000-read-x
1953        move wtmsp-tmsp to wgevt-tmsp
1954        move rpol-pol-id to wgevt-pol-id
1955        set wgevt-ct-enr-evt-gen to true
1956        perform gevt-1000-create thru gevt-1000-create-x
start:45      1956          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
1956        perform gevt-1000-create thru gevt-1000-create-x
end:44      1956          perform gevt-1000-create thru gevt-1000-create-x
1957        move wgevt-key to rgevt-key
1958        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
1959        move l0n99-ope-eff-dt to rgevt-eff-dt
1960        move wglob-process-date to rgevt-rqst-dt
1961        move wglob-system-date-int to rgevt-prcs-dt
1962        move wglob-mvt-chnl-cd to rgevt-mvt-chnl-cd
1963        move wglob-lng-user-id to rgevt-c0-uti
1964        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
1965        move lpga-pchst-tmsp to rgevt-pchst-tmsp
1966        move l0o34-opt-nm(1:20) to rgevt-msg-parm-1-txt
1967        move l0o34-opt-nm(21:12) to rgevt-msg-parm-2-txt
1968        evaluate true
start:45      1969          when w0n99-opt-rh-optqui
1970        set rgevt-moop-0037 to true
1971        when w0n99-opt-rh-optrpp
end:44      1971          when w0n99-opt-rh-optrpp
start:45      1971          when w0n99-opt-rh-optrpp
1972        set rgevt-moor-0449 to true
1973        when w0n99-opt-rh-optecr
end:44      1973          when w0n99-opt-rh-optecr
start:45      1973          when w0n99-opt-rh-optecr
1974        if w0n99-fe-lap-opt-ecr
start:46      1974          if w0n99-fe-lap-opt-ecr
1975        set rgevt-moec-0181 to true
1976        end-if
end:45      1976          end-if
1977        if w0n99-fe-mod-opt-ecr
start:46      1977          if w0n99-fe-mod-opt-ecr
1978        set rgevt-moec-0182 to true
1979        end-if
end:45      1979          end-if
1980        when w0n99-opt-rh-optsl1
end:44      1980          when w0n99-opt-rh-optsl1
start:45      1980          when w0n99-opt-rh-optsl1
1981        if w0n99-lapse-supp-y
start:46      1981          if w0n99-lapse-supp-y
1982        set rgevt-mdof-0327 to true
1983        else
end:45      1983          else
start:46      1983          else
1984        set rgevt-mdof-0313 to true
1985        end-if
end:45      1985          end-if
1986        when w0n99-opt-rh-optsw1
end:44      1986          when w0n99-opt-rh-optsw1
start:45      1986          when w0n99-opt-rh-optsw1
1987        if w0n99-lapse-supp-y
start:46      1987          if w0n99-lapse-supp-y
1988        set rgevt-mdof-0330 to true
1989        else
end:45      1989          else
start:46      1989          else
1990        set rgevt-mdof-0314 to true
1991        end-if
end:45      1991          end-if
1992        when w0n99-opt-rh-optsr1
end:44      1992          when w0n99-opt-rh-optsr1
start:45      1992          when w0n99-opt-rh-optsr1
1993        if w0n99-lapse-supp-y
start:46      1993          if w0n99-lapse-supp-y
1994        set rgevt-mdof-0333 to true
1995        else
end:45      1995          else
start:46      1995          else
1996        set rgevt-mdof-0315 to true
1997        end-if
end:45      1997          end-if
1998        when w0n99-opt-rh-optip1
end:44      1998          when w0n99-opt-rh-optip1
start:45      1998          when w0n99-opt-rh-optip1
1999        if w0n99-lapse-supp-y
start:46      1999          if w0n99-lapse-supp-y
2000        set rgevt-mdof-0337 to true
2001        else
end:45      2001          else
start:46      2001          else
2002        set rgevt-mdof-0316 to true
2003        end-if
end:45      2003          end-if
2004        when w0n99-opt-rh-optcl1
end:44      2004          when w0n99-opt-rh-optcl1
start:45      2004          when w0n99-opt-rh-optcl1
2005        if w0n99-lapse-supp-y
start:46      2005          if w0n99-lapse-supp-y
2006        set rgevt-mdof-0341 to true
2007        else
end:45      2007          else
start:46      2007          else
2008        set rgevt-mdof-0318 to true
2009        end-if
end:45      2009          end-if
2010        when w0n99-opt-rh-optsp1
end:44      2010          when w0n99-opt-rh-optsp1
start:45      2010          when w0n99-opt-rh-optsp1
2011        if w0n99-lapse-supp-y
start:46      2011          if w0n99-lapse-supp-y
2012        set rgevt-mdof-0345 to true
2013        else
end:45      2013          else
start:46      2013          else
2014        set rgevt-mdof-0319 to true
2015        end-if
end:45      2015          end-if
2016        when w0n99-opt-rh-optra1
end:44      2016          when w0n99-opt-rh-optra1
start:45      2016          when w0n99-opt-rh-optra1
2017        set rgevt-mdof-0317 to true
2018        when other
end:44      2018          when other
start:45      2018          when other
2019        continue
2020        end-evaluate
end:44      2020          end-evaluate
2021        perform gevt-1000-write thru gevt-1000-write-x
start:45      2021          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:46      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:45      3201          else
start:46      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:45      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:46      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:47      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:48      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:47      3336          else
start:48      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:47      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:48      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:47      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:46      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:45      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2021        perform gevt-1000-write thru gevt-1000-write-x
end:44      2021          perform gevt-1000-write thru gevt-1000-write-x
2022        set w0n99-flag-mod-y to true
2023        set w0n99-prcs-gevt-y to true
2024        continue.
2025    0n99-5000-gevt-write-x.
2026        exit.
2027    0n99-6000-create-gevt.
2028        initialize wgevt-key
2029        perform tmsp-1000-read thru tmsp-1000-read-x
start:45      2029          perform tmsp-1000-read thru tmsp-1000-read-x
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:46      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:47      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:48      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:47      3336          else
start:48      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:47      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:48      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:47      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:46      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:45      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
2029        perform tmsp-1000-read thru tmsp-1000-read-x
end:44      2029          perform tmsp-1000-read thru tmsp-1000-read-x
2030        move wtmsp-tmsp to wgevt-tmsp
2031        move rpol-pol-id to wgevt-pol-id
2032        set wgevt-ct-enr-evt-gen to true
2033        perform gevt-1000-create thru gevt-1000-create-x
start:45      2033          perform gevt-1000-create thru gevt-1000-create-x
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
2033        perform gevt-1000-create thru gevt-1000-create-x
end:44      2033          perform gevt-1000-create thru gevt-1000-create-x
2034        move wgevt-key to rgevt-key
2035        move rpol-pol-base-cvg-num to rgevt-cvg-num-n
2036        move l0n99-ope-eff-dt to rgevt-eff-dt
2037        move wglob-process-date to rgevt-rqst-dt
2038        move wglob-system-date-int to rgevt-prcs-dt
2039        move w0n99-mvt-chnl-bt to rgevt-mvt-chnl-cd
2040        move wglob-lng-user-id to rgevt-c0-uti
2041        move wglob-conn-agncy-cd to rgevt-conn-agncy-cd
2042        move lpga-pchst-tmsp to rgevt-pchst-tmsp
2043        set rgevt-ostt-0474 to true
2044        perform gevt-1000-write thru gevt-1000-write-x
start:45      2044          perform gevt-1000-write thru gevt-1000-write-x
3198    gevt-1000-write.
3199        if wgevt-company-required
start:46      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:45      3201          else
start:46      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:45      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:46      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:47      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:48      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:47      3336          else
start:48      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:47      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:48      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:47      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:46      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:45      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
2044        perform gevt-1000-write thru gevt-1000-write-x
end:44      2044          perform gevt-1000-write thru gevt-1000-write-x
2045        continue.
2046    0n99-6000-create-gevt-x.
2047        exit.
2048    9972-1000-build-parm-info.
2049        initialize l9972-input-parm-info.
2050        move wcvgs-cvg-iss-eff-dt(i) to l9972-cvg-iss-eff-dt.
2051    9972-1000-build-parm-info-x.
2052        exit.
2053    0o32-1000-build-parm-info.
2054        initialize l0o32-input-parm-info
2055        initialize l0o32-io-parm-info
2056        continue.
2057    0o32-1000-build-parm-info-x.
2058        exit.
2059    0o32-0000-call.
2060        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2061        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2062        move 'vib3o32' to wpgws-call-pgm-id
2063        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2064        call wpgws-call-pgm-id using wglob-global-area l0o32-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2065        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2066        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2067        continue.
2068    0o32-0000-call-x.
2069        exit.
2070    0o32-1000-chk-admsblty-init.
2071        set l0o32-chk-admsblty-init to true
2072        perform 0o32-0000-call thru 0o32-0000-call-x
start:45      2072          perform 0o32-0000-call thru 0o32-0000-call-x
2059    0o32-0000-call.
2060        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2061        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2062        move 'vib3o32' to wpgws-call-pgm-id
2063        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2064        call wpgws-call-pgm-id using wglob-global-area l0o32-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2065        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2066        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2067        continue.
2068    0o32-0000-call-x.
2069        exit.
2072        perform 0o32-0000-call thru 0o32-0000-call-x
end:44      2072          perform 0o32-0000-call thru 0o32-0000-call-x
2073        continue.
2074    0o32-1000-chk-admsblty-init-x.
2075        exit.
2076    0o32-2000-chk-admsblty-mod.
2077        set l0o32-chk-admsblty-mod to true
2078        perform 0o32-0000-call thru 0o32-0000-call-x
start:45      2078          perform 0o32-0000-call thru 0o32-0000-call-x
2059    0o32-0000-call.
2060        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2061        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2062        move 'vib3o32' to wpgws-call-pgm-id
2063        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2064        call wpgws-call-pgm-id using wglob-global-area l0o32-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2065        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2066        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2067        continue.
2068    0o32-0000-call-x.
2069        exit.
2078        perform 0o32-0000-call thru 0o32-0000-call-x
end:44      2078          perform 0o32-0000-call thru 0o32-0000-call-x
2079        continue.
2080    0o32-2000-chk-admsblty-mod-x.
2081        exit.
2082    0o32-2000-mgmt-fin-opt.
2083        set l0o32-mgmt-fin-opt to true
2084        perform 0o32-0000-call thru 0o32-0000-call-x
start:45      2084          perform 0o32-0000-call thru 0o32-0000-call-x
2059    0o32-0000-call.
2060        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2061        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2062        move 'vib3o32' to wpgws-call-pgm-id
2063        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2064        call wpgws-call-pgm-id using wglob-global-area l0o32-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2065        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2066        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2067        continue.
2068    0o32-0000-call-x.
2069        exit.
2084        perform 0o32-0000-call thru 0o32-0000-call-x
end:44      2084          perform 0o32-0000-call thru 0o32-0000-call-x
2085        continue.
2086    0o32-2000-mgmt-fin-opt-x.
2087        exit.
2088    0o33-1000-build-parm-info.
2089        initialize l0o33-input-parm-info
2090        initialize l0o33-io-parm-info
2091        continue.
2092    0o33-1000-build-parm-info-x.
2093        exit.
2094    0o33-0000-call.
2095        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2096        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2097        move 'vib3o33' to wpgws-call-pgm-id
2098        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2099        call wpgws-call-pgm-id using wglob-global-area l0o33-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2100        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2101        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2102        continue.
2103    0o33-0000-call-x.
2104        exit.
2105    0o33-1000-read-fopt-pol.
2106        set l0o33-read-fopt-pol to true
2107        perform 0o33-0000-call thru 0o33-0000-call-x
start:45      2107          perform 0o33-0000-call thru 0o33-0000-call-x
2094    0o33-0000-call.
2095        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2096        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2097        move 'vib3o33' to wpgws-call-pgm-id
2098        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2099        call wpgws-call-pgm-id using wglob-global-area l0o33-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2100        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2101        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2102        continue.
2103    0o33-0000-call-x.
2104        exit.
2107        perform 0o33-0000-call thru 0o33-0000-call-x
end:44      2107          perform 0o33-0000-call thru 0o33-0000-call-x
2108        continue.
2109    0o33-1000-read-fopt-pol-x.
2110        exit.
2111    0o33-2000-read-list-fopt.
2112        set l0o33-read-list-fopt to true
2113        perform 0o33-0000-call thru 0o33-0000-call-x
start:45      2113          perform 0o33-0000-call thru 0o33-0000-call-x
2094    0o33-0000-call.
2095        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2096        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2097        move 'vib3o33' to wpgws-call-pgm-id
2098        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2099        call wpgws-call-pgm-id using wglob-global-area l0o33-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2100        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2101        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2102        continue.
2103    0o33-0000-call-x.
2104        exit.
2113        perform 0o33-0000-call thru 0o33-0000-call-x
end:44      2113          perform 0o33-0000-call thru 0o33-0000-call-x
2114        continue.
2115    0o33-2000-read-list-fopt-x.
2116        exit.
2117    0o33-3000-ref-val-search.
2118        set l0o33-fnd-ref-val to true
2119        perform 0o33-0000-call thru 0o33-0000-call-x
start:45      2119          perform 0o33-0000-call thru 0o33-0000-call-x
2094    0o33-0000-call.
2095        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2096        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2097        move 'vib3o33' to wpgws-call-pgm-id
2098        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2099        call wpgws-call-pgm-id using wglob-global-area l0o33-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2100        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2101        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2102        continue.
2103    0o33-0000-call-x.
2104        exit.
2119        perform 0o33-0000-call thru 0o33-0000-call-x
end:44      2119          perform 0o33-0000-call thru 0o33-0000-call-x
2120        continue.
2121    0o33-3000-ref-val-search-x.
2122        exit.
2123    0o34-1000-build-parm-info.
2124        initialize l0o34-input-parm-info
2125        initialize l0o34-io-parm-info
2126        continue.
2127    0o34-1000-build-parm-info-x.
2128        exit.
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2140    0o34-1000-read-fopt-rep.
2141        set l0o34-read-fopt-rep to true
2142        perform 0o34-0000-call thru 0o34-0000-call-x
start:45      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2142        perform 0o34-0000-call thru 0o34-0000-call-x
end:44      2142          perform 0o34-0000-call thru 0o34-0000-call-x
2143        continue.
2144    0o34-1000-read-fopt-rep-x.
2145        exit.
2146    0o34-2000-fopt-list-occu.
2147        set l0o34-fopt-list-occu to true
2148        perform 0o34-0000-call thru 0o34-0000-call-x
start:45      2148          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2148        perform 0o34-0000-call thru 0o34-0000-call-x
end:44      2148          perform 0o34-0000-call thru 0o34-0000-call-x
2149        continue.
2150    0o34-2000-fopt-list-occu-x.
2151        exit.
2152    0o34-3000-fopt-obt-ent.
2153        set l0o34-fopt-obt-ent to true
2154        perform 0o34-0000-call thru 0o34-0000-call-x
start:45      2154          perform 0o34-0000-call thru 0o34-0000-call-x
2129    0o34-0000-call.
2130        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2131        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2132        move 'vib3o34' to wpgws-call-pgm-id
2133        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2134        call wpgws-call-pgm-id using wglob-global-area l0o34-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2135        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2136        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2137        continue.
2138    0o34-0000-call-x.
2139        exit.
2154        perform 0o34-0000-call thru 0o34-0000-call-x
end:44      2154          perform 0o34-0000-call thru 0o34-0000-call-x
2155        continue.
2156    0o34-3000-fopt-obt-ent-x.
2157        exit.
2158    0o37-1000-build-parm-info.
2159        initialize l0o37-input-parm-info
2160        initialize l0o37-io-parm-info
2161        continue.
2162    0o37-1000-build-parm-info-x.
2163        exit.
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2175    0o37-1000-calc-ref-val.
2176        set l0o37-rqst-calc to true
2177        perform 0o37-0000-call thru 0o37-0000-call-x
start:45      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2177        perform 0o37-0000-call thru 0o37-0000-call-x
end:44      2177          perform 0o37-0000-call thru 0o37-0000-call-x
2178        continue.
2179    0o37-1000-calc-ref-val-x.
2180        exit.
2181    0o37-2000-fetch-ref-val.
2182        set l0o37-rqst-fetch to true
2183        perform 0o37-0000-call thru 0o37-0000-call-x
start:45      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2164    0o37-0000-call.
2165        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2166        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2167        move 'vib3o37' to wpgws-call-pgm-id
2168        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2169        call wpgws-call-pgm-id using wglob-global-area l0o37-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2170        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2171        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2172        continue.
2173    0o37-0000-call-x.
2174        exit.
2183        perform 0o37-0000-call thru 0o37-0000-call-x
end:44      2183          perform 0o37-0000-call thru 0o37-0000-call-x
2184        continue.
2185    0o37-2000-fetch-ref-val-x.
2186        exit.
2187    0o38-1000-build-parm-info.
2188        initialize l0o38-input-parm-info
2189        initialize l0o38-io-parm-info
2190        continue.
2191    0o38-1000-build-parm-info-x.
2192        exit.
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2204    0o38-1000-lapse-opt.
2205        set l0o38-lapse-opt to true
2206        perform 0o38-0000-call thru 0o38-0000-call-x
start:45      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2206        perform 0o38-0000-call thru 0o38-0000-call-x
end:44      2206          perform 0o38-0000-call thru 0o38-0000-call-x
2207        continue.
2208    0o38-1000-lapse-opt-x.
2209        exit.
2210    0o38-2000-supp-lvl-lapse-opt.
2211        set l0o38-supp-lvl-lapse-opt to true
2212        perform 0o38-0000-call thru 0o38-0000-call-x
start:45      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2212        perform 0o38-0000-call thru 0o38-0000-call-x
end:44      2212          perform 0o38-0000-call thru 0o38-0000-call-x
2213        continue.
2214    0o38-2000-supp-lvl-lapse-opt-x.
2215        exit.
2216    0o38-3000-debit-support-opt.
2217        set l0o38-debit-support-opt to true
2218        perform 0o38-0000-call thru 0o38-0000-call-x
start:45      2218          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2218        perform 0o38-0000-call thru 0o38-0000-call-x
end:44      2218          perform 0o38-0000-call thru 0o38-0000-call-x
2219        continue.
2220    0o38-3000-debit-support-opt-x.
2221        exit.
2222    0o38-4000-actv-ip-mandate.
2223        set l0o38-actv-ip-mandate to true
2224        perform 0o38-0000-call thru 0o38-0000-call-x
start:45      2224          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2224        perform 0o38-0000-call thru 0o38-0000-call-x
end:44      2224          perform 0o38-0000-call thru 0o38-0000-call-x
2225        continue.
2226    0o38-4000-actv-ip-mandate-x.
2227        exit.
2228    0o38-5000-calc-invst-amnt.
2229        set l0o38-calc-invst-amnt to true
2230        perform 0o38-0000-call thru 0o38-0000-call-x
start:45      2230          perform 0o38-0000-call thru 0o38-0000-call-x
2193    0o38-0000-call.
2194        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2195        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2196        move 'vib3o38' to wpgws-call-pgm-id
2197        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2198        call wpgws-call-pgm-id using wglob-global-area l0o38-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area
2199        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2200        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2201        continue.
2202    0o38-0000-call-x.
2203        exit.
2230        perform 0o38-0000-call thru 0o38-0000-call-x
end:44      2230          perform 0o38-0000-call thru 0o38-0000-call-x
2231        continue.
2232    0o38-5000-calc-invst-amnt-x.
2233        exit.
2234    0o40-1000-build-parm-info.
2235        initialize l0o40-input-parm-info
2236        initialize l0o40-io-parm-info
2237        continue.
2238    0o40-1000-build-parm-info-x.
2239        exit.
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2251    0o40-1000-record-fopt-info.
2252        set l0o40-record-fopt-info to true
2253        perform 0o40-0000-call thru 0o40-0000-call-x
start:45      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2240    0o40-0000-call.
2241        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2242        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2243        move 'vib3o40' to wpgws-call-pgm-id
2244        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2245        call wpgws-call-pgm-id using wglob-global-area l0o40-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2246        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2247        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2248        continue.
2249    0o40-0000-call-x.
2250        exit.
2253        perform 0o40-0000-call thru 0o40-0000-call-x
end:44      2253          perform 0o40-0000-call thru 0o40-0000-call-x
2254        continue.
2255    0o40-1000-record-fopt-info-x.
2256        exit.
2257    9038-1000-build-parm-info.
2258        initialize l9038-input-parm-info.
2259        initialize l9038-io-parm-info.
2260        set l9038-prces-typ-all to true.
2261        set l9038-chg-phdt-n to true
2262        continue.
2263    9038-1000-build-parm-info-x.
2264        exit.
2265    9038-0000-call.
2266        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2267        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2268        move 'vib3d17' to wpgws-call-pgm-id.
2269        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2270        call wpgws-call-pgm-id using wglob-global-area l9038-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2271        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2272        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2273    9038-0000-call-x.
2274        exit.
2275    9038-1000-chg-alloc-data.
2276        set l9038-rqst-chg-alloc-data to true.
2277        perform 9038-0000-call thru 9038-0000-call-x.
start:45      2277          perform 9038-0000-call thru 9038-0000-call-x.
2265    9038-0000-call.
2266        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2267        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2268        move 'vib3d17' to wpgws-call-pgm-id.
2269        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2270        call wpgws-call-pgm-id using wglob-global-area l9038-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2271        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2272        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2273    9038-0000-call-x.
2274        exit.
2277        perform 9038-0000-call thru 9038-0000-call-x.
end:44      2277          perform 9038-0000-call thru 9038-0000-call-x.
2278    9038-1000-chg-alloc-data-x.
2279        exit.
2280    9038-2000-chg-rgl-rt.
2281        set l9038-rqst-chg-rgl-rt to true
2282        perform 9038-0000-call thru 9038-0000-call-x
start:45      2282          perform 9038-0000-call thru 9038-0000-call-x
2265    9038-0000-call.
2266        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2267        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2268        move 'vib3d17' to wpgws-call-pgm-id.
2269        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2270        call wpgws-call-pgm-id using wglob-global-area l9038-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2271        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2272        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2273    9038-0000-call-x.
2274        exit.
2282        perform 9038-0000-call thru 9038-0000-call-x
end:44      2282          perform 9038-0000-call thru 9038-0000-call-x
2283        continue.
2284    9038-2000-chg-rgl-rt-x.
2285        exit.
2286    2400-0000-init-parm-info.
2287        initialize l2400-input-parm-info.
2288        if lpga-pchst-area-init-both or lpga-pchst-undo-process
start:45      2288          if lpga-pchst-area-init-both or lpga-pchst-undo-process
2289        set l2400-generate-history-no to true
2290        go to 2400-0000-init-parm-info-x
start:46      2290          go to 2400-0000-init-parm-info-x
2327    2400-0000-init-parm-info-x.
2328        exit.
2329    2400-0100-init-orig-policy.
2330        move rpol-pol-cvg-rec-ctr-n to l2400-orig-pol-cvg-rec-ctr-n.
2331        if rpol-pol-suspended
start:47      2331          if rpol-pol-suspended
2332        move rpol-pol-spnd-cstat-cd to l2400-orig-pol-cstat-cd
2333        else
end:46      2333          else
start:47      2333          else
2334        move rpol-pol-cstat-cd to l2400-orig-pol-cstat-cd
2335        end-if.
end:46      2335          end-if.
2336        move rpol-pol-db-opt-cd to l2400-orig-pol-db-opt-cd.
2337        move rpol-pol-bill-typ-cd to l2400-orig-pol-bill-typ-cd.
2338        move rpol-pol-bill-mode-cd to l2400-orig-pol-bill-mode-cd.
2339        move rpol-pol-crnt-mode-fct to l2400-orig-pol-crnt-mode-fct.
2340        move rpol-mode-fct-restr-ind to l2400-orig-mode-fct-restr-ind.
2341        move rpol-pol-pfee-fct to l2400-orig-pol-pfee-fct.
2342        move rpol-pol-pfee-restr-ind to l2400-orig-pol-pfee-restr-ind.
2343        move rpol-cli-crnt-loc-cd to l2400-orig-cli-crnt-loc-cd.
2344        move rpol-pol-iss-eff-dt to l2400-orig-pol-iss-eff-dt.
2345        move rpol-pol-rbill-cd to l2400-orig-pol-rbill-cd.
2346        move rpol-peri-pmt-susp-cd to l2400-orig-peri-pmt-susp-cd.
2347        move rpol-pol-pd-to-dt-num to l2400-orig-pol-pd-to-dt-num.
2348        move rpol-pol-bill-to-dt-num to l2400-orig-pol-bill-to-dt-num.
2349        move rpol-pol-sndry-amt to l2400-orig-pol-sndry-amt.
2350        move rpol-pol-tax-typ-cd to l2400-orig-pol-tax-typ-cd.
2351        move rpol-pol-tax-struct-cd to l2400-orig-pol-tax-str-cd.
2352        move rpol-pol-mprem-amt to l2400-orig-pol-mprem-amt.
2353        move rpol-pol-pac-drw-dy-cd to l2400-orig-pol-pac-drw-dy-cd.
2354        move rpol-pol-ul-prces-dt to l2400-orig-pol-ul-prces-dt.
2355        move rpol-pol-restr-cd to l2400-orig-pol-restr-cd.
2356        move rpol-bnfy-clause-typ-cd to l2400-orig-bnfy-clause-typ-cd.
2357        move rpol-comm-calc-opt-cd to l2400-comm-calc-opt-cd.
2358        move rpol-pol-enhc-chng-dt to l2400-orig-pol-enhc-chng-dt.
2359        move rpol-pol-grs-aprem-amt to l2400-orig-pol-grs-aprem-amt.
2360        move rpol-frst-cvg-enhc-dt to l2400-frst-cvg-enhc-dt.
2361        move rpol-pol-anpayo-1-amt to l2400-anpayo-1-amt.
2362        move rpol-pol-bill-strt-dt to l2400-orig-bill-strt-dt
2363        move rpol-pol-ceas-reasn-cd to l2400-orig-pol-ceas-reasn-cd
2364        move rpol-peri-actv-dur to l2400-orig-peri-actv-dur
2365        move rpol-asso-svc-typ-cd to l2400-asso-svc-typ-cd
2366        move rpol-asso-svc-stat-cd to l2400-asso-svc-stat-cd
2367        move rpol-asso-svc-strt-dt to l2400-asso-svc-strt-dt
2368        move rpol-asso-svc-end-dt to l2400-asso-svc-end-dt
2369        move rpol-pol-redc-mult-fct to l2400-pol-redc-mult-fct
2370        move rpol-pol-rsk-pfl-cd to l2400-orig-pol-rsk-pfl-cd
2371        move rpol-latst-bnfy-chng-dt to l2400-orig-latst-bnfy-chng-dt
2372        move rpol-latst-bnfy-nochng-dt to l2400-ori-latst-bnfy-nochng-dt
2373        move rpol-bnfy-nochng-cd to l2400-orig-bnfy-nochng-cd
2374        move rpol-lapse-reasn-cd to l2400-orig-lapse-reasn-cd
2375        move rpol-lapse-sub-reasn-cd to l2400-orig-lapse-sub-reasn-cd
2376        continue.
2377    2400-0100-init-orig-policy-x.
2378        exit.
2379    2400-0200-init-orig-cvgs.
2380        move wcvgs-cvg-cstat-cd(l2400-cvg) to l2400-orig-cvg-cstat-cd(l2400-cvg)
2381        move wcvgs-plan-id-base(l2400-cvg) to l2400-orig-plan-id-base(l2400-cvg) .
2382        move wcvgs-plan-id-rs(l2400-cvg) to l2400-orig-plan-id-rs(l2400-cvg) .
2383        move wcvgs-cvg-smkr-cd(l2400-cvg) to l2400-orig-cvg-smkr-cd(l2400-cvg) .
2384        move wcvgs-cvg-par-cd(l2400-cvg) to l2400-orig-cvg-par-cd(l2400-cvg) .
2385        move wcvgs-cvg-sex-cd(l2400-cvg) to l2400-orig-cvg-sex-cd(l2400-cvg) .
2386        move wcvgs-cvg-rt-age(l2400-cvg) to l2400-orig-cvg-rt-age(l2400-cvg) .
2387        move wcvgs-cvg-stbl-1-cd(l2400-cvg) to l2400-orig-cvg-stbl-1-cd(l2400-cvg) .
2388        move wcvgs-cvg-dedbl-peri-cd(l2400-cvg) to l2400-orig-cvg-stbl-2-cd(l2400-cvg)
2389        if wcvgs-cvg-bnft-obs-fin(l2400-cvg)
start:47      2389          if wcvgs-cvg-bnft-obs-fin(l2400-cvg)
2390        move wcvgs-prem-pay-dur(l2400-cvg) to l2400-orig-cvg-stbl-3-cd(l2400-cvg)
2391        else
end:46      2391          else
start:47      2391          else
2392        move wcvgs-cvg-allow-dur-cd(l2400-cvg) to l2400-orig-cvg-stbl-3-cd(l2400-cvg)
2393        end-if
end:46      2393          end-if
2394        move wcvgs-cvg-occp-clas-cd(l2400-cvg) to l2400-orig-cvg-stbl-4-cd(l2400-cvg) .
2395        move wcvgs-rel-cvg-num(l2400-cvg) to l2400-orig-rel-cvg-num(l2400-cvg) .
2396        move wcvgs-cvg-enhc-typ-cd(l2400-cvg) to l2400-orig-cvg-enhc-typ-cd(l2400-cvg) .
2397        move wcvgs-cvg-fe-reasn-cd(l2400-cvg) to l2400-orig-cvg-fe-reasn-cd(l2400-cvg) .
2398        move wcvgs-cvg-me-fct(l2400-cvg) to l2400-orig-cvg-me-fct(l2400-cvg) .
2399        move wcvgs-cvg-me-reasn-cd(l2400-cvg) to l2400-orig-cvg-me-reasn-cd(l2400-cvg) .
2400        move wcvgs-age-rat-reasn-cd(l2400-cvg) to l2400-orig-age-rat-reasn-cd(l2400-cvg) .
2401        move wcvgs-ult-prem-rt-age(l2400-cvg) to l2400-orig-ult-prem-rt-age(l2400-cvg) .
2402        move wcvgs-cvg-iss-eff-dt(l2400-cvg) to l2400-orig-cvg-iss-eff-dt(l2400-cvg) .
2403        move wcvgs-cvg-int-payo-cd(l2400-cvg) to l2400-orig-cvg-int-payo-cd(l2400-cvg) .
2404        move wcvgs-anim-nm(l2400-cvg) to l2400-anim-nm(l2400-cvg)
2405        move wcvgs-anim-num(l2400-cvg) to l2400-anim-num(l2400-cvg)
2406        move wcvgs-cvg-mprem-amt(l2400-cvg) to l2400-orig-cvg-mprem-amt(l2400-cvg) .
2407        move wcvgs-cvg-restr-prem-cd(l2400-cvg) to l2400-orig-cvg-restr-prem-cd(l2400-cvg) .
2408        move wcvgs-cvg-basic-prem-amt(l2400-cvg) to l2400-orig-cvg-basic-prem-amt(l2400-cvg) .
2409        if rpol-pol-ins-typ-fpa-segf
start:47      2409          if rpol-pol-ins-typ-fpa-segf
2410        move wcvgs-cvg-in-alloc-cd(l2400-cvg) to l2400-orig-cvg-in-alloc-cd(l2400-cvg)
2411        move wcvgs-in-alloc-amt-pct(l2400-cvg) to l2400-orig-in-alloc-amt-pct(l2400-cvg)
2412        end-if
end:46      2412          end-if
2413        move wcvgs-mat-xpry-recalc-cd(l2400-cvg) to l2400-orig-mat-xpry-recalc-cd(l2400-cvg) .
2414        move wcvgs-cvg-mat-xpry-dt(l2400-cvg) to l2400-orig-cvg-mat-xpry-dt(l2400-cvg) .
2415        move wcvgs-cvg-rsk-excl-ind(l2400-cvg) to l2400-orig-cvg-rsk-excl-ind(l2400-cvg) .
2416        if rpol-pol-ins-typ-fpa-segf
start:47      2416          if rpol-pol-ins-typ-fpa-segf
2417        move wcvgs-min-grs-aprem-amt(l2400-cvg) to l2400-orig-min-grs-aprem-amt(l2400-cvg)
2418        move wcvgs-cvg-enhc-amt(l2400-cvg) to l2400-orig-cvg-enhc-amt(l2400-cvg)
2419        move wcvgs-cvg-enhc-rt(l2400-cvg) to l2400-orig-cvg-enhc-rt(l2400-cvg)
2420        move wcvgs-cvg-ia-gar-amt(l2400-cvg) to l2400-orig-cvg-ia-gar-amt(l2400-cvg)
2421        move wcvgs-cvg-guar-int-pct(l2400-cvg) to l2400-orig-cvg-guar-int-pct(l2400-cvg)
2422        else
end:46      2422          else
start:47      2422          else
2423        if not rpol-pol-ins-typ-immed-anty
start:48      2423          if not rpol-pol-ins-typ-immed-anty
2424        move wcvgs-cvg-ad-mult-fct(l2400-cvg) to l2400-orig-cvg-ad-mult-fct(l2400-cvg)
2425        move wcvgs-cvg-me-dur(l2400-cvg) to l2400-orig-cvg-me-dur(l2400-cvg)
2426        move wcvgs-ult-prem-rt-cd(l2400-cvg) to l2400-orig-ult-prem-rt-cd(l2400-cvg)
2427        move wcvgs-cvg-iad-xpry-dt(l2400-cvg) to l2400-orig-cvg-iad-xpry-dt(l2400-cvg)
2428        move wcvgs-cvg-rfnd-due-amt(l2400-cvg) to l2400-orig-cvg-rfnd-due-amt(l2400-cvg)
2429        move wcvgs-cvg-ad-xpry-dt(l2400-cvg) to l2400-orig-cvg-ad-xpry-dt(l2400-cvg)
2430        move wcvgs-cvg-ad-me-dur(l2400-cvg) to l2400-orig-cvg-ad-me-dur(l2400-cvg)
2431        move wcvgs-cvg-ad-pm-dur(l2400-cvg) to l2400-orig-cvg-ad-pm-dur(l2400-cvg)
2432        move wcvgs-cvg-face-amt(l2400-cvg) to l2400-orig-cvg-face-amt(l2400-cvg)
2433        move wcvgs-cvg-iad-mult-fct(l2400-cvg) to l2400-orig-cvg-iad-mult-fct(l2400-cvg)
2434        move wcvgs-cvg-ad-face-amt(l2400-cvg) to l2400-orig-cvg-ad-face-amt(l2400-cvg)
2435        move wcvgs-cvg-fe-uprem-amt(l2400-cvg) to l2400-orig-cvg-fe-uprem-amt(l2400-cvg)
2436        move wcvgs-cvg-fe-dur(l2400-cvg) to l2400-orig-cvg-fe-dur(l2400-cvg)
2437        move wcvgs-cvg-entr-aprem-amt(l2400-cvg) to l2400-orig-cvg-entr-aprem-amt(l2400-cvg)
2438        move wcvgs-cvg-calc-aprem-amt(l2400-cvg) to l2400-orig-cvg-calc-aprem-amt(l2400-cvg)
2439        move wcvgs-cvg-ad-prem-amt(l2400-cvg) to l2400-orig-cvg-ad-prem-amt(l2400-cvg)
2440        move wcvgs-cvg-ad-me-prem-amt(l2400-cvg) to l2400-orig-cvg-ad-me-prem-amt(l2400-cvg)
2441        move wcvgs-cvg-iad-prem-amt(l2400-cvg) to l2400-orig-cvg-iad-prem-amt(l2400-cvg)
2442        move wcvgs-iad-me-prem-amt(l2400-cvg) to l2400-orig-cvg-iad-me-prem-amt(l2400-cvg)
2443        move wcvgs-cvg-fe-prem-amt(l2400-cvg) to l2400-orig-cvg-fe-prem-amt(l2400-cvg)
2444        move wcvgs-cvg-me-prem-amt(l2400-cvg) to l2400-orig-cvg-me-prem-amt(l2400-cvg)
2445        move wcvgs-cvg-sale-tax-amt(l2400-cvg) to l2400-orig-cvg-sale-tax-amt(l2400-cvg)
2446        move wcvgs-cvg-prem-redc-pct(l2400-cvg) to l2400-orig-cvg-prem-redc-pct(l2400-cvg)
2447        move wcvgs-cvg-sum-ins-amt(l2400-cvg) to l2400-orig-cvg-sum-ins-amt(l2400-cvg)
2448        move wcvgs-cvg-ad-pm-fct(l2400-cvg) to l2400-orig-cvg-ad-pm-fct(l2400-cvg)
2449        move wcvgs-cvg-ad-pm-prem-amt(l2400-cvg) to l2400-orig-cvg-ad-pm-prem-amt(l2400-cvg)
2450        move wcvgs-ke-face-amt(l2400-cvg) to l2400-orig-ke-face-amt(l2400-cvg)
2451        move wcvgs-ke-prem-amt(l2400-cvg) to l2400-orig-ke-prem-amt(l2400-cvg)
2452        move wcvgs-ass-aprem-amt(l2400-cvg) to l2400-orig-ass-aprem-amt(l2400-cvg)
2453        move wcvgs-cvg-redc-mult-fct(l2400-cvg) to l2400-orig-cvg-redc-mult-fct(l2400-cvg)
2454        move wcvgs-ke-redc-mult-fct(l2400-cvg) to l2400-orig-ke-redc-mult-fct(l2400-cvg)
2455        move wcvgs-ass-ind(l2400-cvg) to l2400-orig-ass-ind(l2400-cvg)
2456        end-if
end:47      2456          end-if
2457        end-if
end:46      2457          end-if
2458        move wcvgs-cvg-clm-chq-dt(l2400-cvg) to l2400-orig-cvg-clm-chq-dt(l2400-cvg)
2459        move wcvgs-cvgf-seq-num(l2400-cvg) to l2400-orig-cvgf-seq-num(l2400-cvg)
2460        continue.
2461    2400-0200-init-orig-cvgs-x.
2462        exit.
2463    2400-1000-build-parm-info.
2464        if l2400-generate-history-no
start:47      2464          if l2400-generate-history-no
2465        go to 2400-1000-build-parm-info-x
start:48      2465          go to 2400-1000-build-parm-info-x
2468    2400-1000-build-parm-info-x.
2469        exit.
2470    2400-1300-build-input-parms.
2471        move rpol-pol-id to l2400-pol-id.
2472        move rpol-pol-spnd-ind to l2400-pol-spnd-ind.
2473        move rpol-pol-spnd-eff-dt to l2400-pol-spnd-eff-dt.
2474        move rpol-pol-ins-typ-cd to l2400-pol-ins-typ-cd.
2475        move rpol-pol-ul-prces-dt to l2400-pol-ul-prces-dt.
2476        move rpol-pol-pd-to-dt-num to l2400-pol-pd-to-dt-num.
2477        move rpol-latst-actv-dt to l2400-latst-actv-dt.
2478        move rpol-earlst-revrs-dt to l2400-earlst-revrs-dt.
2479        move wglob-process-date to l2400-eff-dt.
2480        move zero to l2400-cvg.
2481        move rpol-cd-opt-ofp-act to l2400-cd-opt-ofp-act.
2482    2400-1300-build-input-parms-x.
2483        exit.
2484    2400-2000-retrn-parm-info.
2485        if l2400-updt-pol-yes
start:49      2485          if l2400-updt-pol-yes
2486        move l2400-latst-actv-dt to rpol-latst-actv-dt
2487        move l2400-earlst-revrs-dt to rpol-earlst-revrs-dt
2488        end-if.
end:48      2488          end-if.
2489    2400-2000-retrn-parm-info-x.
2490        exit.
2491    2400-9000-reset-indicators.
2492        if l2400-generate-history-active
start:49      2492          if l2400-generate-history-active
2493        if lpga-pchst-area-init-active
start:50      2493          if lpga-pchst-area-init-active
2494        set lpga-pchst-area-initialized-no to true
2495        end-if
end:49      2495          end-if
2496        if lpga-pchst-area-init-both
start:50      2496          if lpga-pchst-area-init-both
2497        set lpga-pchst-area-init-info to true
2498        end-if
end:49      2498          end-if
2499        end-if.
end:48      2499          end-if.
2500        if l2400-generate-history-info
start:49      2500          if l2400-generate-history-info
2501        if lpga-pchst-area-init-info
start:50      2501          if lpga-pchst-area-init-info
2502        set lpga-pchst-area-initialized-no to true
2503        end-if
end:49      2503          end-if
2504        if lpga-pchst-area-init-both
start:50      2504          if lpga-pchst-area-init-both
2505        set lpga-pchst-area-init-active to true
2506        end-if
end:49      2506          end-if
2507        end-if.
end:48      2507          end-if.
2508    2400-9000-reset-indicators-x.
2509        exit.
2510    2400-9100-check-for-history.
2511        if l2400-create-history
start:49      2511          if l2400-create-history
2512        set l2400-generate-history-info to true
2513        else
end:48      2513          else
start:49      2513          else
2514        set l2400-generate-history-no to true
2515        end-if.
end:48      2515          end-if.
2516    2400-9100-check-for-history-x.
2517        exit.
2518    2400-0000-call.
2519        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2520        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2521        move 'vib3676' to wpgws-call-pgm-id.
2522        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2523        call wpgws-call-pgm-id using wglob-global-area l2400-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2524        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2525        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2526    2400-0000-call-x.
2527        exit.
2528    2400-1000-generate-phst.
2529        set l2400-rqst-generate-phst to true.
2530        perform 2400-0000-call thru 2400-0000-call-x.
start:49      2530          perform 2400-0000-call thru 2400-0000-call-x.
2518    2400-0000-call.
2519        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2520        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2521        move 'vib3676' to wpgws-call-pgm-id.
2522        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2523        call wpgws-call-pgm-id using wglob-global-area l2400-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2524        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2525        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2526    2400-0000-call-x.
2527        exit.
2530        perform 2400-0000-call thru 2400-0000-call-x.
end:48      2530          perform 2400-0000-call thru 2400-0000-call-x.
2531    2400-1000-generate-phst-x.
2532        exit.
2533    4330-1000-build-parm-info.
2534        initialize l4330-input-parm-info.
2535        initialize l4330-io-parm-info.
2536        move wwkdt-zero-dt to l4330-eff-dt.
2537        move rpol-pol-crcy-cd to l4330-pol-crcy-cd.
2538    4330-1000-build-parm-info-x.
2539        exit.
2540    4330-0000-call.
2541        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2542        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2543        move 'vib3733' to wpgws-call-pgm-id.
2544        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2545        call wpgws-call-pgm-id using wglob-global-area l4330-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2546        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2547        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2548    4330-0000-call-x.
2549        exit.
2550    4330-1000-payo-maint.
2551        set l4330-rqst-payo-maint to true.
2552        perform 4330-0000-call thru 4330-0000-call-x.
start:49      2552          perform 4330-0000-call thru 4330-0000-call-x.
2540    4330-0000-call.
2541        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2542        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2543        move 'vib3733' to wpgws-call-pgm-id.
2544        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2545        call wpgws-call-pgm-id using wglob-global-area l4330-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2546        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2547        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2548    4330-0000-call-x.
2549        exit.
2552        perform 4330-0000-call thru 4330-0000-call-x.
end:48      2552          perform 4330-0000-call thru 4330-0000-call-x.
2553    4330-1000-payo-maint-x.
2554        exit.
2555    4320-0000-call.
2556        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2557        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2558        move 'vib3732' to wpgws-call-pgm-id.
2559        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2560        call wpgws-call-pgm-id using wglob-global-area l4320-parm-info.
2561        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2562        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2563    4320-0000-call-x.
2564        exit.
2565    4320-1000-calc-next-payo-dt.
2566        set l4320-rqst-nxt-payo-dt to true.
2567        perform 4320-0000-call thru 4320-0000-call-x.
start:49      2567          perform 4320-0000-call thru 4320-0000-call-x.
2555    4320-0000-call.
2556        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2557        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2558        move 'vib3732' to wpgws-call-pgm-id.
2559        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2560        call wpgws-call-pgm-id using wglob-global-area l4320-parm-info.
2561        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2562        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2563    4320-0000-call-x.
2564        exit.
2567        perform 4320-0000-call thru 4320-0000-call-x.
end:48      2567          perform 4320-0000-call thru 4320-0000-call-x.
2568    4320-1000-calc-next-payo-dt-x.
2569        exit.
2570    4320-1000-build-parm-info.
2571        initialize l4320-input-parm-info.
2572        move rpol-pol-id to l4320-pol-id.
2573    4320-1000-build-parm-info-x.
2574        exit.
2575    0500-1000-build-parm-info.
2576        initialize l0500-input-parm-info.
2577        initialize l0500-io-parm-info.
2578    0500-1000-build-parm-info-x.
2579        exit.
2580    0500-0000-call.
2581        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2582        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2583        move 'vib3402' to wpgws-call-pgm-id.
2584        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2585        call wpgws-call-pgm-id using wglob-global-area l0500-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2586        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2587        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2588    0500-0000-call-x.
2589        exit.
2590    0500-1000-process-fc-fs.
2591        set l0500-rqst-process-fc-fs to true.
2592        perform 0500-0000-call thru 0500-0000-call-x.
start:49      2592          perform 0500-0000-call thru 0500-0000-call-x.
2580    0500-0000-call.
2581        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2582        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2583        move 'vib3402' to wpgws-call-pgm-id.
2584        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2585        call wpgws-call-pgm-id using wglob-global-area l0500-parm-info lsegf-parm-info lpga-parm-info rpol-rec-info wcvgs-work-area.
2586        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2587        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2588    0500-0000-call-x.
2589        exit.
2592        perform 0500-0000-call thru 0500-0000-call-x.
end:48      2592          perform 0500-0000-call thru 0500-0000-call-x.
2593    0500-1000-process-fc-fs-x.
2594        exit.
2595    2430-1000-build-parm-info.
2596        move rpol-pol-id to l2430-pol-id.
2597        move lpga-input-own-cli-id(1) to l2430-input-own-cli-id(1) .
2598        move lpga-input-own-cli-id(2) to l2430-input-own-cli-id(2) .
2599        move lpga-input-ins-cli-id(1) to l2430-input-ins-cli-id(1) .
2600        move lpga-input-ins-cli-id(2) to l2430-input-ins-cli-id(2) .
2601        set l2430-get-cli-info-y to true
2602        if i > zero
start:49      2602          if i > zero
2603        move i to l2430-cvg
2604        else
end:48      2604          else
start:49      2604          else
2605        move rpol-pol-base-cvg-num to l2430-cvg
2606        end-if.
end:48      2606          end-if.
2607    2430-1000-build-parm-info-x.
2608        exit.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2619    2430-1000-build-pol-rel-info.
2620        set l2430-rqst-build-pol-rel to true.
2621        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2621          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2621        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2621          perform 2430-0000-call thru 2430-0000-call-x.
2622    2430-1000-build-pol-rel-info-x.
2623        exit.
2624    2430-2000-get-pol-rel-info.
2625        set l2430-rqst-get-pol-rel to true.
2626        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2626          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2626        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2626          perform 2430-0000-call thru 2430-0000-call-x.
2627    2430-2000-get-pol-rel-info-x.
2628        exit.
2629    2430-2100-get-owner.
2630        set l2430-rqst-get-pol-rel to true.
2631        set l2430-cli-rel-typ-owner to true.
2632        set l2430-cli-rel-sub-prim to true.
2633        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2633          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2633        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2633          perform 2430-0000-call thru 2430-0000-call-x.
2634    2430-2100-get-owner-x.
2635        exit.
2636    2430-2120-get-cntngnt-owner.
2637        set l2430-rqst-get-pol-rel to true.
2638        set l2430-cli-rel-typ-owner to true.
2639        set l2430-cli-rel-sub-contgt to true.
2640        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2640          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2640        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2640          perform 2430-0000-call thru 2430-0000-call-x.
2641    2430-2120-get-cntngnt-owner-x.
2642        exit.
2643    2430-2200-get-payor.
2644        set l2430-rqst-get-pol-rel to true.
2645        set l2430-cli-rel-typ-prim to true.
2646        set l2430-cli-rel-sub-spaces to true.
2647        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2647          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2647        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2647          perform 2430-0000-call thru 2430-0000-call-x.
2648    2430-2200-get-payor-x.
2649        exit.
2650    2430-2210-get-ini-payor.
2651        set l2430-rqst-get-pol-rel to true.
2652        set l2430-cli-rel-typ-ini-payor to true.
2653        set l2430-cli-rel-sub-spaces to true.
2654        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2654          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2654        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2654          perform 2430-0000-call thru 2430-0000-call-x.
2655    2430-2210-get-ini-payor-x.
2656        exit.
2657    2430-2300-get-listbill.
2658        set l2430-rqst-get-pol-rel to true.
2659        set l2430-cli-rel-typ-listbl to true.
2660        set l2430-cli-rel-sub-spaces to true.
2661        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2661          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2661        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2661          perform 2430-0000-call thru 2430-0000-call-x.
2662    2430-2300-get-listbill-x.
2663        exit.
2664    2430-2400-get-mailing.
2665        set l2430-rqst-get-pol-rel to true.
2666        set l2430-cli-rel-typ-mail to true.
2667        set l2430-cli-rel-sub-spaces to true.
2668        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2668          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2668        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2668          perform 2430-0000-call thru 2430-0000-call-x.
2669    2430-2400-get-mailing-x.
2670        exit.
2671    2430-2500-get-annuitant.
2672        set l2430-rqst-get-pol-rel to true.
2673        set l2430-cli-rel-typ-anutnt to true.
2674        set l2430-cli-rel-sub-spaces to true.
2675        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2675          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2675        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2675          perform 2430-0000-call thru 2430-0000-call-x.
2676    2430-2500-get-annuitant-x.
2677        exit.
2678    2430-2510-get-first-anutnt.
2679        set l2430-rqst-get-pol-rel to true.
2680        set l2430-cli-rel-typ-anutnt to true.
2681        set l2430-cli-rel-sub-spaces to true.
2682        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2682          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2682        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2682          perform 2430-0000-call thru 2430-0000-call-x.
2683    2430-2510-get-first-anutnt-x.
2684        exit.
2685    2430-2520-get-second-anutnt.
2686        set l2430-rqst-get-pol-rel to true.
2687        set l2430-cli-rel-typ-co-anutnt to true.
2688        set l2430-cli-rel-sub-spaces to true.
2689        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2689          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2689        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2689          perform 2430-0000-call thru 2430-0000-call-x.
2690    2430-2520-get-second-anutnt-x.
2691        exit.
2692    2430-2600-get-assignee.
2693        set l2430-rqst-get-pol-rel to true.
2694        set l2430-cli-rel-typ-assign to true.
2695        set l2430-cli-rel-sub-spaces to true.
2696        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2696          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2696        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2696          perform 2430-0000-call thru 2430-0000-call-x.
2697    2430-2600-get-assignee-x.
2698        exit.
2699    2430-2700-get-spouse.
2700        set l2430-rqst-get-pol-rel to true.
2701        set l2430-cli-rel-typ-spouse to true.
2702        set l2430-cli-rel-sub-spaces to true.
2703        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2703          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2703        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2703          perform 2430-0000-call thru 2430-0000-call-x.
2704    2430-2700-get-spouse-x.
2705        exit.
2706    2430-2800-get-trustee.
2707        set l2430-rqst-get-pol-rel to true.
2708        set l2430-cli-rel-typ-trustee to true.
2709        set l2430-cli-rel-sub-spaces to true.
2710        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2710          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2710        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2710          perform 2430-0000-call thru 2430-0000-call-x.
2711    2430-2800-get-trustee-x.
2712        exit.
2713    2430-3000-get-cvg-rel-info.
2714        set l2430-rqst-get-cvg-rel to true.
2715        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2715          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2715        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2715          perform 2430-0000-call thru 2430-0000-call-x.
2716    2430-3000-get-cvg-rel-info-x.
2717        exit.
2718    2430-3100-get-prim-insrd.
2719        set l2430-rqst-get-cvg-rel to true.
2720        set l2430-cli-rel-typ-prim to true.
2721        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2721          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2721        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2721          perform 2430-0000-call thru 2430-0000-call-x.
2722    2430-3100-get-prim-insrd-x.
2723        exit.
2724    2430-3120-get-contgt-insured.
2725        set l2430-rqst-get-cvg-rel to true.
2726        set l2430-cli-rel-typ-contgt to true.
2727        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2727          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2727        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2727          perform 2430-0000-call thru 2430-0000-call-x.
2728    2430-3120-get-contgt-insured-x.
2729        exit.
2730    2430-3200-get-jnt-rel-info.
2731        set l2430-rqst-get-cvg-rel to true.
2732        set l2430-cli-rel-typ-owner to true.
2733        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2733          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2733        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2733          perform 2430-0000-call thru 2430-0000-call-x.
2734    2430-3200-get-jnt-rel-info-x.
2735        exit.
2736    2430-4000-get-cvg-cli-id.
2737        set l2430-rqst-get-cvg-cli-id to true.
2738        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2738          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2738        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2738          perform 2430-0000-call thru 2430-0000-call-x.
2739    2430-4000-get-cvg-cli-id-x.
2740        exit.
2741    2430-4100-prim-insrd-key.
2742        set l2430-rqst-get-cvg-cli-id to true.
2743        set l2430-cli-rel-typ-prim to true.
2744        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2744          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2744        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2744          perform 2430-0000-call thru 2430-0000-call-x.
2745    2430-4100-prim-insrd-key-x.
2746        exit.
2747    2430-4150-contgt-insrd-key.
2748        set l2430-rqst-get-cvg-cli-id to true.
2749        set l2430-cli-rel-typ-contgt to true.
2750        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2750          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2750        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2750          perform 2430-0000-call thru 2430-0000-call-x.
2751    2430-4150-contgt-insrd-key-x.
2752        exit.
2753    2430-4200-jnt-insrd-cli-id.
2754        set l2430-rqst-get-cvg-cli-id to true.
2755        set l2430-cli-rel-typ-owner to true.
2756        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2756          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2756        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2756          perform 2430-0000-call thru 2430-0000-call-x.
2757    2430-4200-jnt-insrd-cli-id-x.
2758        exit.
2759    2430-5000-validate-owner-nm.
2760        set l2430-rqst-validate-owner-nm to true.
2761        set l2430-cli-rel-typ-owner to true.
2762        set l2430-cli-rel-sub-prim to true.
2763        perform 2430-0000-call thru 2430-0000-call-x.
start:49      2763          perform 2430-0000-call thru 2430-0000-call-x.
2609    2430-0000-call.
2610        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2611        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2612        move 'vib3685' to wpgws-call-pgm-id.
2613        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2614        call wpgws-call-pgm-id using wglob-global-area l2430-parm-info.
2615        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2616        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2617    2430-0000-call-x.
2618        exit.
2763        perform 2430-0000-call thru 2430-0000-call-x.
end:48      2763          perform 2430-0000-call thru 2430-0000-call-x.
2764    2430-5000-validate-owner-nm-x.
2765        exit.
2766    9972-0000-call.
2767        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2768        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2769        move 'vib3d72' to wpgws-call-pgm-id.
2770        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2771        call wpgws-call-pgm-id using wglob-global-area l9972-parm-info lpga-parm-info.
2772        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2773        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2774    9972-0000-call-x.
2775        exit.
2776    9972-1000-next-mode-dt.
2777        set l9972-rqst-next-mode-dt to true.
2778        perform 9972-0000-call thru 9972-0000-call-x.
start:49      2778          perform 9972-0000-call thru 9972-0000-call-x.
2766    9972-0000-call.
2767        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2768        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2769        move 'vib3d72' to wpgws-call-pgm-id.
2770        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2771        call wpgws-call-pgm-id using wglob-global-area l9972-parm-info lpga-parm-info.
2772        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2773        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2774    9972-0000-call-x.
2775        exit.
2778        perform 9972-0000-call thru 9972-0000-call-x.
end:48      2778          perform 9972-0000-call thru 9972-0000-call-x.
2779    9972-1000-next-mode-dt-x.
2780        exit.
2781    9972-2000-prev-mode-dt.
2782        set l9972-rqst-prev-mode-dt to true.
2783        perform 9972-0000-call thru 9972-0000-call-x.
start:49      2783          perform 9972-0000-call thru 9972-0000-call-x.
2766    9972-0000-call.
2767        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2768        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2769        move 'vib3d72' to wpgws-call-pgm-id.
2770        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2771        call wpgws-call-pgm-id using wglob-global-area l9972-parm-info lpga-parm-info.
2772        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2773        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2774    9972-0000-call-x.
2775        exit.
2783        perform 9972-0000-call thru 9972-0000-call-x.
end:48      2783          perform 9972-0000-call thru 9972-0000-call-x.
2784    9972-2000-prev-mode-dt-x.
2785        exit.
2786    9972-3000-next-start-dt.
2787        set l9972-rqst-next-start-dt to true.
2788        perform 9972-0000-call thru 9972-0000-call-x.
start:49      2788          perform 9972-0000-call thru 9972-0000-call-x.
2766    9972-0000-call.
2767        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2768        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2769        move 'vib3d72' to wpgws-call-pgm-id.
2770        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2771        call wpgws-call-pgm-id using wglob-global-area l9972-parm-info lpga-parm-info.
2772        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2773        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2774    9972-0000-call-x.
2775        exit.
2788        perform 9972-0000-call thru 9972-0000-call-x.
end:48      2788          perform 9972-0000-call thru 9972-0000-call-x.
2789    9972-3000-next-start-dt-x.
2790        exit.
2791    9972-4000-prev-start-dt.
2792        set l9972-rqst-prev-start-dt to true.
2793        perform 9972-0000-call thru 9972-0000-call-x.
start:49      2793          perform 9972-0000-call thru 9972-0000-call-x.
2766    9972-0000-call.
2767        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2768        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2769        move 'vib3d72' to wpgws-call-pgm-id.
2770        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2771        call wpgws-call-pgm-id using wglob-global-area l9972-parm-info lpga-parm-info.
2772        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2773        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2774    9972-0000-call-x.
2775        exit.
2793        perform 9972-0000-call thru 9972-0000-call-x.
end:48      2793          perform 9972-0000-call thru 9972-0000-call-x.
2794    9972-4000-prev-start-dt-x.
2795        exit.
2796    fs-1000-create.
2797        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2798        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2799        move 'viid456' to wpgws-call-pgm-id.
2800        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2801        set wfs-rqst-init-tbl-layout to true.
2802        call wpgws-call-pgm-id using wfs-io-work-area rfs-rec-info.
2803        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2804        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2805    fs-1000-create-x.
2806        exit.
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:49      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:50      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:51      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:50      3336          else
start:51      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:50      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:50      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:49      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:48      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2826    cvgu-1000-browse.
2827        if wcvgu-company-required
start:49      2827          if wcvgu-company-required
2828        move wglob-company-code to wcvgu-co-id
2829        move wglob-company-code to wcvgu-endbr-co-id
2830        else
end:48      2830          else
start:49      2830          else
2831        move spaces to wcvgu-co-id
2832        move spaces to wcvgu-endbr-co-id
2833        end-if
end:48      2833          end-if
2834        set wcvgu-rqst-browse to true
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:49      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:50      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:49      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2835        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:48      2835          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2836        continue.
2837    cvgu-1000-browse-x.
2838        exit.
2839    cvgu-2000-read-next.
2840        set wcvgu-rqst-fetch-next to true
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:49      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:50      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:49      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2841        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:48      2841          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2842        continue.
2843    cvgu-2000-read-next-x.
2844        exit.
2845    cvgu-3000-end-browse.
2846        set wcvgu-rqst-close-browse-cur to true
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:49      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:50      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:49      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2847        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:48      2847          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2848        continue.
2849    cvgu-3000-end-browse-x.
2850        exit.
2851    cvgu-4000-count.
2852        if wcvgu-company-required
start:49      2852          if wcvgu-company-required
2853        move wglob-company-code to wcvgu-co-id
2854        move wglob-company-code to wcvgu-endbr-co-id
2855        else
end:48      2855          else
start:49      2855          else
2856        move spaces to wcvgu-co-id
2857        move spaces to wcvgu-endbr-co-id
2858        end-if
end:48      2858          end-if
2859        set wcvgu-rqst-count to true
2860        move zero to wcvgu-count
2861        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
start:49      2861          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2807    cvgu-0000-call-bncvgufs.
2808        move wglob-prev-pgm-id to wpgws-prev-pgm-id
2809        move wpgws-crnt-pgm-id to wglob-prev-pgm-id
2810        move 'viid0c81' to wpgws-call-pgm-id
2811        move wpgws-call-pgm-id to wglob-crnt-pgm-id
2812        call wpgws-call-pgm-id using sqlca wcvgu-io-work-area rcvgu-rec-info
2813        if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
start:50      2813          if wcvgu-io-error or (wcvgu-optm-sql-imprv and wcvgu-optm-sql-reqir not = '00')
2814        move wcvgu-table-name to l0030-table-name
2815        move wcvgu-rqst-cd to l0030-io-command
2816        move wcvgu-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2817        move wcvgu-optm-sql-reqir to l0030-optm-sql-reqir
2818        move wcvgu-optm-sql-exec to l0030-optm-sql-exec
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2819        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      2819          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2820        end-if
end:49      2820          end-if
2821        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id
2822        move wpgws-prev-pgm-id to wglob-prev-pgm-id
2823        continue.
2824    cvgu-0000-call-bncvgufs-x.
2825        exit.
2861        perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
end:48      2861          perform cvgu-0000-call-bncvgufs thru cvgu-0000-call-bncvgufs-x
2862        continue.
2863    cvgu-4000-count-x.
2864        exit.
2865    fr-1000-read.
2866        if wfr-company-required
start:49      2866          if wfr-company-required
2867        move wglob-company-code to wfr-co-id
2868        else
end:48      2868          else
start:49      2868          else
2869        move spaces to wfr-co-id
2870        end-if.
end:48      2870          end-if.
2871        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2872        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2873        if wglob-fr-tbl-loaded-whole
start:49      2873          if wglob-fr-tbl-loaded-whole
2874        move 'viid0b33' to wpgws-call-pgm-id
2875        else
end:48      2875          else
start:49      2875          else
2876        move 'viid450' to wpgws-call-pgm-id
2877        end-if
end:48      2877          end-if
2878        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2879        set wfr-tbl-address to wglob-fr-tbl-address
2880        move wglob-fr-stack-ptr to wfr-stack-ptr
2881        set wfr-rqst-select to true.
2882        call wpgws-call-pgm-id using sqlca wfr-io-work-area rfr-rec-info.
2883        if wfr-io-error
start:49      2883          if wfr-io-error
2884        move wfr-table-name to l0030-table-name
2885        move wfr-rqst-cd to l0030-io-command
2886        move wfr-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2887        move wfr-optm-sql-reqir to l0030-optm-sql-reqir
2888        move wfr-optm-sql-exec to l0030-optm-sql-exec
2889        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:50      2889          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:51      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:50      3336          else
start:51      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:50      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:50      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2889        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:49      2889          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2890        end-if.
end:48      2890          end-if.
2891        move wfr-stack-ptr to wglob-fr-stack-ptr
2892        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2893        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2894    fr-1000-read-x.
2895        exit.
2896    fh-1000-read.
2897        if wfh-company-required
start:49      2897          if wfh-company-required
2898        move wglob-company-code to wfh-co-id
2899        else
end:48      2899          else
start:49      2899          else
2900        move spaces to wfh-co-id
2901        end-if.
end:48      2901          end-if.
2902        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2903        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2904        if wglob-fh-tbl-loaded-whole
start:49      2904          if wglob-fh-tbl-loaded-whole
2905        move 'viid0b32' to wpgws-call-pgm-id
2906        else
end:48      2906          else
start:49      2906          else
2907        move 'viid447' to wpgws-call-pgm-id
2908        end-if
end:48      2908          end-if
2909        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2910        set wfh-tbl-address to wglob-fh-tbl-address
2911        move wglob-fh-stack-ptr to wfh-stack-ptr
2912        set wfh-rqst-select to true.
2913        call wpgws-call-pgm-id using sqlca wfh-io-work-area rfh-rec-info.
2914        if wfh-io-error
start:49      2914          if wfh-io-error
2915        move wfh-table-name to l0030-table-name
2916        move wfh-rqst-cd to l0030-io-command
2917        move wfh-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2918        move wfh-optm-sql-reqir to l0030-optm-sql-reqir
2919        move wfh-optm-sql-exec to l0030-optm-sql-exec
2920        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:50      2920          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:51      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:50      3336          else
start:51      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:50      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:50      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2920        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:49      2920          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2921        end-if.
end:48      2921          end-if.
2922        move wfh-stack-ptr to wglob-fh-stack-ptr
2923        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2924        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2925    fh-1000-read-x.
2926        exit.
2927    ph-1000-read.
2928        if wph-company-required
start:49      2928          if wph-company-required
2929        move wglob-company-code to wph-co-id
2930        else
end:48      2930          else
start:49      2930          else
2931        move spaces to wph-co-id
2932        end-if.
end:48      2932          end-if.
2933        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2934        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2935        if wglob-ph-tbl-loaded-whole
start:49      2935          if wglob-ph-tbl-loaded-whole
2936        move 'viidc39' to wpgws-call-pgm-id
2937        else
end:48      2937          else
start:49      2937          else
2938        if wglob-ph-tbl-loaded-partl
start:50      2938          if wglob-ph-tbl-loaded-partl
2939        move 'viidc40' to wpgws-call-pgm-id
2940        else
end:49      2940          else
start:50      2940          else
2941        move 'viid710' to wpgws-call-pgm-id
2942        end-if
end:49      2942          end-if
2943        end-if.
end:48      2943          end-if.
2944        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2945        set wph-tbl-address to wglob-ph-tbl-address.
2946        move wglob-ph-stack-ptr to wph-stack-ptr.
2947        set wph-rqst-select to true.
2948        call wpgws-call-pgm-id using sqlca wph-io-work-area rph-rec-info.
2949        if wph-io-error
start:49      2949          if wph-io-error
2950        move wph-table-name to l0030-table-name
2951        move wph-rqst-cd to l0030-io-command
2952        move wph-optm-sql-stat-cd to l0030-optm-sql-stat-cd
2953        move wph-optm-sql-reqir to l0030-optm-sql-reqir
2954        move wph-optm-sql-exec to l0030-optm-sql-exec
2955        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:50      2955          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:51      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:50      3336          else
start:51      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:50      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:50      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
2955        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:49      2955          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
2956        end-if.
end:48      2956          end-if.
2957        move wph-stack-ptr to wglob-ph-stack-ptr.
2958        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2959        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2960    ph-1000-read-x.
2961        exit.
2962    fe-0000-call-csibfe.
2963        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2964        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2965        move 'viid0l69' to wpgws-call-pgm-id.
2966        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2967        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
2968        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2969        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2970    fe-0000-call-csibfe-x.
2971        exit.
2972    fe-1000-browse-prev.
2973        if wfe-company-required
start:49      2973          if wfe-company-required
2974        move wglob-company-code to wfe-co-id
2975        move wglob-company-code to wfe-endbr-co-id
2976        else
end:48      2976          else
start:49      2976          else
2977        move spaces to wfe-co-id
2978        move spaces to wfe-endbr-co-id
2979        end-if
end:48      2979          end-if
2980        set wfe-rqst-browse-prev to true.
2981        perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
start:49      2981          perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
2962    fe-0000-call-csibfe.
2963        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2964        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2965        move 'viid0l69' to wpgws-call-pgm-id.
2966        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2967        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
2968        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2969        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2970    fe-0000-call-csibfe-x.
2971        exit.
2981        perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
end:48      2981          perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
2982    fe-1000-browse-prev-x.
2983        exit.
2984    fe-2000-read-prev.
2985        set wfe-rqst-fetch-prev to true.
2986        perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
start:49      2986          perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
2962    fe-0000-call-csibfe.
2963        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2964        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2965        move 'viid0l69' to wpgws-call-pgm-id.
2966        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2967        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
2968        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2969        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2970    fe-0000-call-csibfe-x.
2971        exit.
2986        perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
end:48      2986          perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
2987    fe-2000-read-prev-x.
2988        exit.
2989    fe-3000-close-prev.
2990        set wfe-rqst-close-br-prev-cur to true.
2991        perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
start:49      2991          perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
2962    fe-0000-call-csibfe.
2963        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
2964        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
2965        move 'viid0l69' to wpgws-call-pgm-id.
2966        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
2967        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
2968        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
2969        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
2970    fe-0000-call-csibfe-x.
2971        exit.
2991        perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
end:48      2991          perform fe-0000-call-csibfe thru fe-0000-call-csibfe-x.
2992    fe-3000-close-prev-x.
2993        exit.
2994    fe-0000-call-csiufe.
2995        if wfe-company-required
start:49      2995          if wfe-company-required
2996        move wglob-company-code to wfe-co-id
2997        move wglob-company-code to wfe-endbr-co-id
2998        else
end:48      2998          else
start:49      2998          else
2999        move spaces to wfe-co-id
3000        move spaces to wfe-endbr-co-id
3001        end-if.
end:48      3001          end-if.
3002        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3003        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3004        move 'viid0l67' to wpgws-call-pgm-id.
3005        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3006        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
3007        if wfe-io-error
start:49      3007          if wfe-io-error
3008        move wfe-table-name to l0030-table-name
3009        move wfe-rqst-cd to l0030-io-command
3010        move wfe-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3011        move wfe-optm-sql-reqir to l0030-optm-sql-reqir
3012        move wfe-optm-sql-exec to l0030-optm-sql-exec
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:50      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:51      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:50      3336          else
start:51      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:50      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:50      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:49      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3014        end-if.
end:48      3014          end-if.
3015        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3016        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3017    fe-0000-call-csiufe-x.
3018        exit.
3019    fe-1000-read-for-update.
3020        if wfe-company-required
start:49      3020          if wfe-company-required
3021        move wglob-company-code to wfe-co-id
3022        else
end:48      3022          else
start:49      3022          else
3023        move spaces to wfe-co-id
3024        end-if.
end:48      3024          end-if.
3025        set wfe-rqst-select-for-update to true.
3026        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
start:49      3026          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
2994    fe-0000-call-csiufe.
2995        if wfe-company-required
start:50      2995          if wfe-company-required
2996        move wglob-company-code to wfe-co-id
2997        move wglob-company-code to wfe-endbr-co-id
2998        else
end:49      2998          else
start:50      2998          else
2999        move spaces to wfe-co-id
3000        move spaces to wfe-endbr-co-id
3001        end-if.
end:49      3001          end-if.
3002        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3003        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3004        move 'viid0l67' to wpgws-call-pgm-id.
3005        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3006        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
3007        if wfe-io-error
start:50      3007          if wfe-io-error
3008        move wfe-table-name to l0030-table-name
3009        move wfe-rqst-cd to l0030-io-command
3010        move wfe-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3011        move wfe-optm-sql-reqir to l0030-optm-sql-reqir
3012        move wfe-optm-sql-exec to l0030-optm-sql-exec
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3014        end-if.
end:49      3014          end-if.
3015        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3016        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3017    fe-0000-call-csiufe-x.
3018        exit.
3026        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
end:48      3026          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
3027    fe-1000-read-for-update-x.
3028        exit.
3029    fe-2000-fetch-updt.
3030        set wfe-rqst-fetch-next to true.
3031        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
start:49      3031          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
2994    fe-0000-call-csiufe.
2995        if wfe-company-required
start:50      2995          if wfe-company-required
2996        move wglob-company-code to wfe-co-id
2997        move wglob-company-code to wfe-endbr-co-id
2998        else
end:49      2998          else
start:50      2998          else
2999        move spaces to wfe-co-id
3000        move spaces to wfe-endbr-co-id
3001        end-if.
end:49      3001          end-if.
3002        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3003        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3004        move 'viid0l67' to wpgws-call-pgm-id.
3005        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3006        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
3007        if wfe-io-error
start:50      3007          if wfe-io-error
3008        move wfe-table-name to l0030-table-name
3009        move wfe-rqst-cd to l0030-io-command
3010        move wfe-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3011        move wfe-optm-sql-reqir to l0030-optm-sql-reqir
3012        move wfe-optm-sql-exec to l0030-optm-sql-exec
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3014        end-if.
end:49      3014          end-if.
3015        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3016        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3017    fe-0000-call-csiufe-x.
3018        exit.
3031        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
end:48      3031          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
3032    fe-2000-fetch-updt-x.
3033        exit.
3034    fe-3000-rewrite.
3035        set wfe-rqst-update to true.
3036        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
start:49      3036          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
2994    fe-0000-call-csiufe.
2995        if wfe-company-required
start:50      2995          if wfe-company-required
2996        move wglob-company-code to wfe-co-id
2997        move wglob-company-code to wfe-endbr-co-id
2998        else
end:49      2998          else
start:50      2998          else
2999        move spaces to wfe-co-id
3000        move spaces to wfe-endbr-co-id
3001        end-if.
end:49      3001          end-if.
3002        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3003        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3004        move 'viid0l67' to wpgws-call-pgm-id.
3005        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3006        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
3007        if wfe-io-error
start:50      3007          if wfe-io-error
3008        move wfe-table-name to l0030-table-name
3009        move wfe-rqst-cd to l0030-io-command
3010        move wfe-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3011        move wfe-optm-sql-reqir to l0030-optm-sql-reqir
3012        move wfe-optm-sql-exec to l0030-optm-sql-exec
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3014        end-if.
end:49      3014          end-if.
3015        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3016        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3017    fe-0000-call-csiufe-x.
3018        exit.
3036        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
end:48      3036          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
3037    fe-3000-rewrite-x.
3038        exit.
3039    fe-4000-unlock.
3040        set wfe-rqst-close-update-cur to true.
3041        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
start:49      3041          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
2994    fe-0000-call-csiufe.
2995        if wfe-company-required
start:50      2995          if wfe-company-required
2996        move wglob-company-code to wfe-co-id
2997        move wglob-company-code to wfe-endbr-co-id
2998        else
end:49      2998          else
start:50      2998          else
2999        move spaces to wfe-co-id
3000        move spaces to wfe-endbr-co-id
3001        end-if.
end:49      3001          end-if.
3002        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3003        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3004        move 'viid0l67' to wpgws-call-pgm-id.
3005        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3006        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
3007        if wfe-io-error
start:50      3007          if wfe-io-error
3008        move wfe-table-name to l0030-table-name
3009        move wfe-rqst-cd to l0030-io-command
3010        move wfe-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3011        move wfe-optm-sql-reqir to l0030-optm-sql-reqir
3012        move wfe-optm-sql-exec to l0030-optm-sql-exec
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3014        end-if.
end:49      3014          end-if.
3015        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3016        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3017    fe-0000-call-csiufe-x.
3018        exit.
3041        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
end:48      3041          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
3042    fe-4000-unlock-x.
3043        exit.
3044    fe-5000-delete-with-key.
3045        set wfe-rqst-delete-with-key to true.
3046        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
start:49      3046          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
2994    fe-0000-call-csiufe.
2995        if wfe-company-required
start:50      2995          if wfe-company-required
2996        move wglob-company-code to wfe-co-id
2997        move wglob-company-code to wfe-endbr-co-id
2998        else
end:49      2998          else
start:50      2998          else
2999        move spaces to wfe-co-id
3000        move spaces to wfe-endbr-co-id
3001        end-if.
end:49      3001          end-if.
3002        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3003        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3004        move 'viid0l67' to wpgws-call-pgm-id.
3005        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3006        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
3007        if wfe-io-error
start:50      3007          if wfe-io-error
3008        move wfe-table-name to l0030-table-name
3009        move wfe-rqst-cd to l0030-io-command
3010        move wfe-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3011        move wfe-optm-sql-reqir to l0030-optm-sql-reqir
3012        move wfe-optm-sql-exec to l0030-optm-sql-exec
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3014        end-if.
end:49      3014          end-if.
3015        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3016        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3017    fe-0000-call-csiufe-x.
3018        exit.
3046        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
end:48      3046          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
3047    fe-5000-delete-with-key-x.
3048        exit.
3049    fe-5000-delete-key-range.
3050        set wfe-rqst-delete-key-range to true.
3051        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
start:49      3051          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
2994    fe-0000-call-csiufe.
2995        if wfe-company-required
start:50      2995          if wfe-company-required
2996        move wglob-company-code to wfe-co-id
2997        move wglob-company-code to wfe-endbr-co-id
2998        else
end:49      2998          else
start:50      2998          else
2999        move spaces to wfe-co-id
3000        move spaces to wfe-endbr-co-id
3001        end-if.
end:49      3001          end-if.
3002        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3003        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3004        move 'viid0l67' to wpgws-call-pgm-id.
3005        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3006        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
3007        if wfe-io-error
start:50      3007          if wfe-io-error
3008        move wfe-table-name to l0030-table-name
3009        move wfe-rqst-cd to l0030-io-command
3010        move wfe-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3011        move wfe-optm-sql-reqir to l0030-optm-sql-reqir
3012        move wfe-optm-sql-exec to l0030-optm-sql-exec
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:51      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:52      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:51      3336          else
start:52      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:51      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:52      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3013        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:50      3013          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3014        end-if.
end:49      3014          end-if.
3015        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3016        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3017    fe-0000-call-csiufe-x.
3018        exit.
3051        perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
end:48      3051          perform fe-0000-call-csiufe thru fe-0000-call-csiufe-x.
3052    fe-5000-delete-key-range-x.
3053        exit.
3054    fe-1000-write.
3055        if wfe-company-required
start:49      3055          if wfe-company-required
3056        move wglob-company-code to wfe-co-id
3057        else
end:48      3057          else
start:49      3057          else
3058        move spaces to wfe-co-id
3059        end-if.
end:48      3059          end-if.
3060        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3061        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3062        move 'viid0l66' to wpgws-call-pgm-id.
3063        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3064        set wfe-rqst-insert to true.
3065        call wpgws-call-pgm-id using sqlca wfe-io-work-area rfe-rec-info.
3066        if wfe-io-error
start:49      3066          if wfe-io-error
3067        move wfe-table-name to l0030-table-name
3068        move wfe-rqst-cd to l0030-io-command
3069        move wfe-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3070        move wfe-optm-sql-reqir to l0030-optm-sql-reqir
3071        move wfe-optm-sql-exec to l0030-optm-sql-exec
3072        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:50      3072          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:51      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:50      3336          else
start:51      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:50      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:50      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3072        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:49      3072          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3073        end-if.
end:48      3073          end-if.
3074        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3075        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3076    fe-1000-write-x.
3077        exit.
3078    tmsp-1000-read.
3079        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3080        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3081        move 'viid948' to wpgws-call-pgm-id.
3082        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3083        set wtmsp-rqst-tmsp to true.
3084        call wpgws-call-pgm-id using sqlca wtmsp-io-work-area.
3085        if wtmsp-io-error
start:49      3085          if wtmsp-io-error
3086        move wtmsp-rqst-cd to l0030-io-command
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:50      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:51      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:50      3336          else
start:51      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:50      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:50      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3087        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:49      3087          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3088        end-if.
end:48      3088          end-if.
3089        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3090        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3091    tmsp-1000-read-x.
3092        exit.
3093    polp-0000-call-csibpolp.
3094        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3095        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3096        move 'viid778' to wpgws-call-pgm-id.
3097        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3098        call wpgws-call-pgm-id using sqlca wpolp-io-work-area rpolp-rec-info.
3099        if wpolp-io-error or (wpolp-optm-sql-imprv and wpolp-optm-sql-reqir not = '00')
start:49      3099          if wpolp-io-error or (wpolp-optm-sql-imprv and wpolp-optm-sql-reqir not = '00')
3100        move wpolp-table-name to l0030-table-name
3101        move wpolp-rqst-cd to l0030-io-command
3102        move wpolp-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3103        move wpolp-optm-sql-reqir to l0030-optm-sql-reqir
3104        move wpolp-optm-sql-exec to l0030-optm-sql-exec
3105        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:50      3105          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:51      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:50      3336          else
start:51      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:50      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:51      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:50      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3105        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:49      3105          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3106        end-if.
end:48      3106          end-if.
3107        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3108        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3109    polp-0000-call-csibpolp-x.
3110        exit.
3111    polp-1000-browse.
3112        if wpolp-company-required
start:49      3112          if wpolp-company-required
3113        move wglob-company-code to wpolp-co-id
3114        move wglob-company-code to wpolp-endbr-co-id
3115        else
end:48      3115          else
start:49      3115          else
3116        move spaces to wpolp-co-id
3117        move spaces to wpolp-endbr-co-id
3118        end-if.
end:48      3118          end-if.
3119        if wglob-transaction-siml
start:49      3119          if wglob-transaction-siml
3120        set wpolp-io-ok to true
3121        go to polp-1000-browse-x
start:50      3121          go to polp-1000-browse-x
3125    polp-1000-browse-x.
3126        exit.
3127    polp-2000-read-next.
3128        if wglob-transaction-siml
start:51      3128          if wglob-transaction-siml
3129        set address of ppolp-tbl-info to wglob-edic-tbl-address
3130        move ppolp-rec-info to rpolp-rec-info
3131        set wpolp-io-eof to true
3132        go to polp-2000-read-next-x
start:52      3132          go to polp-2000-read-next-x
3136    polp-2000-read-next-x.
3137        exit.
3138    polp-3000-end-browse.
3139        if wglob-transaction-siml
start:53      3139          if wglob-transaction-siml
3140        set wpolp-io-ok to true
3141        go to polp-3000-end-browse-x
start:54      3141          go to polp-3000-end-browse-x
3145    polp-3000-end-browse-x.
3146        exit.
3147    cdsi-0000-call-csibcdsi.
3148        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3149        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3150        move 'viid151' to wpgws-call-pgm-id.
3151        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3152        call wpgws-call-pgm-id using sqlca wcdsi-io-work-area rcdsi-rec-info.
3153        if wcdsi-io-error or wcdsi-optm-sql-imprv
start:55      3153          if wcdsi-io-error or wcdsi-optm-sql-imprv
3154        move wcdsi-table-name to l0030-table-name
3155        move wcdsi-rqst-cd to l0030-io-command
3156        move wcdsi-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3157        move wcdsi-optm-sql-reqir to l0030-optm-sql-reqir
3158        move wcdsi-optm-sql-exec to l0030-optm-sql-exec
3159        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:56      3159          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:57      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:56      3336          else
start:57      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:56      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:57      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:56      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3159        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:55      3159          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3160        end-if.
end:54      3160          end-if.
3161        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3162        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3163    cdsi-0000-call-csibcdsi-x.
3164        exit.
3165    cdsi-1000-browse.
3166        if wcdsi-company-required
start:55      3166          if wcdsi-company-required
3167        move wglob-company-code to wcdsi-co-id
3168        move wglob-company-code to wcdsi-endbr-co-id
3169        else
end:54      3169          else
start:55      3169          else
3170        move spaces to wcdsi-co-id
3171        move spaces to wcdsi-endbr-co-id
3172        end-if.
end:54      3172          end-if.
3173        set wcdsi-rqst-browse to true.
3174        perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
start:55      3174          perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
3147    cdsi-0000-call-csibcdsi.
3148        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3149        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3150        move 'viid151' to wpgws-call-pgm-id.
3151        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3152        call wpgws-call-pgm-id using sqlca wcdsi-io-work-area rcdsi-rec-info.
3153        if wcdsi-io-error or wcdsi-optm-sql-imprv
start:56      3153          if wcdsi-io-error or wcdsi-optm-sql-imprv
3154        move wcdsi-table-name to l0030-table-name
3155        move wcdsi-rqst-cd to l0030-io-command
3156        move wcdsi-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3157        move wcdsi-optm-sql-reqir to l0030-optm-sql-reqir
3158        move wcdsi-optm-sql-exec to l0030-optm-sql-exec
3159        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:57      3159          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:58      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:57      3336          else
start:58      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:57      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:58      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:57      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3159        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:56      3159          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3160        end-if.
end:55      3160          end-if.
3161        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3162        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3163    cdsi-0000-call-csibcdsi-x.
3164        exit.
3174        perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
end:54      3174          perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
3175    cdsi-1000-browse-x.
3176        exit.
3177    cdsi-2000-read-next.
3178        set wcdsi-rqst-fetch-next to true.
3179        perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
start:55      3179          perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
3147    cdsi-0000-call-csibcdsi.
3148        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3149        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3150        move 'viid151' to wpgws-call-pgm-id.
3151        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3152        call wpgws-call-pgm-id using sqlca wcdsi-io-work-area rcdsi-rec-info.
3153        if wcdsi-io-error or wcdsi-optm-sql-imprv
start:56      3153          if wcdsi-io-error or wcdsi-optm-sql-imprv
3154        move wcdsi-table-name to l0030-table-name
3155        move wcdsi-rqst-cd to l0030-io-command
3156        move wcdsi-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3157        move wcdsi-optm-sql-reqir to l0030-optm-sql-reqir
3158        move wcdsi-optm-sql-exec to l0030-optm-sql-exec
3159        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:57      3159          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:58      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:57      3336          else
start:58      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:57      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:58      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:57      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3159        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:56      3159          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3160        end-if.
end:55      3160          end-if.
3161        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3162        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3163    cdsi-0000-call-csibcdsi-x.
3164        exit.
3179        perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
end:54      3179          perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
3180    cdsi-2000-read-next-x.
3181        exit.
3182    cdsi-3000-end-browse.
3183        set wcdsi-rqst-close-browse-cur to true.
3184        perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
start:55      3184          perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
3147    cdsi-0000-call-csibcdsi.
3148        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3149        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3150        move 'viid151' to wpgws-call-pgm-id.
3151        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3152        call wpgws-call-pgm-id using sqlca wcdsi-io-work-area rcdsi-rec-info.
3153        if wcdsi-io-error or wcdsi-optm-sql-imprv
start:56      3153          if wcdsi-io-error or wcdsi-optm-sql-imprv
3154        move wcdsi-table-name to l0030-table-name
3155        move wcdsi-rqst-cd to l0030-io-command
3156        move wcdsi-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3157        move wcdsi-optm-sql-reqir to l0030-optm-sql-reqir
3158        move wcdsi-optm-sql-exec to l0030-optm-sql-exec
3159        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:57      3159          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:58      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:57      3336          else
start:58      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:57      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:58      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:57      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3159        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:56      3159          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3160        end-if.
end:55      3160          end-if.
3161        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3162        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3163    cdsi-0000-call-csibcdsi-x.
3164        exit.
3184        perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
end:54      3184          perform cdsi-0000-call-csibcdsi thru cdsi-0000-call-csibcdsi-x.
3185    cdsi-3000-end-browse-x.
3186        exit.
3187    gevt-1000-create.
3188        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3189        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3190        move 'viid0l14' to wpgws-call-pgm-id.
3191        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3192        set wgevt-rqst-init-tbl-layout to true.
3193        call wpgws-call-pgm-id using wgevt-io-work-area rgevt-rec-info.
3194        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3195        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3196    gevt-1000-create-x.
3197        exit.
3198    gevt-1000-write.
3199        if wgevt-company-required
start:55      3199          if wgevt-company-required
3200        move wglob-company-code to wgevt-co-id
3201        else
end:54      3201          else
start:55      3201          else
3202        move spaces to wgevt-co-id
3203        end-if.
end:54      3203          end-if.
3204        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3205        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3206        move 'viid0l13' to wpgws-call-pgm-id.
3207        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3208        set wgevt-rqst-insert to true.
3209        call wpgws-call-pgm-id using sqlca wgevt-io-work-area rgevt-rec-info.
3210        if wgevt-io-error
start:55      3210          if wgevt-io-error
3211        move wgevt-table-name to l0030-table-name
3212        move wgevt-rqst-cd to l0030-io-command
3213        move wgevt-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3214        move wgevt-optm-sql-reqir to l0030-optm-sql-reqir
3215        move wgevt-optm-sql-exec to l0030-optm-sql-exec
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:56      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:57      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:56      3336          else
start:57      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:56      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:57      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:56      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3216        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:55      3216          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3217        end-if.
end:54      3217          end-if.
3218        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3219        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3220    gevt-1000-write-x.
3221        exit.
3222    ptab-1000-read.
3223        if wptab-company-required
start:55      3223          if wptab-company-required
3224        move wglob-company-code to wptab-co-id
3225        else
end:54      3225          else
start:55      3225          else
3226        move spaces to wptab-co-id
3227        end-if.
end:54      3227          end-if.
3228        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3229        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3230        evaluate true
start:55      3231          when wglob-gptr-info-address = null
3232        move 'viid822' to wpgws-call-pgm-id
3233        when wgptr-ptab-tbl-loaded-whole
end:54      3233          when wgptr-ptab-tbl-loaded-whole
start:55      3233          when wgptr-ptab-tbl-loaded-whole
3234        move 'viidc67' to wpgws-call-pgm-id
3235        set wptab-tbl-address to wgptr-ptab-tbl-address
3236        move wgptr-ptab-stack-ptr to wptab-stack-ptr
3237        when wgptr-ptab-tbl-loaded-partl
end:54      3237          when wgptr-ptab-tbl-loaded-partl
start:55      3237          when wgptr-ptab-tbl-loaded-partl
3238        move 'viidc66' to wpgws-call-pgm-id
3239        set wptab-tbl-address to wgptr-ptab-tbl-address
3240        move wgptr-ptab-stack-ptr to wptab-stack-ptr
3241        when other
end:54      3241          when other
start:55      3241          when other
3242        move 'viid822' to wpgws-call-pgm-id
3243        end-evaluate.
end:54      3243          end-evaluate.
3244        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3245        set wptab-rqst-select to true.
3246        call wpgws-call-pgm-id using sqlca wptab-io-work-area rptab-rec-info.
3247        if wptab-io-error
start:55      3247          if wptab-io-error
3248        move wptab-table-name to l0030-table-name
3249        move wptab-rqst-cd to l0030-io-command
3250        move wptab-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3251        move wptab-optm-sql-reqir to l0030-optm-sql-reqir
3252        move wptab-optm-sql-exec to l0030-optm-sql-exec
3253        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:56      3253          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:57      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:56      3336          else
start:57      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:56      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:57      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:56      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3253        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:55      3253          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3254        end-if.
end:54      3254          end-if.
3255        if wglob-gptr-info-address not = null
start:55      3255          if wglob-gptr-info-address not = null
3256        move wptab-stack-ptr to wgptr-ptab-stack-ptr
3257        end-if.
end:54      3257          end-if.
3258        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3259        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3260    ptab-1000-read-x.
3261        exit.
3262    stqui-1000-ttab-stat-quit.
3263        move 'stqui' to wttab-etbl-typ-id
3264        move 'pr' to wttab-appl-id
3265        perform ttab-1000-read thru ttab-1000-read-x
start:55      3265          perform ttab-1000-read thru ttab-1000-read-x
3269    ttab-1000-read.
3270        if wttab-company-required
start:56      3270          if wttab-company-required
3271        move wglob-company-code to wttab-co-id
3272        else
end:55      3272          else
start:56      3272          else
3273        move spaces to wttab-co-id
3274        end-if.
end:55      3274          end-if.
3275        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3276        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3277        evaluate true
start:56      3278          when wglob-gptr-info-address = null
3279        move 'viid967' to wpgws-call-pgm-id
3280        when wgptr-ttab-tbl-loaded-whole
end:55      3280          when wgptr-ttab-tbl-loaded-whole
start:56      3280          when wgptr-ttab-tbl-loaded-whole
3281        move 'viidc74' to wpgws-call-pgm-id
3282        set wttab-tbl-address to wgptr-ttab-tbl-address
3283        move wgptr-ttab-stack-ptr to wttab-stack-ptr
3284        when wgptr-ttab-tbl-loaded-partl
end:55      3284          when wgptr-ttab-tbl-loaded-partl
start:56      3284          when wgptr-ttab-tbl-loaded-partl
3285        move 'viidc73' to wpgws-call-pgm-id
3286        set wttab-tbl-address to wgptr-ttab-tbl-address
3287        move wgptr-ttab-stack-ptr to wttab-stack-ptr
3288        when other
end:55      3288          when other
start:56      3288          when other
3289        move 'viid967' to wpgws-call-pgm-id
3290        end-evaluate.
end:55      3290          end-evaluate.
3291        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3292        set wttab-rqst-select to true.
3293        call wpgws-call-pgm-id using sqlca wttab-io-work-area rttab-rec-info.
3294        if wttab-io-error
start:56      3294          if wttab-io-error
3295        move wttab-table-name to l0030-table-name
3296        move wttab-rqst-cd to l0030-io-command
3297        move wttab-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3298        move wttab-optm-sql-reqir to l0030-optm-sql-reqir
3299        move wttab-optm-sql-exec to l0030-optm-sql-exec
3300        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:57      3300          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:58      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:57      3336          else
start:58      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:57      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:58      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:57      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3300        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:56      3300          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3301        end-if.
end:55      3301          end-if.
3302        if wglob-gptr-info-address not = null
start:56      3302          if wglob-gptr-info-address not = null
3303        move wttab-stack-ptr to wgptr-ttab-stack-ptr
3304        end-if.
end:55      3304          end-if.
3305        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3306        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3307    ttab-1000-read-x.
3308        exit.
3265        perform ttab-1000-read thru ttab-1000-read-x
end:54      3265          perform ttab-1000-read thru ttab-1000-read-x
3266        continue.
3267    stqui-1000-ttab-stat-quit-x.
3268        exit.
3269    ttab-1000-read.
3270        if wttab-company-required
start:55      3270          if wttab-company-required
3271        move wglob-company-code to wttab-co-id
3272        else
end:54      3272          else
start:55      3272          else
3273        move spaces to wttab-co-id
3274        end-if.
end:54      3274          end-if.
3275        move wglob-prev-pgm-id to wpgws-prev-pgm-id.
3276        move wpgws-crnt-pgm-id to wglob-prev-pgm-id.
3277        evaluate true
start:55      3278          when wglob-gptr-info-address = null
3279        move 'viid967' to wpgws-call-pgm-id
3280        when wgptr-ttab-tbl-loaded-whole
end:54      3280          when wgptr-ttab-tbl-loaded-whole
start:55      3280          when wgptr-ttab-tbl-loaded-whole
3281        move 'viidc74' to wpgws-call-pgm-id
3282        set wttab-tbl-address to wgptr-ttab-tbl-address
3283        move wgptr-ttab-stack-ptr to wttab-stack-ptr
3284        when wgptr-ttab-tbl-loaded-partl
end:54      3284          when wgptr-ttab-tbl-loaded-partl
start:55      3284          when wgptr-ttab-tbl-loaded-partl
3285        move 'viidc73' to wpgws-call-pgm-id
3286        set wttab-tbl-address to wgptr-ttab-tbl-address
3287        move wgptr-ttab-stack-ptr to wttab-stack-ptr
3288        when other
end:54      3288          when other
start:55      3288          when other
3289        move 'viid967' to wpgws-call-pgm-id
3290        end-evaluate.
end:54      3290          end-evaluate.
3291        move wpgws-call-pgm-id to wglob-crnt-pgm-id.
3292        set wttab-rqst-select to true.
3293        call wpgws-call-pgm-id using sqlca wttab-io-work-area rttab-rec-info.
3294        if wttab-io-error
start:55      3294          if wttab-io-error
3295        move wttab-table-name to l0030-table-name
3296        move wttab-rqst-cd to l0030-io-command
3297        move wttab-optm-sql-stat-cd to l0030-optm-sql-stat-cd
3298        move wttab-optm-sql-reqir to l0030-optm-sql-reqir
3299        move wttab-optm-sql-exec to l0030-optm-sql-exec
3300        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
start:56      3300          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:57      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:56      3336          else
start:57      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:56      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:57      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:56      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3300        perform 0030-1000-sql-error thru 0030-1000-sql-error-x
end:55      3300          perform 0030-1000-sql-error thru 0030-1000-sql-error-x
3301        end-if.
end:54      3301          end-if.
3302        if wglob-gptr-info-address not = null
start:55      3302          if wglob-gptr-info-address not = null
3303        move wttab-stack-ptr to wgptr-ttab-stack-ptr
3304        end-if.
end:54      3304          end-if.
3305        move wpgws-crnt-pgm-id to wglob-crnt-pgm-id.
3306        move wpgws-prev-pgm-id to wglob-prev-pgm-id.
3307    ttab-1000-read-x.
3308        exit.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3330    0030-1000-sql-error.
3331        set l0030-sql-error to true.
3332        move zero to l0030-data-file-status.
3333        if l0030-optm-sql-error or l0030-optm-sql-imprv
start:55      3333          if l0030-optm-sql-error or l0030-optm-sql-imprv
3334        move zero to l0030-sqlcode
3335        move spaces to l0030-error-desc-txt
3336        else
end:54      3336          else
start:55      3336          else
3337        move sqlcode to l0030-sqlcode
3338        move sqlerrmc to l0030-error-desc-txt
3339        end-if.
end:54      3339          end-if.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:55      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3340        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:54      3340          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3341    0030-1000-sql-error-x.
3342        exit.
3343    0030-2000-vsam-error.
3344        set l0030-vsam-error to true.
3345        move 'v' to l0030-error-cd.
3346        move zero to l0030-sqlcode.
3347        move spaces to l0030-error-desc-txt.
3348        move spaces to l0030-optm-sql-stat-cd.
3349        move spaces to l0030-optm-sql-reqir.
3350        move spaces to l0030-optm-sql-exec.
3351        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:55      3351          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3351        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:54      3351          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3352    0030-2000-vsam-error-x.
3353        exit.
3354    0030-3000-qsam-error.
3355        set l0030-qsam-error to true.
3356        move zero to l0030-sqlcode.
3357        move spaces to l0030-error-desc-txt.
3358        move spaces to l0030-optm-sql-stat-cd.
3359        move spaces to l0030-optm-sql-reqir.
3360        move spaces to l0030-optm-sql-exec.
3361        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:55      3361          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3361        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:54      3361          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3362    0030-3000-qsam-error-x.
3363        exit.
3364    0030-4000-ctl-card-error.
3365        set l0030-ctl-card-error to true.
3366        move spaces to l0030-table-name.
3367        move spaces to l0030-io-command.
3368        move zero to l0030-data-file-status.
3369        move zero to l0030-sqlcode.
3370        move spaces to l0030-error-desc-txt.
3371        move spaces to l0030-optm-sql-stat-cd.
3372        move spaces to l0030-optm-sql-reqir.
3373        move spaces to l0030-optm-sql-exec.
3374        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:55      3374          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3374        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:54      3374          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3375    0030-4000-ctl-card-error-x.
3376        exit.
3377    0030-5000-logic-error.
3378        set l0030-logic-error to true.
3379        move 'l' to l0030-error-cd.
3380        move spaces to l0030-table-name.
3381        move spaces to l0030-io-command.
3382        move zero to l0030-data-file-status.
3383        move zero to l0030-sqlcode.
3384        move spaces to l0030-error-desc-txt.
3385        move spaces to l0030-optm-sql-stat-cd.
3386        move spaces to l0030-optm-sql-reqir.
3387        move spaces to l0030-optm-sql-exec.
3388        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
start:55      3388          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3309    0030-0000-call-rollback-log.
3310        initialize wglob-system-time
3311        move wglob-crnt-pgm-id to l0030-crnt-pgm-id.
3312        move wglob-prev-pgm-id to l0030-prev-pgm-id.
3313        move wglob-envrmnt-cd to l0030-envrmnt-cd.
3314        move wglob-terminal-id to l0030-terminal-id.
3315        move wglob-transaction-id to l0030-transaction-id.
3316        move wglob-system-date-int to l0030-system-date-int.
3317        move wglob-system-time-int to l0030-system-time-int.
3318        move wglob-system-time to l0030-system-time.
3319        move wglob-user-lang to l0030-user-lang.
3320        move wglob-user-id to l0030-user-id.
3321        move wglob-session-ind to l0030-session-ind.
3322        move wglob-msin-reference to l0030-pol-or-cli-info.
3323        move spaces to l0030-queue-name.
3324        move zero to l0030-queue-length.
3325        move zero to l0030-queue-status.
3326        move 'vib3156' to wpgws-call-pgm-id.
3327        call wpgws-call-pgm-id using wglob-global-area l0030-parm-info.
3328    0030-0000-call-rollback-log-x.
3329        exit.
3388        perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
end:54      3388          perform 0030-0000-call-rollback-log thru 0030-0000-call-rollback-log-x.
3389    0030-5000-logic-error-x.
3390        exit.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3396    0260-1000-generate-message.
3397        move '1' to wglob-msg-ind.
3398        perform 0260-0000-link thru 0260-0000-link-x.
start:55      3398          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3398        perform 0260-0000-link thru 0260-0000-link-x.
end:54      3398          perform 0260-0000-link thru 0260-0000-link-x.
3399    0260-1000-generate-message-x.
3400        exit.
3401    0260-2000-get-message.
3402        move '2' to wglob-msg-ind.
3403        perform 0260-0000-link thru 0260-0000-link-x.
start:55      3403          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3403        perform 0260-0000-link thru 0260-0000-link-x.
end:54      3403          perform 0260-0000-link thru 0260-0000-link-x.
3404    0260-2000-get-message-x.
3405        exit.
3406    0260-3000-audit-message.
3407        move '3' to wglob-msg-ind.
3408        perform 0260-0000-link thru 0260-0000-link-x.
start:55      3408          perform 0260-0000-link thru 0260-0000-link-x.
3391    0260-0000-link.
3392        move 'vib3300' to wpgws-call-pgm-id.
3393        call wpgws-call-pgm-id using wglob-global-area.
3394    0260-0000-link-x.
3395        exit.
3408        perform 0260-0000-link thru 0260-0000-link-x.
end:54      3408          perform 0260-0000-link thru 0260-0000-link-x.
3409    0260-3000-audit-message-x.
3410        exit.
